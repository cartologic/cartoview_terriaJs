{"version":3,"sources":["webpack:///./node_modules/terriajs-cesium/Source/Core/CornerType.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CompositeProperty.js","webpack:///./node_modules/terriajs-cesium/Source/Scene/ColorBlendMode.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CompositePositionProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/ReferenceProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/ScaledPositionProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PositionPropertyArray.js","webpack:///./node_modules/terriajs-cesium/Source/Core/HermitePolynomialApproximation.js","webpack:///./node_modules/terriajs-cesium/Source/Core/LagrangePolynomialApproximation.js","webpack:///./node_modules/terriajs-cesium/Source/Core/Spherical.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CheckerboardMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CompositeMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/GridMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PolylineArrowMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PolylineDashMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PolylineOutlineMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PropertyArray.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/Rotation.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/StripeOrientation.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/StripeMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/VelocityVectorProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/VelocityOrientationProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CzmlDataSource.js","webpack:///./node_modules/terriajs-cesium/Source/ThirdParty/Autolinker.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlCamera.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlLookAt.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlTour.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlTourFlyTo.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlTourWait.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlDataSource.js"],"names":["Object","ROUNDED","MITERED","BEVELED","CompositeProperty","this","_eventHelper","_definitionChanged","_intervals","changedEvent","addEventListener","prototype","_intervalsChanged","defineProperties","isConstant","get","isEmpty","definitionChanged","intervals","getValue","time","result","innerProperty","findDataForIntervalContainingDate","equals","other","property","eventHelper","callback","raiseEvent","items","removeAll","length","i","interval","data","indexOf","add","subscribeAll","ColorBlendMode","HIGHLIGHT","REPLACE","MIX","colorBlendMode","colorBlendAmount","clamp","EPSILON4","CompositePositionProperty","referenceFrame","_referenceFrame","FIXED","_composite","_raiseDefinitionChanged","set","value","getValueInReferenceFrame","resolve","that","targetProperty","_targetProperty","targetEntity","_targetEntity","_targetCollection","getById","_targetId","undefined","ReferenceProperty","_onTargetEntityDefinitionChanged","targetPropertyNames","_targetPropertyNames","len","targetCollection","targetId","collectionChanged","_onCollectionChanged","target","resolvedProperty","fromString","referenceString","identifier","values","inIdentifier","isEscaped","token","c","charAt","push","getType","names","otherNames","name","oldValue","collection","added","removed","removeEventListener","ScaledPositionProperty","_value","_removeSubscription","setValue","WGS84","scaleToGeodeticSurface","PositionPropertyArray","Array","x","itemValue","slice","arrayEquals","factorial","calculateCoefficientTerm","zIndices","xTable","derivOrder","termOrder","reservedIndices","reserved","j","splice","HermitePolynomialApproximation","type","degree","inputOrder","defaultValue","Math","max","floor","yTable","yStride","d","s","index","defined","coefficients","l","zIndicesLength","highestNonZeroCoef","nonZeroCoefficients","numerator","zj","zn","tempTerm","coeff","arrayScratch","interpolate","outputOrder","resultLength","r","zIndiceslength","highestNonZero","tmp","dimOne","coefIndex","dimTwo","coefficient","dimTwoMinusOne","fillCoefficientList","loopStop","min","coef","LagrangePolynomialApproximation","diffX","Spherical","clock","cone","magnitude","fromCartesian3","cartesian3","y","z","radialSquared","atan2","sqrt","clone","spherical","normalize","left","right","equalsEpsilon","epsilon","abs","toString","defaultEvenColor","Color","WHITE","defaultOddColor","BLACK","defaultRepeat","Cartesian2","CheckerboardMaterialProperty","options","EMPTY_OBJECT","Event","_evenColor","_evenColorSubscription","_oddColor","_oddColorSubscription","_repeat","_repeatSubscription","evenColor","oddColor","repeat","Property","createPropertyDescriptor","lightColor","getValueOrClonedDefault","darkColor","getValueOrDefault","CompositeMaterialProperty","defaultColor","defaultLineCount","defaultLineOffset","defaultLineThickness","GridMaterialProperty","_color","_colorSubscription","_cellAlpha","_cellAlphaSubscription","_lineCount","_lineCountSubscription","_lineThickness","_lineThicknessSubscription","_lineOffset","_lineOffsetSubscription","color","cellAlpha","lineCount","lineThickness","lineOffset","PolylineArrowMaterialProperty","defaultGapColor","TRANSPARENT","PolylineDashMaterialProperty","_gapColor","_gapColorSubscription","_dashLength","_dashLengthSubscription","_dashPattern","_dashPatternSubscription","gapColor","dashLength","dashPattern","defaultOutlineColor","PolylineOutlineMaterialProperty","_outlineColor","_outlineColorSubscription","_outlineWidth","_outlineWidthSubscription","outlineColor","outlineWidth","PropertyArray","EventHelper","packedLength","pack","array","startingIndex","unpack","convertPackedArrayForInterpolation","packedArray","lastIndex","previousValue","PI","TWO_PI","unpackInterpolationResult","sourceArray","firstIndex","HORIZONTAL","VERTICAL","defaultOrientation","StripeMaterialProperty","_orientation","_orientationSubscription","_offset","_offsetSubscription","orientation","offset","horizontal","VelocityVectorProperty","position","_position","_subscription","_normalize","position1Scratch","Cartesian3","position2Scratch","timeScratch","JulianDate","_getValue","velocityResult","positionResult","ZERO","position1","position2","addSeconds","velocity","subtract","divideByScalar","VelocityOrientationProperty","ellipsoid","_velocityVectorProperty","_ellipsoid","Ellipsoid","positionScratch","velocityScratch","rotationScratch","Matrix3","Transforms","rotationMatrixFromPositionVelocity","Quaternion","fromRotationMatrix","currentId","UnitCartesian3","createReferenceProperty","entityCollection","createSpecializedProperty","packetData","reference","velocityReference","referenceProperty","RuntimeError","JSON","stringify","scratchCartesian","scratchSpherical","scratchCartographic","Cartographic","scratchTimeInterval","TimeInterval","scratchQuaternion","unwrapUriInterval","czmlInterval","sourceUri","uri","getDerivedResource","url","Resource","createIfNeeded","unwrapCartesianInterval","cartesian","cartesianVelocity","unitCartesian","unitSpherical","fromSpherical","convertUnitSphericalToCartesian","convertSphericalToCartesian","cartographicRadians","longitude","latitude","height","cartographicToCartesian","convertCartographicRadiansToCartesian","cartographicDegrees","toRadians","convertCartographicDegreesToCartesian","normalizePackedCartesianArray","normalizePackedQuaternionArray","getPropertyType","Boolean","Number","String","hasOwnProperty","BoundingRectangle","ArcType","ClassificationType","CornerType","HeightReference","HorizontalOrigin","LabelStyle","NearFarScalar","DistanceDisplayCondition","ShadowMode","Rectangle","Uri","VerticalOrigin","unwrapInterval","arcType","boundingRectangle","cartesian2","unwrapUnitCartesianInterval","rgbaf","rgba","byteToFloat","unwrapColorInterval","classificationType","cornerType","heightReference","horizontalOrigin","Image","fromIso8601","date","labelStyle","number","nearFarScalar","distanceDisplayCondition","object","unitQuaternion","unwrapQuaternionInterval","wsen","wsenDegrees","unwrapRectangleInterval","shadowMode","shadows","string","stripeOrientation","verticalOrigin","interpolators","HERMITE","LAGRANGE","LINEAR","LinearApproximation","updateInterpolationSettings","interpolationAlgorithm","interpolationDegree","setInterpolationOptions","forwardExtrapolationType","ExtrapolationType","forwardExtrapolationDuration","backwardExtrapolationType","backwardExtrapolationDuration","iso8601Scratch","iso8601","intervalFromString","intervalString","wrapPropertyInInfiniteInterval","Iso8601","MAXIMUM_INTERVAL","convertPropertyToComposite","composite","addInterval","convertPositionPropertyToComposite","processProperty","propertyName","constrainedInterval","unwrappedInterval","unwrappedIntervalLength","combinedInterval","intersect","isValue","hasInterval","delete","removePropertyData","SampledProperty","removeSamples","TimeIntervalCollectionProperty","removeInterval","intersection","isSampled","needsUnpacking","epoch","packetEpoch","addSamplesPackedArray","ConstantProperty","findInterval","processPacketData","isArray","processPositionProperty","numberOfDerivatives","removePositionPropertyData","SampledPositionProperty","TimeIntervalCollectionPositionProperty","ReferenceFrame","ConstantPositionProperty","processPositionPacketData","processShapePacketData","references","processReferencesArrayPacketData","unpackArray","processMaterialProperty","existingMaterial","existingInterval","materialData","thisIntervals","start","stop","solidColor","ColorMaterialProperty","grid","image","ImageMaterialProperty","transparent","stripe","polylineOutline","polylineGlow","PolylineGlowMaterialProperty","glowPower","taperPower","polylineArrow","polylineDash","checkerboard","processMaterialPacketData","PropertyArrayType","CompositePropertyArrayType","properties","map","processArrayPacketData","processArray","processPositionArrayPacketData","fromRadiansArrayHeights","fromDegreesArrayHeights","processPositionArray","unpackCartesianArray","unpackCartographicRadiansArray","unpackCartographicDegreesArray","processPositionArrayOfArraysPacketData","referenceArray","tempObj","positions","processNodeTransformations","model","nodeTransformationsData","nodeTransformations","nodeNames","keys","nodeName","nodeTransformationData","PropertyBag","hasProperty","addProperty","nodeTransformation","NodeTransformationProperty","translation","rotation","scale","processArticulations","articulationsData","articulations","key","articulationStageData","PolygonHierarchyProperty","polygon","adaptFollowSurfaceToArcType","followSurface","GEODESIC","NONE","processCzmlPacket","packet","updaterFunctions","dataSource","objectId","id","createGuid","_version","removeById","version","tokens","split","documentPacket","_documentPacket","clockPacket","currentTime","range","step","multiplier","processDocument","entity","getOrCreateEntity","parentId","parent","load","czml","clear","promise","credit","Credit","_credit","fetchJson","resourceCredits","_resourceCredits","credits","DataSource","setLoading","when","_entityCollection","DocumentPacket","CzmlDataSource","_processCzml","raiseChangedEvent","_clock","availability","computeAvailability","MINIMUM_VALUE","startTime","stopTime","totalSeconds","secondsDifference","round","DataSourceClock","clockRange","ClockRange","LOOP_STOP","clockStep","ClockStep","SYSTEM_CLOCK_MULTIPLIER","MAXIMUM_VALUE","updateClock","_name","getFilenameFromUri","getUrlComponent","_changed","loadCzml","otherwise","error","_error","console","log","reject","_isLoading","_loading","EntityCollection","_entityCluster","EntityCluster","_positions","holes","_holes","holePositions","PolygonHierarchy","entities","isLoading","errorEvent","loadingEvent","show","clustering","updaters","billboardData","billboard","BillboardGraphics","pixelOffset","eyeOffset","processAlignedAxis","alignedAxis","sizeInMeters","width","scaleByDistance","translucencyByDistance","pixelOffsetScaleByDistance","imageSubRegion","disableDepthTestDistance","boxData","box","BoxGraphics","dimensions","fill","material","outline","corridorData","corridor","CorridorGraphics","extrudedHeight","extrudedHeightReference","granularity","zIndex","cylinderData","cylinder","CylinderGraphics","topRadius","bottomRadius","numberOfVerticalLines","slices","ellipseData","ellipse","EllipseGraphics","semiMajorAxis","semiMinorAxis","stRotation","ellipsoidData","EllipsoidGraphics","radii","innerRadii","minimumClock","maximumClock","minimumCone","maximumCone","stackPartitions","slicePartitions","subdivisions","labelData","label","LabelGraphics","text","font","style","showBackground","backgroundColor","backgroundPadding","fillColor","modelData","ModelGraphics","gltf","minimumPixelSize","maximumScale","incrementallyLoadTextures","runAnimations","clampAnimations","silhouetteColor","silhouetteSize","nameData","descriptionData","description","pathData","path","PathGraphics","leadTime","trailTime","resolution","pointData","point","PointGraphics","pixelSize","polygonData","PolygonGraphics","processPositionArrayOfArrays","hierarchy","perPositionHeight","closeTop","closeBottom","polylineData","polyline","adapterFunction","PolylineGraphics","depthFailMaterial","clampToGround","CallbackProperty","polylineVolumeData","polylineVolume","PolylineVolumeGraphics","processShape","shape","propertiesData","propertyData","rectangleData","rectangle","RectangleGraphics","coordinates","positionData","tilesetData","tileset","Cesium3DTilesetGraphics","maximumScreenSpaceError","viewFromData","viewFrom","wallData","wall","WallGraphics","minimumHeights","maximumHeights","orientationData","TimeIntervalCollection","process","update","Autolinker","arr","element","remove","fn","throwUnhandledCaseError","theValue","Error","HtmlTag","cfg","tagName","attrs","innerHTML","whitespaceRegex","innerHtml","setTagName","getTagName","setAttr","attrName","attrValue","getAttrs","getAttr","setAttrs","assign","setClass","cssClass","addClass","newClass","classAttr","getClass","classes","newClasses","shift","join","removeClass","removeClasses","idx","hasClass","setInnerHTML","html","setInnerHtml","getInnerHTML","getInnerHtml","toAnchorString","attrsStr","buildAttrsStr","attrsArr","prop","AnchorTagBuilder","newWindow","truncate","className","build","match","createAttrs","processAnchorText","getAnchorText","getAnchorHref","createCssClass","returnClasses","cssClassSuffixes","getCssClassSuffixes","anchorText","doTruncate","truncateLength","truncateLocation","location","truncateLen","ellipsisChars","ellipsisLengthBeforeParsing","ellipsisLength","buildUrl","urlObj","scheme","host","query","fragment","buildSegment","segment","remainingAvailableLength","remainingAvailableLengthHalf","startOffset","ceil","endOffset","end","substr","availableLength","urlSub","parse_url","matchQuery","replace","str","pathAndQuery","truncateSmart","truncateMiddle","substring","ellipsis","truncateEnd","Match","__jsduckDummyDocProp","matchedText","tagBuilder","getMatchedText","setOffset","getOffset","buildTag","extendStatics","b","setPrototypeOf","__proto__","p","__extends","__","constructor","create","__assign","t","n","arguments","call","apply","EmailMatch","_super","_this","email","getEmail","HashtagMatch","serviceName","hashtag","getServiceName","getHashtag","MentionMatch","mention","getMention","PhoneMatch","plusSign","getPhoneNumber","getNumber","UrlMatch","urlMatchType","protocolUrlMatch","protocolRelativeMatch","stripPrefix","www","stripTrailingSlash","decodePercentEncoding","schemePrefixRegex","wwwPrefixRegex","protocolRelativeRegex","protocolPrepended","getUrlMatchType","getUrl","stripProtocolRelativePrefix","stripSchemePrefix","stripWwwPrefix","removeTrailingSlash","removePercentEncoding","preProcessedEntityAnchorText","decodeURIComponent","e","Matcher","letterRe","digitRe","whitespaceRe","quoteRe","controlCharsRe","alphaCharsStr","source","alphaCharsAndMarksStr","decimalNumbersStr","alphaNumericCharsStr","alphaNumericAndMarksCharsStr","ipStr","domainLabelStr","getDomainLabelStr","group","getDomainNameStr","domainNameCharRegex","RegExp","tldRegex","EmailMatcher","localPartCharRegex","strictTldRegex","parseMatches","matches","noCurrentEmailMatch","CurrentEmailMatch","mailtoTransitions","charIdx","state","currentEmailMatch","char","stateNonEmailAddress","stateMailTo","stateLocalPart","stateLocalPartDot","stateAtSign","stateDomainChar","stateDomainHyphen","stateDomainDot","captureMatchIfValidAndReset","beginEmailMatch","test","prevChar","hasMailtoPrefix","resetToNonEmailMatchState","hasDomainDot","newState","emailAddress","emailAddressNormalized","pop","toLowerCase","doesEmailHaveValidTld","UrlMatchValidator","isValid","urlMatch","isValidUriScheme","urlMatchDoesNotHaveProtocolOrDot","urlMatchDoesNotHaveAtLeastOneWordChar","isValidIpAddress","containsMultipleDots","uriSchemeMatch","newRegex","hasFullProtocolRegex","ipRegex","stringBeforeSlash","uriSchemeMatchArr","uriSchemeRegex","uriScheme","hasWordCharAfterProtocolRegex","UrlMatcher","urlSuffixRegex","matcherRegex","wordCharRegExp","_loop_1","matchStr","schemeUrlMatch","wwwUrlMatch","wwwProtocolRelativeMatch","tldProtocolRelativeMatch","this_1","matchHasUnbalancedClosingParen","pos","matchHasInvalidCharAfterTld","foundCommonScheme","find","commonScheme","indexOfSchemeStart","exec","startChar","endChar","numOpenBraces","res","HashtagMatcher","nonWordCharRegex","PhoneMatcher","cleanNumber","before","after","contextClear","testMatch","MentionMatcher","matcherRegexes","parseHtml","_a","onOpenTag","onCloseTag","onText","onComment","onDoctype","noCurrentTag","CurrentTag","currentDataIdx","currentTag","stateData","stateTagOpen","stateEndTagOpen","stateTagName","stateBeforeAttributeName","stateAttributeName","stateAfterAttributeName","stateBeforeAttributeValue","stateAttributeValueDoubleQuoted","stateAttributeValueSingleQuoted","stateAttributeValueUnquoted","stateAfterAttributeValueQuoted","stateSelfClosingStartTag","toUpperCase","resetToDataState","stateCommentStart","stateCommentStartDash","stateComment","stateCommentEndDash","stateCommentEnd","stateCommentEndBang","stateDoctype","startNewTag","isClosing","isOpening","captureTagName","emitTagAndPreviousTextNode","textBeforeTag","startIdx","urls","phone","replaceFn","context","matchers","normalizeUrlsCfg","normalizeStripPrefixCfg","normalizeTruncateCfg","link","textOrHtml","parse","schemeMatches","wwwMatches","tldMatches","dest","src","defaults","POSITIVE_INFINITY","skipTagNames","skipTagsStackCount","textSplit","splitRegex","global","lastIdx","splitAndCapture","currentOffset_1","forEach","splitText","textNodeMatches","parseText","compactMatches","removeUnwantedMatches","sort","a","matchedTextLength","endIdx","removeIdx","m","getMatchers","numMatchers","textMatches","numTextMatches","newHtml","createMatchReturnVal","replaceFnResult","getTagBuilder","matcher","Email","Hashtag","Mention","Phone","Url","factory","headingPitchRoll","headingPitchRange","KmlTour","playlistIndex","playlist","tourStart","tourEnd","entryStart","entryEnd","_activeEntries","cancelAllEntries","activeEntries","entry","playEntry","viewer","cameraOptions","allDone","_playNext","playNext","bind","blocking","play","scene","camera","tour","indx","terminated","addPlaylistEntry","KmlTourFlyTo","duration","flyToMode","view","activeCamera","activeCallback","done","self","getCameraOptions","flyTo","BoundingSphere","flyToBoundingSphere","cancelFlight","complete","easingFunction","EasingFunction","LINEAR_NONE","destination","combine","KmlTourWait","timeout","setTimeout","clearTimeout","parser","MimeTypes","avi","bmp","bz2","chm","css","csv","doc","dvi","eps","flv","gif","gz","htm","ico","jnlp","jpeg","jpg","m3u","m4v","mathml","mid","midi","mov","mp3","mp4","mp4v","mpeg","mpg","odp","ods","odt","ogg","pdf","png","pps","ppt","ps","qt","rdf","rss","rtf","svg","swf","tif","tiff","txt","wav","wma","wmv","xml","zip","detectFromFilename","filename","ext","getExtensionFromUri","DOMParser","autolinker","kmlNamespaces","gxNamespaces","namespaces","kml","gx","atom","kmlgx","concat","featureTypes","Document","Folder","node","processingData","deferredLoading","processFeature","newProcessingData","parentEntity","Placemark","placemark","styleEntity","hasGeometry","childNodes","childNode","item","geometryProcessor","geometryTypes","localName","merge","processPositionGraphics","NetworkLink","networkEntity","sourceResource","uriResolver","queryFirstNode","viewRefreshMode","viewBoundScale","href","queryStringValue","newSourceUri","resolveHref","defaultViewFormat","viewFormat","httpQuery","setQueryParameters","queryToObject","cleanupString","processNetworkLinkQueryString","_camera","_canvas","_lastCameraView","bbox","networkLinkCollection","then","rootElement","newEntities","suspendEvents","newEntity","mergeAvailabilityWithParent","resumeEvents","refreshMode","refreshInterval","queryNumericValue","networkLinkControl","hasNetworkLinkControl","now","networkLinkInfo","cookie","lastUpdated","updating","needsUpdate","cameraUpdateTime","minRefreshPeriod","RefreshMode","expires","diff","oneTimeWarning","_networkLinks","addPromise","GroundOverlay","groundOverlay","geometry","isLatLonQuad","readCoordinates","createDefaultPolygon","latLonBox","west","south","east","north","negativePiToPi","clampToLatitudeRange","rotationRadians","iconNode","getIconHref","w","h","queryColorValue","altitudeMode","PhotoOverlay","processUnsupportedFeature","ScreenOverlay","Tour","queryStringAttribute","playlistNode","entryNode","playlistNodeProcessor","playlistNodeProcessors","kmlTours","DeferredLoading","_dataSource","_deferred","defer","_stack","_promises","_timeoutSet","_used","_started","_timeThreshold","insertNamespaces","firstPart","lastPart","declaration","namespaceMap","xsi","removeDuplicateNamespaces","namespace","startIndex","endIndex","endDeclaration","loadDataUriFromZip","deferred","mimeType","getData","Data64URIWriter","dataUri","embedDataUris","div","elementType","attributeName","baseUri","elements","querySelectorAll","getAttribute","setAttribute","applyBasePath","resource","createEntity","Entity","KmlFeatureData","isExtrudable","gxAltitudeMode","readCoordinate","fromDegrees","digits","parseFloat","isNaN","tuples","textContent","resultIndex","queryNumericAttribute","q","child","namespaceURI","queryNodes","getElementsByTagNameNS","queryChildNodes","resultNode","trim","queryBooleanValue","blob","addNodes","nodes","wait","all","isFirstCall","KmlDataSource","_getTimestamp","_process","_giveUpTime","_nextNode","stack","top","_pop","featureProcessor","colorOptions","maximumRed","red","maximumGreen","green","maximumBlue","blue","parseColorString","isRandom","alpha","parseInt","fromRandom","createDefaultBillboard","createDefaultLabel","LEFT","FILL_AND_OUTLINE","canRefresh","palette","hrefResource","processBillboardIcon","heading","icon","xOffset","yOffset","hotSpotNode","hotSpotX","hotSpotY","hotSpotXUnit","hotSpotYUnit","UNIT_Z","BILLBOARD_SIZE","applyStyle","styleNode","bgColor","textColor","balloonStyle","listItemType","processExternalStyles","styleCollection","fetchXML","styleKml","processStyles","isExternal","styleNodes","styleNodesLength","styleMaps","styleMapsLength","styleMap","pairs","pair","styleUrl","base","promises","styleUrlNodes","getElementsByTagName","styleUrlNodesLength","styleReference","createDropLine","entityPosition","surfacePosition","heightReferenceFromAltitudeMode","CLAMP_TO_GROUND","RELATIVE_TO_GROUND","createPositionPropertyFromAltitudeMode","_pinBuilder","fromColor","YELLOW","_clampToGround","processPathGraphics","processLineStringOrLinearRing","geometryNode","coordinatesNode","extrude","tessellate","canExtrude","polylineGraphics","propertiesLength","createPositionPropertyArrayFromAltitudeMode","addToMultiTrack","times","dropShowProperty","includeEndPoints","addSamples","isStartIncluded","isStopIncluded","scratchDiv","Point","coordinatesString","LineString","LinearRing","Polygon","outerBoundaryIsNode","linearRingNode","innerBoundaryIsNodes","k","Track","coordNodes","angleNodes","timeNodes","MultiTrack","lastStop","lastStopPosition","trackNodes","needDropLine","trackNode","MultiGeometry","childEntity","Model","featureNode","kmlData","placeMark","styleIndex","inlineStyleNode","externalStyle","computeFinalStyle","beginNode","beginDate","endNode","endDate","lessThan","processTimeSpan","whenString","processTimeStamp","visibility","ancestryIsVisible","authorNode","author","linkNode","hreflang","rel","title","address","phoneNumber","snippet","extendedDataNode","dataNodes","dataNode","displayName","extendedData","processExtendedData","background","foreground","isDisplayName","links","toCssColorString","processDescription","processLookAt","processCamera","document","createElement","FlyTo","lookAt","flyto","Wait","SoundCue","processTourUnsupportedNode","AnimatedUpdate","TourControl","lon","lat","altitude","tilt","roll","hpr","HeadingPitchRoll","HeadingPitchRange","PI_OVER_TWO","viewPoint","_unsupportedNode","sFirst","zeroRectangle","scratchCartesian2","scratchCartesian3","canvas","fixLatitude","fixLongitude","queryString","objectToQuery","queryParameters","_mode","SceneMode","MORPHING","centerCartesian","centerCartographic","clientWidth","clientHeight","pickEllipsoid","cartesianToCartographic","center","EPSILON9","newHalfWidth","newHalfHeight","toDegrees","pitch","distance","positionWC","frustum","aspectRatio","horizFov","vertFov","fov","loadKml","documentElement","_DeferredLoading","processFeatureNode","loadKmz","createReader","BlobReader","reader","getEntries","entries","docEntry","docDefer","directory","innerDefer","TextWriter","parseFromString","loadXmlFromZip","close","fetchBlob","DEFAULT","dataToLoad","Blob","magicBlob","size","FileReader","DataView","getUint32","readAsArrayBuffer","isZip","readAsText","readBlobAsText","body","msg","firstChild","nodeValue","innerText","_refresh","PinBuilder","AssociativeArray","direction","directionWC","up","upWC","computeViewRectangle","MAX_VALUE","parentAvailability","childAvailability","refreshEvent","unsupportedNodeEvent","oldName","isMinStart","isMaxStop","Date","setHours","fromDate","changed","entitiesToIgnore","networkLinks","cameraViewUpdate","lastCameraView","EPSILON7","newNetworkLinks","networkLink","contains","doUpdate","greaterThan","recurseIgnoreEntities","children","_children","count","newEntityCollection","processedHref","networkLinkEntity","entitiesCopy","entityToRemove","removeChildren","getNetworkLinkUpdateCallback","getTimestamp"],"mappings":"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AD,EAAQM,QACRhmB,EACAwS,EACAlB,GAEF4I,GACE9Q,EAAA,QACAuc,EACA,eACAD,EAAQrY,aACRrN,EACAwS,EACAlB,GAEF4I,GACE/F,OACAwR,EACA,eACAD,EAAQpY,aACRtN,EACAwS,EACAlB,GAEF4I,GACEnF,EAAA,EACA4Q,EACA,UACAD,EAAQ5O,QACR9W,EACAwS,EACAlB,GAEF4I,GACEpF,EAAA,EACA6Q,EACA,2BACAD,EAAQpP,yBACRtW,EACAwS,EACAlB,KAIJ,SAAyBiP,EAAQnB,EAAQ9N,EAAkBkB,GACzD,IAAIyT,EAAe7G,EAAO8G,SAC1B,GAAK,OAAAjgB,EAAA,SAAQggB,GAAb,CAIA,IAAIjmB,EAAWkY,GAAmB+N,EAAajmB,UAC3CkmB,EAAW3F,EAAO2F,SACjB,OAAAjgB,EAAA,SAAQigB,KACX3F,EAAO2F,SAAWA,EAAW,IAAIC,GAAA,GAGnCjM,GACEhG,QACAgS,EACA,OACAD,EAAaxB,KACbzkB,EACAwS,EACAlB,GAEF0L,GACEkJ,EACA,YACAD,EAAa1I,UACbjM,GAEF4I,GACE/F,OACA+R,EACA,QACAD,EAAab,MACbplB,EACAwS,EACAlB,GAEF4I,GACE/F,OACA+R,EACA,SACAD,EAAaxS,OACbzT,EACAwS,EACAlB,GAEF4I,GACExF,EAAA,QACAwR,EACA,kBACAD,EAAanQ,gBACb9V,EACAwS,EACAlB,GAEF4I,GACE/F,OACA+R,EACA,iBACAD,EAAaG,eACbpmB,EACAwS,EACAlB,GAEF4I,GACExF,EAAA,QACAwR,EACA,0BACAD,EAAaI,wBACbrmB,EACAwS,EACAlB,GAEF4I,GACEzF,EAAA,EACAyR,EACA,aACAD,EAAapQ,WACb7V,EACAwS,EACAlB,GAEF4I,GACE/F,OACA+R,EACA,cACAD,EAAaK,YACbtmB,EACAwS,EACAlB,GAEF4I,GACEhG,QACAgS,EACA,OACAD,EAAaH,KACb9lB,EACAwS,EACAlB,GAEFgL,GACE4J,EACA,WACAD,EAAaF,SACb/lB,EACAwS,EACAlB,GAEF4I,GACEhG,QACAgS,EACA,UACAD,EAAaD,QACbhmB,EACAwS,EACAlB,GAEF4I,GACE9Q,EAAA,QACA8c,EACA,eACAD,EAAa5Y,aACbrN,EACAwS,EACAlB,GAEF4I,GACE/F,OACA+R,EACA,eACAD,EAAa3Y,aACbtN,EACAwS,EACAlB,GAEF4I,GACEnF,EAAA,EACAmR,EACA,UACAD,EAAanP,QACb9W,EACAwS,EACAlB,GAEF4I,GACEpF,EAAA,EACAoR,EACA,2BACAD,EAAa3P,yBACbtW,EACAwS,EACAlB,GAEF4I,GACE1F,EAAA,EACA0R,EACA,qBACAD,EAAarQ,mBACb5V,EACAwS,EACAlB,GAEF4I,GACE/F,OACA+R,EACA,SACAD,EAAaM,OACbvmB,EACAwS,EACAlB,KAIJ,SAAyBiP,EAAQnB,EAAQ9N,EAAkBkB,GACzD,IAAIgU,EAAepH,EAAOqH,SAC1B,GAAK,OAAAxgB,EAAA,SAAQugB,GAAb,CAIA,IAAIxmB,EAAWkY,GAAmBsO,EAAaxmB,UAC3CymB,EAAWlG,EAAOkG,SACjB,OAAAxgB,EAAA,SAAQwgB,KACXlG,EAAOkG,SAAWA,EAAW,IAAIC,GAAA,GAGnCxM,GACEhG,QACAuS,EACA,OACAD,EAAa/B,KACbzkB,EACAwS,EACAlB,GAEF4I,GACE/F,OACAsS,EACA,SACAD,EAAa1mB,OACbE,EACAwS,EACAlB,GAEF4I,GACE/F,OACAsS,EACA,YACAD,EAAaG,UACb3mB,EACAwS,EACAlB,GAEF4I,GACE/F,OACAsS,EACA,eACAD,EAAaI,aACb5mB,EACAwS,EACAlB,GAEF4I,GACExF,EAAA,QACA+R,EACA,kBACAD,EAAa1Q,gBACb9V,EACAwS,EACAlB,GAEF4I,GACEhG,QACAuS,EACA,OACAD,EAAaV,KACb9lB,EACAwS,EACAlB,GAEFgL,GACEmK,EACA,WACAD,EAAaT,SACb/lB,EACAwS,EACAlB,GAEF4I,GACEhG,QACAuS,EACA,UACAD,EAAaR,QACbhmB,EACAwS,EACAlB,GAEF4I,GACE9Q,EAAA,QACAqd,EACA,eACAD,EAAanZ,aACbrN,EACAwS,EACAlB,GAEF4I,GACE/F,OACAsS,EACA,eACAD,EAAalZ,aACbtN,EACAwS,EACAlB,GAEF4I,GACE/F,OACAsS,EACA,wBACAD,EAAaK,sBACb7mB,EACAwS,EACAlB,GAEF4I,GACE/F,OACAsS,EACA,SACAD,EAAaM,OACb9mB,EACAwS,EACAlB,GAEF4I,GACEnF,EAAA,EACA0R,EACA,UACAD,EAAa1P,QACb9W,EACAwS,EACAlB,GAEF4I,GACEpF,EAAA,EACA2R,EACA,2BACAD,EAAalQ,yBACbtW,EACAwS,EACAlB,KAsDJ,SAAwBiP,EAAQnB,EAAQ9N,EAAkBkB,GACxD,IAAIuU,EAAc3H,EAAO4H,QACzB,GAAK,OAAA/gB,EAAA,SAAQ8gB,GAAb,CAIA,IAAI/mB,EAAWkY,GAAmB6O,EAAY/mB,UAC1CgnB,EAAUzG,EAAOyG,QAChB,OAAA/gB,EAAA,SAAQ+gB,KACXzG,EAAOyG,QAAUA,EAAU,IAAIC,GAAA,GAGjC/M,GACEhG,QACA8S,EACA,OACAD,EAAYtC,KACZzkB,EACAwS,EACAlB,GAEF4I,GACE/F,OACA6S,EACA,gBACAD,EAAYG,cACZlnB,EACAwS,EACAlB,GAEF4I,GACE/F,OACA6S,EACA,gBACAD,EAAYI,cACZnnB,EACAwS,EACAlB,GAEF4I,GACE/F,OACA6S,EACA,SACAD,EAAYtT,OACZzT,EACAwS,EACAlB,GAEF4I,GACExF,EAAA,QACAsS,EACA,kBACAD,EAAYjR,gBACZ9V,EACAwS,EACAlB,GAEF4I,GACE/F,OACA6S,EACA,iBACAD,EAAYX,eACZpmB,EACAwS,EACAlB,GAEF4I,GACExF,EAAA,QACAsS,EACA,0BACAD,EAAYV,wBACZrmB,EACAwS,EACAlB,GAEF4I,GACE,GACA8M,EACA,WACAD,EAAYzI,SACZte,EACAwS,EACAlB,GAEF4I,GACE,GACA8M,EACA,aACAD,EAAYK,WACZpnB,EACAwS,EACAlB,GAEF4I,GACE/F,OACA6S,EACA,cACAD,EAAYT,YACZtmB,EACAwS,EACAlB,GAEF4I,GACEhG,QACA8S,EACA,OACAD,EAAYjB,KACZ9lB,EACAwS,EACAlB,GAEFgL,GACE0K,EACA,WACAD,EAAYhB,SACZ/lB,EACAwS,EACAlB,GAEF4I,GACEhG,QACA8S,EACA,UACAD,EAAYf,QACZhmB,EACAwS,EACAlB,GAEF4I,GACE9Q,EAAA,QACA4d,EACA,eACAD,EAAY1Z,aACZrN,EACAwS,EACAlB,GAEF4I,GACE/F,OACA6S,EACA,eACAD,EAAYzZ,aACZtN,EACAwS,EACAlB,GAEF4I,GACE/F,OACA6S,EACA,wBACAD,EAAYF,sBACZ7mB,EACAwS,EACAlB,GAEF4I,GACEnF,EAAA,EACAiS,EACA,UACAD,EAAYjQ,QACZ9W,EACAwS,EACAlB,GAEF4I,GACEpF,EAAA,EACAkS,EACA,2BACAD,EAAYzQ,yBACZtW,EACAwS,EACAlB,GAEF4I,GACE1F,EAAA,EACAwS,EACA,qBACAD,EAAYnR,mBACZ5V,EACAwS,EACAlB,GAEF4I,GACE/F,OACA6S,EACA,SACAD,EAAYR,OACZvmB,EACAwS,EACAlB,KAIJ,SAA0BiP,EAAQnB,EAAQ9N,EAAkBkB,GAC1D,IAAI6U,EAAgBjI,EAAO7O,UAC3B,GAAK,OAAAtK,EAAA,SAAQohB,GAAb,CAIA,IAAIrnB,EAAWkY,GAAmBmP,EAAcrnB,UAC5CuQ,EAAYgQ,EAAOhQ,UAClB,OAAAtK,EAAA,SAAQsK,KACXgQ,EAAOhQ,UAAYA,EAAY,IAAI+W,GAAA,GAGrCpN,GACEhG,QACA3D,EACA,OACA8W,EAAc5C,KACdzkB,EACAwS,EACAlB,GAEF4I,GACE1K,EAAA,QACAe,EACA,QACA8W,EAAcE,MACdvnB,EACAwS,EACAlB,GAEF4I,GACE1K,EAAA,QACAe,EACA,aACA8W,EAAcG,WACdxnB,EACAwS,EACAlB,GAEF4I,GACE/F,OACA5D,EACA,eACA8W,EAAcI,aACdznB,EACAwS,EACAlB,GAEF4I,GACE/F,OACA5D,EACA,eACA8W,EAAcK,aACd1nB,EACAwS,EACAlB,GAEF4I,GACE/F,OACA5D,EACA,cACA8W,EAAcM,YACd3nB,EACAwS,EACAlB,GAEF4I,GACE/F,OACA5D,EACA,cACA8W,EAAcO,YACd5nB,EACAwS,EACAlB,GAEF4I,GACExF,EAAA,QACAnE,EACA,kBACA8W,EAAcvR,gBACd9V,EACAwS,EACAlB,GAEF4I,GACEhG,QACA3D,EACA,OACA8W,EAAcvB,KACd9lB,EACAwS,EACAlB,GAEFgL,GACE/L,EACA,WACA8W,EAActB,SACd/lB,EACAwS,EACAlB,GAEF4I,GACEhG,QACA3D,EACA,UACA8W,EAAcrB,QACdhmB,EACAwS,EACAlB,GAEF4I,GACE9Q,EAAA,QACAmH,EACA,eACA8W,EAAcha,aACdrN,EACAwS,EACAlB,GAEF4I,GACE/F,OACA5D,EACA,eACA8W,EAAc/Z,aACdtN,EACAwS,EACAlB,GAEF4I,GACE/F,OACA5D,EACA,kBACA8W,EAAcQ,gBACd7nB,EACAwS,EACAlB,GAEF4I,GACE/F,OACA5D,EACA,kBACA8W,EAAcS,gBACd9nB,EACAwS,EACAlB,GAEF4I,GACE/F,OACA5D,EACA,eACA8W,EAAcU,aACd/nB,EACAwS,EACAlB,GAEF4I,GACEnF,EAAA,EACAxE,EACA,UACA8W,EAAcvQ,QACd9W,EACAwS,EACAlB,GAEF4I,GACEpF,EAAA,EACAvE,EACA,2BACA8W,EAAc/Q,yBACdtW,EACAwS,EACAlB,KAIJ,SAAsBiP,EAAQnB,EAAQ9N,EAAkBkB,GACtD,IAAIwV,EAAY5I,EAAO6I,MACvB,GAAK,OAAAhiB,EAAA,SAAQ+hB,GAAb,CAIA,IAAIhoB,EAAWkY,GAAmB8P,EAAUhoB,UACxCioB,EAAQ1H,EAAO0H,MACd,OAAAhiB,EAAA,SAAQgiB,KACX1H,EAAO0H,MAAQA,EAAQ,IAAIC,GAAA,GAG7BhO,GACEhG,QACA+T,EACA,OACAD,EAAUvD,KACVzkB,EACAwS,EACAlB,GAEF4I,GACE9F,OACA6T,EACA,OACAD,EAAUG,KACVnoB,EACAwS,EACAlB,GAEF4I,GACE9F,OACA6T,EACA,OACAD,EAAUI,KACVpoB,EACAwS,EACAlB,GAEF4I,GACEtF,EAAA,EACAqT,EACA,QACAD,EAAUK,MACVroB,EACAwS,EACAlB,GAEF4I,GACE/F,OACA8T,EACA,QACAD,EAAUzJ,MACVve,EACAwS,EACAlB,GAEF4I,GACEhG,QACA+T,EACA,iBACAD,EAAUM,eACVtoB,EACAwS,EACAlB,GAEF4I,GACE9Q,EAAA,QACA6e,EACA,kBACAD,EAAUO,gBACVvoB,EACAwS,EACAlB,GAEF4I,GACEzQ,EAAA,QACAwe,EACA,oBACAD,EAAUQ,kBACVxoB,EACAwS,EACAlB,GAEF4I,GACEzQ,EAAA,QACAwe,EACA,cACAD,EAAUjD,YACV/kB,EACAwS,EACAlB,GAEF4I,GACE1K,EAAA,QACAyY,EACA,YACAD,EAAUhD,UACVhlB,EACAwS,EACAlB,GAEF4I,GACEvF,EAAA,QACAsT,EACA,mBACAD,EAAUjS,iBACV/V,EACAwS,EACAlB,GAEF4I,GACEhF,EAAA,QACA+S,EACA,iBACAD,EAAU/Q,eACVjX,EACAwS,EACAlB,GAEF4I,GACExF,EAAA,QACAuT,EACA,kBACAD,EAAUlS,gBACV9V,EACAwS,EACAlB,GAEF4I,GACE9Q,EAAA,QACA6e,EACA,YACAD,EAAUS,UACVzoB,EACAwS,EACAlB,GAEF4I,GACE9Q,EAAA,QACA6e,EACA,eACAD,EAAU3a,aACVrN,EACAwS,EACAlB,GAEF4I,GACE/F,OACA8T,EACA,eACAD,EAAU1a,aACVtN,EACAwS,EACAlB,GAEF4I,GACErF,EAAA,EACAoT,EACA,yBACAD,EAAU1C,uBACVtlB,EACAwS,EACAlB,GAEF4I,GACErF,EAAA,EACAoT,EACA,6BACAD,EAAUzC,2BACVvlB,EACAwS,EACAlB,GAEF4I,GACErF,EAAA,EACAoT,EACA,kBACAD,EAAU3C,gBACVrlB,EACAwS,EACAlB,GAEF4I,GACEpF,EAAA,EACAmT,EACA,2BACAD,EAAU1R,yBACVtW,EACAwS,EACAlB,GAEF4I,GACE/F,OACA8T,EACA,2BACAD,EAAUvC,yBACVzlB,EACAwS,EACAlB,KAIJ,SAAsBiP,EAAQnB,EAAQ9N,EAAkBkB,GACtD,IAAIkW,EAAYtJ,EAAO3B,MACvB,GAAK,OAAAxX,EAAA,SAAQyiB,GAAb,CAIA,IAuJI3oB,EAAGqC,EAvJH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AAWkY,GAAmBoT,EAActrB,UAC5CurB,EAAYhL,EAAOgL,UAClB,OAAAtlB,EAAA,SAAQslB,KACXhL,EAAOgL,UAAYA,EAAY,IAAIC,GAAA,GAGrCtR,GACEhG,QACAqX,EACA,OACAD,EAAc7G,KACdzkB,EACAwS,EACAlB,GAEF4I,GACElF,EAAA,QACAuW,EACA,cACAD,EAAcG,YACdzrB,EACAwS,EACAlB,GAEF4I,GACE/F,OACAoX,EACA,SACAD,EAAc7X,OACdzT,EACAwS,EACAlB,GAEF4I,GACExF,EAAA,QACA6W,EACA,kBACAD,EAAcxV,gBACd9V,EACAwS,EACAlB,GAEF4I,GACE/F,OACAoX,EACA,iBACAD,EAAclF,eACdpmB,EACAwS,EACAlB,GAEF4I,GACExF,EAAA,QACA6W,EACA,0BACAD,EAAcjF,wBACdrmB,EACAwS,EACAlB,GAEF4I,GACE,GACAqR,EACA,WACAD,EAAchN,SACdte,EACAwS,EACAlB,GAEF4I,GACE,GACAqR,EACA,aACAD,EAAclE,WACdpnB,EACAwS,EACAlB,GAEF4I,GACE/F,OACAoX,EACA,cACAD,EAAchF,YACdtmB,EACAwS,EACAlB,GAEF4I,GACEhG,QACAqX,EACA,OACAD,EAAcxF,KACd9lB,EACAwS,EACAlB,GAEFgL,GACEiP,EACA,WACAD,EAAcvF,SACd/lB,EACAwS,EACAlB,GAEF4I,GACEhG,QACAqX,EACA,UACAD,EAActF,QACdhmB,EACAwS,EACAlB,GAEF4I,GACE9Q,EAAA,QACAmiB,EACA,eACAD,EAAcje,aACdrN,EACAwS,EACAlB,GAEF4I,GACE/F,OACAoX,EACA,eACAD,EAAche,aACdtN,EACAwS,EACAlB,GAEF4I,GACEnF,EAAA,EACAwW,EACA,UACAD,EAAcxU,QACd9W,EACAwS,EACAlB,GAEF4I,GACEpF,EAAA,EACAyW,EACA,2BACAD,EAAchV,yBACdtW,EACAwS,EACAlB,GAEF4I,GACE1F,EAAA,EACA+W,EACA,qBACAD,EAAc1V,mBACd5V,EACAwS,EACAlB,GAEF4I,GACE/F,OACAoX,EACA,SAC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","file":"2.TerriaJS-specs.js","sourcesContent":["/**\n * Style options for corners.\n *\n * @demo The {@link https://sandcastle.cesium.com/index.html?src=Corridor.html&label=Geometries|Corridor Demo}\n * demonstrates the three corner types, as used by {@link CorridorGraphics}.\n *\n * @enum {Number}\n */\nvar CornerType = {\n  /**\n   * <img src=\"Images/CornerTypeRounded.png\" style=\"vertical-align: middle;\" width=\"186\" height=\"189\" />\n   *\n   * Corner has a smooth edge.\n   * @type {Number}\n   * @constant\n   */\n  ROUNDED: 0,\n\n  /**\n   * <img src=\"Images/CornerTypeMitered.png\" style=\"vertical-align: middle;\" width=\"186\" height=\"189\" />\n   *\n   * Corner point is the intersection of adjacent edges.\n   * @type {Number}\n   * @constant\n   */\n  MITERED: 1,\n\n  /**\n   * <img src=\"Images/CornerTypeBeveled.png\" style=\"vertical-align: middle;\" width=\"186\" height=\"189\" />\n   *\n   * Corner is clipped.\n   * @type {Number}\n   * @constant\n   */\n  BEVELED: 2,\n};\nexport default Object.freeze(CornerType);\n","import defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Event from \"../Core/Event.js\";\nimport EventHelper from \"../Core/EventHelper.js\";\nimport TimeIntervalCollection from \"../Core/TimeIntervalCollection.js\";\nimport Property from \"./Property.js\";\n\nfunction subscribeAll(property, eventHelper, definitionChanged, intervals) {\n  function callback() {\n    definitionChanged.raiseEvent(property);\n  }\n  var items = [];\n  eventHelper.removeAll();\n  var length = intervals.length;\n  for (var i = 0; i < length; i++) {\n    var interval = intervals.get(i);\n    if (defined(interval.data) && items.indexOf(interval.data) === -1) {\n      eventHelper.add(interval.data.definitionChanged, callback);\n    }\n  }\n}\n\n/**\n * A {@link Property} which is defined by a {@link TimeIntervalCollection}, where the\n * data property of each {@link TimeInterval} is another Property instance which is\n * evaluated at the provided time.\n *\n * @alias CompositeProperty\n * @constructor\n *\n *\n * @example\n * var constantProperty = ...;\n * var sampledProperty = ...;\n *\n * //Create a composite property from two previously defined properties\n * //where the property is valid on August 1st, 2012 and uses a constant\n * //property for the first half of the day and a sampled property for the\n * //remaining half.\n * var composite = new Cesium.CompositeProperty();\n * composite.intervals.addInterval(Cesium.TimeInterval.fromIso8601({\n *     iso8601 : '2012-08-01T00:00:00.00Z/2012-08-01T12:00:00.00Z',\n *     data : constantProperty\n * }));\n * composite.intervals.addInterval(Cesium.TimeInterval.fromIso8601({\n *     iso8601 : '2012-08-01T12:00:00.00Z/2012-08-02T00:00:00.00Z',\n *     isStartIncluded : false,\n *     isStopIncluded : false,\n *     data : sampledProperty\n * }));\n *\n * @see CompositeMaterialProperty\n * @see CompositePositionProperty\n */\nfunction CompositeProperty() {\n  this._eventHelper = new EventHelper();\n  this._definitionChanged = new Event();\n  this._intervals = new TimeIntervalCollection();\n  this._intervals.changedEvent.addEventListener(\n    CompositeProperty.prototype._intervalsChanged,\n    this\n  );\n}\n\nObject.defineProperties(CompositeProperty.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.  A property is considered\n   * constant if getValue always returns the same result for the current definition.\n   * @memberof CompositeProperty.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      return this._intervals.isEmpty;\n    },\n  },\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * The definition is changed whenever setValue is called with data different\n   * than the current value.\n   * @memberof CompositeProperty.prototype\n   *\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n  /**\n   * Gets the interval collection.\n   * @memberof CompositeProperty.prototype\n   *\n   * @type {TimeIntervalCollection}\n   */\n  intervals: {\n    get: function () {\n      return this._intervals;\n    },\n  },\n});\n\n/**\n * Gets the value of the property at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nCompositeProperty.prototype.getValue = function (time, result) {\n  \n\n  var innerProperty = this._intervals.findDataForIntervalContainingDate(time);\n  if (defined(innerProperty)) {\n    return innerProperty.getValue(time, result);\n  }\n  return undefined;\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nCompositeProperty.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof CompositeProperty && //\n      this._intervals.equals(other._intervals, Property.equals))\n  );\n};\n\n/**\n * @private\n */\nCompositeProperty.prototype._intervalsChanged = function () {\n  subscribeAll(\n    this,\n    this._eventHelper,\n    this._definitionChanged,\n    this._intervals\n  );\n  this._definitionChanged.raiseEvent(this);\n};\nexport default CompositeProperty;\n","import CesiumMath from \"../Core/Math.js\";\n\n/**\n * Defines different modes for blending between a target color and a primitive's source color.\n *\n * HIGHLIGHT multiplies the source color by the target color\n * REPLACE replaces the source color with the target color\n * MIX blends the source color and target color together\n *\n * @enum {Number}\n *\n * @see Model.colorBlendMode\n */\nvar ColorBlendMode = {\n  HIGHLIGHT: 0,\n  REPLACE: 1,\n  MIX: 2,\n};\n\n/**\n * @private\n */\nColorBlendMode.getColorBlend = function (colorBlendMode, colorBlendAmount) {\n  if (colorBlendMode === ColorBlendMode.HIGHLIGHT) {\n    return 0.0;\n  } else if (colorBlendMode === ColorBlendMode.REPLACE) {\n    return 1.0;\n  } else if (colorBlendMode === ColorBlendMode.MIX) {\n    // The value 0.0 is reserved for highlight, so clamp to just above 0.0.\n    return CesiumMath.clamp(colorBlendAmount, CesiumMath.EPSILON4, 1.0);\n  }\n};\nexport default Object.freeze(ColorBlendMode);\n","import defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Event from \"../Core/Event.js\";\nimport ReferenceFrame from \"../Core/ReferenceFrame.js\";\nimport CompositeProperty from \"./CompositeProperty.js\";\nimport Property from \"./Property.js\";\n\n/**\n * A {@link CompositeProperty} which is also a {@link PositionProperty}.\n *\n * @alias CompositePositionProperty\n * @constructor\n *\n * @param {ReferenceFrame} [referenceFrame=ReferenceFrame.FIXED] The reference frame in which the position is defined.\n */\nfunction CompositePositionProperty(referenceFrame) {\n  this._referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n  this._definitionChanged = new Event();\n  this._composite = new CompositeProperty();\n  this._composite.definitionChanged.addEventListener(\n    CompositePositionProperty.prototype._raiseDefinitionChanged,\n    this\n  );\n}\n\nObject.defineProperties(CompositePositionProperty.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.  A property is considered\n   * constant if getValue always returns the same result for the current definition.\n   * @memberof CompositePositionProperty.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      return this._composite.isConstant;\n    },\n  },\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * The definition is changed whenever setValue is called with data different\n   * than the current value.\n   * @memberof CompositePositionProperty.prototype\n   *\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n  /**\n   * Gets the interval collection.\n   * @memberof CompositePositionProperty.prototype\n   *\n   * @type {TimeIntervalCollection}\n   */\n  intervals: {\n    get: function () {\n      return this._composite.intervals;\n    },\n  },\n  /**\n   * Gets or sets the reference frame which this position presents itself as.\n   * Each PositionProperty making up this object has it's own reference frame,\n   * so this property merely exposes a \"preferred\" reference frame for clients\n   * to use.\n   * @memberof CompositePositionProperty.prototype\n   *\n   * @type {ReferenceFrame}\n   */\n  referenceFrame: {\n    get: function () {\n      return this._referenceFrame;\n    },\n    set: function (value) {\n      this._referenceFrame = value;\n    },\n  },\n});\n\n/**\n * Gets the value of the property at the provided time in the fixed frame.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nCompositePositionProperty.prototype.getValue = function (time, result) {\n  return this.getValueInReferenceFrame(time, ReferenceFrame.FIXED, result);\n};\n\n/**\n * Gets the value of the property at the provided time and in the provided reference frame.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {ReferenceFrame} referenceFrame The desired referenceFrame of the result.\n * @param {Cartesian3} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Cartesian3} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nCompositePositionProperty.prototype.getValueInReferenceFrame = function (\n  time,\n  referenceFrame,\n  result\n) {\n  \n\n  var innerProperty = this._composite._intervals.findDataForIntervalContainingDate(\n    time\n  );\n  if (defined(innerProperty)) {\n    return innerProperty.getValueInReferenceFrame(time, referenceFrame, result);\n  }\n  return undefined;\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nCompositePositionProperty.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof CompositePositionProperty && //\n      this._referenceFrame === other._referenceFrame && //\n      this._composite.equals(other._composite, Property.equals))\n  );\n};\n\n/**\n * @private\n */\nCompositePositionProperty.prototype._raiseDefinitionChanged = function () {\n  this._definitionChanged.raiseEvent(this);\n};\nexport default CompositePositionProperty;\n","import defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Event from \"../Core/Event.js\";\nimport Property from \"./Property.js\";\n\nfunction resolve(that) {\n  var targetProperty = that._targetProperty;\n\n  if (!defined(targetProperty)) {\n    var targetEntity = that._targetEntity;\n\n    if (!defined(targetEntity)) {\n      targetEntity = that._targetCollection.getById(that._targetId);\n\n      if (!defined(targetEntity)) {\n        // target entity not found\n        that._targetEntity = that._targetProperty = undefined;\n        return;\n      }\n\n      // target entity was found. listen for changes to entity definition\n      targetEntity.definitionChanged.addEventListener(\n        ReferenceProperty.prototype._onTargetEntityDefinitionChanged,\n        that\n      );\n      that._targetEntity = targetEntity;\n    }\n\n    // walk the list of property names and resolve properties\n    var targetPropertyNames = that._targetPropertyNames;\n    targetProperty = that._targetEntity;\n    for (\n      var i = 0, len = targetPropertyNames.length;\n      i < len && defined(targetProperty);\n      ++i\n    ) {\n      targetProperty = targetProperty[targetPropertyNames[i]];\n    }\n\n    // target property may or may not be defined, depending on if it was found\n    that._targetProperty = targetProperty;\n  }\n\n  return targetProperty;\n}\n\n/**\n * A {@link Property} which transparently links to another property on a provided object.\n *\n * @alias ReferenceProperty\n * @constructor\n *\n * @param {EntityCollection} targetCollection The entity collection which will be used to resolve the reference.\n * @param {String} targetId The id of the entity which is being referenced.\n * @param {String[]} targetPropertyNames The names of the property on the target entity which we will use.\n *\n * @example\n * var collection = new Cesium.EntityCollection();\n *\n * //Create a new entity and assign a billboard scale.\n * var object1 = new Cesium.Entity({id:'object1'});\n * object1.billboard = new Cesium.BillboardGraphics();\n * object1.billboard.scale = new Cesium.ConstantProperty(2.0);\n * collection.add(object1);\n *\n * //Create a second entity and reference the scale from the first one.\n * var object2 = new Cesium.Entity({id:'object2'});\n * object2.model = new Cesium.ModelGraphics();\n * object2.model.scale = new Cesium.ReferenceProperty(collection, 'object1', ['billboard', 'scale']);\n * collection.add(object2);\n *\n * //Create a third object, but use the fromString helper function.\n * var object3 = new Cesium.Entity({id:'object3'});\n * object3.billboard = new Cesium.BillboardGraphics();\n * object3.billboard.scale = Cesium.ReferenceProperty.fromString(collection, 'object1#billboard.scale');\n * collection.add(object3);\n *\n * //You can refer to an entity with a # or . in id and property names by escaping them.\n * var object4 = new Cesium.Entity({id:'#object.4'});\n * object4.billboard = new Cesium.BillboardGraphics();\n * object4.billboard.scale = new Cesium.ConstantProperty(2.0);\n * collection.add(object4);\n *\n * var object5 = new Cesium.Entity({id:'object5'});\n * object5.billboard = new Cesium.BillboardGraphics();\n * object5.billboard.scale = Cesium.ReferenceProperty.fromString(collection, '\\\\#object\\\\.4#billboard.scale');\n * collection.add(object5);\n */\nfunction ReferenceProperty(targetCollection, targetId, targetPropertyNames) {\n  \n\n  this._targetCollection = targetCollection;\n  this._targetId = targetId;\n  this._targetPropertyNames = targetPropertyNames;\n  this._targetProperty = undefined;\n  this._targetEntity = undefined;\n  this._definitionChanged = new Event();\n\n  targetCollection.collectionChanged.addEventListener(\n    ReferenceProperty.prototype._onCollectionChanged,\n    this\n  );\n}\n\nObject.defineProperties(ReferenceProperty.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.\n   * @memberof ReferenceProperty.prototype\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      return Property.isConstant(resolve(this));\n    },\n  },\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * The definition is changed whenever the referenced property's definition is changed.\n   * @memberof ReferenceProperty.prototype\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n  /**\n   * Gets the reference frame that the position is defined in.\n   * This property is only valid if the referenced property is a {@link PositionProperty}.\n   * @memberof ReferenceProperty.prototype\n   * @type {ReferenceFrame}\n   * @readonly\n   */\n  referenceFrame: {\n    get: function () {\n      var target = resolve(this);\n      return defined(target) ? target.referenceFrame : undefined;\n    },\n  },\n  /**\n   * Gets the id of the entity being referenced.\n   * @memberof ReferenceProperty.prototype\n   * @type {String}\n   * @readonly\n   */\n  targetId: {\n    get: function () {\n      return this._targetId;\n    },\n  },\n  /**\n   * Gets the collection containing the entity being referenced.\n   * @memberof ReferenceProperty.prototype\n   * @type {EntityCollection}\n   * @readonly\n   */\n  targetCollection: {\n    get: function () {\n      return this._targetCollection;\n    },\n  },\n  /**\n   * Gets the array of property names used to retrieve the referenced property.\n   * @memberof ReferenceProperty.prototype\n   * @type {String[]}\n   * @readonly\n   */\n  targetPropertyNames: {\n    get: function () {\n      return this._targetPropertyNames;\n    },\n  },\n  /**\n   * Gets the resolved instance of the underlying referenced property.\n   * @memberof ReferenceProperty.prototype\n   * @type {Property|undefined}\n   * @readonly\n   */\n  resolvedProperty: {\n    get: function () {\n      return resolve(this);\n    },\n  },\n});\n\n/**\n * Creates a new instance given the entity collection that will\n * be used to resolve it and a string indicating the target entity id and property.\n * The format of the string is \"objectId#foo.bar\", where # separates the id from\n * property path and . separates sub-properties.  If the reference identifier or\n * or any sub-properties contains a # . or \\ they must be escaped.\n *\n * @param {EntityCollection} targetCollection\n * @param {String} referenceString\n * @returns {ReferenceProperty} A new instance of ReferenceProperty.\n *\n * @exception {DeveloperError} invalid referenceString.\n */\nReferenceProperty.fromString = function (targetCollection, referenceString) {\n  \n\n  var identifier;\n  var values = [];\n\n  var inIdentifier = true;\n  var isEscaped = false;\n  var token = \"\";\n  for (var i = 0; i < referenceString.length; ++i) {\n    var c = referenceString.charAt(i);\n\n    if (isEscaped) {\n      token += c;\n      isEscaped = false;\n    } else if (c === \"\\\\\") {\n      isEscaped = true;\n    } else if (inIdentifier && c === \"#\") {\n      identifier = token;\n      inIdentifier = false;\n      token = \"\";\n    } else if (!inIdentifier && c === \".\") {\n      values.push(token);\n      token = \"\";\n    } else {\n      token += c;\n    }\n  }\n  values.push(token);\n\n  return new ReferenceProperty(targetCollection, identifier, values);\n};\n\n/**\n * Gets the value of the property at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nReferenceProperty.prototype.getValue = function (time, result) {\n  var target = resolve(this);\n  return defined(target) ? target.getValue(time, result) : undefined;\n};\n\n/**\n * Gets the value of the property at the provided time and in the provided reference frame.\n * This method is only valid if the property being referenced is a {@link PositionProperty}.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {ReferenceFrame} referenceFrame The desired referenceFrame of the result.\n * @param {Cartesian3} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Cartesian3} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nReferenceProperty.prototype.getValueInReferenceFrame = function (\n  time,\n  referenceFrame,\n  result\n) {\n  var target = resolve(this);\n  return defined(target)\n    ? target.getValueInReferenceFrame(time, referenceFrame, result)\n    : undefined;\n};\n\n/**\n * Gets the {@link Material} type at the provided time.\n * This method is only valid if the property being referenced is a {@link MaterialProperty}.\n *\n * @param {JulianDate} time The time for which to retrieve the type.\n * @returns {String} The type of material.\n */\nReferenceProperty.prototype.getType = function (time) {\n  var target = resolve(this);\n  return defined(target) ? target.getType(time) : undefined;\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nReferenceProperty.prototype.equals = function (other) {\n  if (this === other) {\n    return true;\n  }\n\n  var names = this._targetPropertyNames;\n  var otherNames = other._targetPropertyNames;\n\n  if (\n    this._targetCollection !== other._targetCollection || //\n    this._targetId !== other._targetId || //\n    names.length !== otherNames.length\n  ) {\n    return false;\n  }\n\n  var length = this._targetPropertyNames.length;\n  for (var i = 0; i < length; i++) {\n    if (names[i] !== otherNames[i]) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\nReferenceProperty.prototype._onTargetEntityDefinitionChanged = function (\n  targetEntity,\n  name,\n  value,\n  oldValue\n) {\n  if (defined(this._targetProperty) && this._targetPropertyNames[0] === name) {\n    this._targetProperty = undefined;\n    this._definitionChanged.raiseEvent(this);\n  }\n};\n\nReferenceProperty.prototype._onCollectionChanged = function (\n  collection,\n  added,\n  removed\n) {\n  var targetEntity = this._targetEntity;\n  if (defined(targetEntity) && removed.indexOf(targetEntity) !== -1) {\n    targetEntity.definitionChanged.removeEventListener(\n      ReferenceProperty.prototype._onTargetEntityDefinitionChanged,\n      this\n    );\n    this._targetEntity = this._targetProperty = undefined;\n  } else if (!defined(targetEntity)) {\n    targetEntity = resolve(this);\n    if (defined(targetEntity)) {\n      this._definitionChanged.raiseEvent(this);\n    }\n  }\n};\nexport default ReferenceProperty;\n","import defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Ellipsoid from \"../Core/Ellipsoid.js\";\nimport Event from \"../Core/Event.js\";\nimport ReferenceFrame from \"../Core/ReferenceFrame.js\";\nimport Property from \"./Property.js\";\n\n/**\n * This is a temporary class for scaling position properties to the WGS84 surface.\n * It will go away or be refactored to support data with arbitrary height references.\n * @private\n */\nfunction ScaledPositionProperty(value) {\n  this._definitionChanged = new Event();\n  this._value = undefined;\n  this._removeSubscription = undefined;\n  this.setValue(value);\n}\n\nObject.defineProperties(ScaledPositionProperty.prototype, {\n  isConstant: {\n    get: function () {\n      return Property.isConstant(this._value);\n    },\n  },\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n  referenceFrame: {\n    get: function () {\n      return defined(this._value)\n        ? this._value.referenceFrame\n        : ReferenceFrame.FIXED;\n    },\n  },\n});\n\nScaledPositionProperty.prototype.getValue = function (time, result) {\n  return this.getValueInReferenceFrame(time, ReferenceFrame.FIXED, result);\n};\n\nScaledPositionProperty.prototype.setValue = function (value) {\n  if (this._value !== value) {\n    this._value = value;\n\n    if (defined(this._removeSubscription)) {\n      this._removeSubscription();\n      this._removeSubscription = undefined;\n    }\n\n    if (defined(value)) {\n      this._removeSubscription = value.definitionChanged.addEventListener(\n        this._raiseDefinitionChanged,\n        this\n      );\n    }\n    this._definitionChanged.raiseEvent(this);\n  }\n};\n\nScaledPositionProperty.prototype.getValueInReferenceFrame = function (\n  time,\n  referenceFrame,\n  result\n) {\n  \n\n  if (!defined(this._value)) {\n    return undefined;\n  }\n\n  result = this._value.getValueInReferenceFrame(time, referenceFrame, result);\n  return defined(result)\n    ? Ellipsoid.WGS84.scaleToGeodeticSurface(result, result)\n    : undefined;\n};\n\nScaledPositionProperty.prototype.equals = function (other) {\n  return (\n    this === other ||\n    (other instanceof ScaledPositionProperty && this._value === other._value)\n  );\n};\n\nScaledPositionProperty.prototype._raiseDefinitionChanged = function () {\n  this._definitionChanged.raiseEvent(this);\n};\nexport default ScaledPositionProperty;\n","import defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Event from \"../Core/Event.js\";\nimport EventHelper from \"../Core/EventHelper.js\";\nimport ReferenceFrame from \"../Core/ReferenceFrame.js\";\nimport Property from \"./Property.js\";\n\n/**\n * A {@link Property} whose value is an array whose items are the computed value\n * of other PositionProperty instances.\n *\n * @alias PositionPropertyArray\n * @constructor\n *\n * @param {Property[]} [value] An array of Property instances.\n * @param {ReferenceFrame} [referenceFrame=ReferenceFrame.FIXED] The reference frame in which the position is defined.\n */\nfunction PositionPropertyArray(value, referenceFrame) {\n  this._value = undefined;\n  this._definitionChanged = new Event();\n  this._eventHelper = new EventHelper();\n  this._referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n  this.setValue(value);\n}\n\nObject.defineProperties(PositionPropertyArray.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.  This property\n   * is considered constant if all property items in the array are constant.\n   * @memberof PositionPropertyArray.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      var value = this._value;\n      if (!defined(value)) {\n        return true;\n      }\n\n      var length = value.length;\n      for (var i = 0; i < length; i++) {\n        if (!Property.isConstant(value[i])) {\n          return false;\n        }\n      }\n      return true;\n    },\n  },\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * The definition is changed whenever setValue is called with data different\n   * than the current value or one of the properties in the array also changes.\n   * @memberof PositionPropertyArray.prototype\n   *\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n  /**\n   * Gets the reference frame in which the position is defined.\n   * @memberof PositionPropertyArray.prototype\n   * @type {ReferenceFrame}\n   * @default ReferenceFrame.FIXED;\n   */\n  referenceFrame: {\n    get: function () {\n      return this._referenceFrame;\n    },\n  },\n});\n\n/**\n * Gets the value of the property.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {Cartesian3[]} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Cartesian3[]} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nPositionPropertyArray.prototype.getValue = function (time, result) {\n  return this.getValueInReferenceFrame(time, ReferenceFrame.FIXED, result);\n};\n\n/**\n * Gets the value of the property at the provided time and in the provided reference frame.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {ReferenceFrame} referenceFrame The desired referenceFrame of the result.\n * @param {Cartesian3[]} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Cartesian3[]} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nPositionPropertyArray.prototype.getValueInReferenceFrame = function (\n  time,\n  referenceFrame,\n  result\n) {\n  \n\n  var value = this._value;\n  if (!defined(value)) {\n    return undefined;\n  }\n\n  var length = value.length;\n  if (!defined(result)) {\n    result = new Array(length);\n  }\n  var i = 0;\n  var x = 0;\n  while (i < length) {\n    var property = value[i];\n    var itemValue = property.getValueInReferenceFrame(\n      time,\n      referenceFrame,\n      result[i]\n    );\n    if (defined(itemValue)) {\n      result[x] = itemValue;\n      x++;\n    }\n    i++;\n  }\n  result.length = x;\n  return result;\n};\n\n/**\n * Sets the value of the property.\n *\n * @param {Property[]} value An array of Property instances.\n */\nPositionPropertyArray.prototype.setValue = function (value) {\n  var eventHelper = this._eventHelper;\n  eventHelper.removeAll();\n\n  if (defined(value)) {\n    this._value = value.slice();\n    var length = value.length;\n    for (var i = 0; i < length; i++) {\n      var property = value[i];\n      if (defined(property)) {\n        eventHelper.add(\n          property.definitionChanged,\n          PositionPropertyArray.prototype._raiseDefinitionChanged,\n          this\n        );\n      }\n    }\n  } else {\n    this._value = undefined;\n  }\n  this._definitionChanged.raiseEvent(this);\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nPositionPropertyArray.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof PositionPropertyArray && //\n      this._referenceFrame === other._referenceFrame && //\n      Property.arrayEquals(this._value, other._value))\n  );\n};\n\nPositionPropertyArray.prototype._raiseDefinitionChanged = function () {\n  this._definitionChanged.raiseEvent(this);\n};\nexport default PositionPropertyArray;\n","import defaultValue from \"./defaultValue.js\";\nimport defined from \"./defined.js\";\nimport DeveloperError from \"./DeveloperError.js\";\nimport CesiumMath from \"./Math.js\";\n\nvar factorial = CesiumMath.factorial;\n\nfunction calculateCoefficientTerm(\n  x,\n  zIndices,\n  xTable,\n  derivOrder,\n  termOrder,\n  reservedIndices\n) {\n  var result = 0;\n  var reserved;\n  var i;\n  var j;\n\n  if (derivOrder > 0) {\n    for (i = 0; i < termOrder; i++) {\n      reserved = false;\n      for (j = 0; j < reservedIndices.length && !reserved; j++) {\n        if (i === reservedIndices[j]) {\n          reserved = true;\n        }\n      }\n\n      if (!reserved) {\n        reservedIndices.push(i);\n        result += calculateCoefficientTerm(\n          x,\n          zIndices,\n          xTable,\n          derivOrder - 1,\n          termOrder,\n          reservedIndices\n        );\n        reservedIndices.splice(reservedIndices.length - 1, 1);\n      }\n    }\n\n    return result;\n  }\n\n  result = 1;\n  for (i = 0; i < termOrder; i++) {\n    reserved = false;\n    for (j = 0; j < reservedIndices.length && !reserved; j++) {\n      if (i === reservedIndices[j]) {\n        reserved = true;\n      }\n    }\n\n    if (!reserved) {\n      result *= x - xTable[zIndices[i]];\n    }\n  }\n\n  return result;\n}\n\n/**\n * An {@link InterpolationAlgorithm} for performing Hermite interpolation.\n *\n * @namespace HermitePolynomialApproximation\n */\nvar HermitePolynomialApproximation = {\n  type: \"Hermite\",\n};\n\n/**\n * Given the desired degree, returns the number of data points required for interpolation.\n *\n * @param {Number} degree The desired degree of interpolation.\n * @param {Number} [inputOrder=0]  The order of the inputs (0 means just the data, 1 means the data and its derivative, etc).\n * @returns {Number} The number of required data points needed for the desired degree of interpolation.\n * @exception {DeveloperError} degree must be 0 or greater.\n * @exception {DeveloperError} inputOrder must be 0 or greater.\n */\nHermitePolynomialApproximation.getRequiredDataPoints = function (\n  degree,\n  inputOrder\n) {\n  inputOrder = defaultValue(inputOrder, 0);\n\n  \n\n  return Math.max(Math.floor((degree + 1) / (inputOrder + 1)), 2);\n};\n\n/**\n * Interpolates values using Hermite Polynomial Approximation.\n *\n * @param {Number} x The independent variable for which the dependent variables will be interpolated.\n * @param {Number[]} xTable The array of independent variables to use to interpolate.  The values\n * in this array must be in increasing order and the same value must not occur twice in the array.\n * @param {Number[]} yTable The array of dependent variables to use to interpolate.  For a set of three\n * dependent values (p,q,w) at time 1 and time 2 this should be as follows: {p1, q1, w1, p2, q2, w2}.\n * @param {Number} yStride The number of dependent variable values in yTable corresponding to\n * each independent variable value in xTable.\n * @param {Number[]} [result] An existing array into which to store the result.\n * @returns {Number[]} The array of interpolated values, or the result parameter if one was provided.\n */\nHermitePolynomialApproximation.interpolateOrderZero = function (\n  x,\n  xTable,\n  yTable,\n  yStride,\n  result\n) {\n  if (!defined(result)) {\n    result = new Array(yStride);\n  }\n\n  var i;\n  var j;\n  var d;\n  var s;\n  var len;\n  var index;\n  var length = xTable.length;\n  var coefficients = new Array(yStride);\n\n  for (i = 0; i < yStride; i++) {\n    result[i] = 0;\n\n    var l = new Array(length);\n    coefficients[i] = l;\n    for (j = 0; j < length; j++) {\n      l[j] = [];\n    }\n  }\n\n  var zIndicesLength = length,\n    zIndices = new Array(zIndicesLength);\n\n  for (i = 0; i < zIndicesLength; i++) {\n    zIndices[i] = i;\n  }\n\n  var highestNonZeroCoef = length - 1;\n  for (s = 0; s < yStride; s++) {\n    for (j = 0; j < zIndicesLength; j++) {\n      index = zIndices[j] * yStride + s;\n      coefficients[s][0].push(yTable[index]);\n    }\n\n    for (i = 1; i < zIndicesLength; i++) {\n      var nonZeroCoefficients = false;\n      for (j = 0; j < zIndicesLength - i; j++) {\n        var zj = xTable[zIndices[j]];\n        var zn = xTable[zIndices[j + i]];\n\n        var numerator;\n        if (zn - zj <= 0) {\n          index = zIndices[j] * yStride + yStride * i + s;\n          numerator = yTable[index];\n          coefficients[s][i].push(numerator / factorial(i));\n        } else {\n          numerator = coefficients[s][i - 1][j + 1] - coefficients[s][i - 1][j];\n          coefficients[s][i].push(numerator / (zn - zj));\n        }\n        nonZeroCoefficients = nonZeroCoefficients || numerator !== 0;\n      }\n\n      if (!nonZeroCoefficients) {\n        highestNonZeroCoef = i - 1;\n      }\n    }\n  }\n\n  for (d = 0, len = 0; d <= len; d++) {\n    for (i = d; i <= highestNonZeroCoef; i++) {\n      var tempTerm = calculateCoefficientTerm(x, zIndices, xTable, d, i, []);\n      for (s = 0; s < yStride; s++) {\n        var coeff = coefficients[s][i][0];\n        result[s + d * yStride] += coeff * tempTerm;\n      }\n    }\n  }\n\n  return result;\n};\n\nvar arrayScratch = [];\n\n/**\n * Interpolates values using Hermite Polynomial Approximation.\n *\n * @param {Number} x The independent variable for which the dependent variables will be interpolated.\n * @param {Number[]} xTable The array of independent variables to use to interpolate.  The values\n * in this array must be in increasing order and the same value must not occur twice in the array.\n * @param {Number[]} yTable The array of dependent variables to use to interpolate.  For a set of three\n * dependent values (p,q,w) at time 1 and time 2 this should be as follows: {p1, q1, w1, p2, q2, w2}.\n * @param {Number} yStride The number of dependent variable values in yTable corresponding to\n * each independent variable value in xTable.\n * @param {Number} inputOrder The number of derivatives supplied for input.\n * @param {Number} outputOrder The number of derivatives desired for output.\n * @param {Number[]} [result] An existing array into which to store the result.\n *\n * @returns {Number[]} The array of interpolated values, or the result parameter if one was provided.\n */\nHermitePolynomialApproximation.interpolate = function (\n  x,\n  xTable,\n  yTable,\n  yStride,\n  inputOrder,\n  outputOrder,\n  result\n) {\n  var resultLength = yStride * (outputOrder + 1);\n  if (!defined(result)) {\n    result = new Array(resultLength);\n  }\n  for (var r = 0; r < resultLength; r++) {\n    result[r] = 0;\n  }\n\n  var length = xTable.length;\n  // The zIndices array holds copies of the addresses of the xTable values\n  // in the range we're looking at. Even though this just holds information already\n  // available in xTable this is a much more convenient format.\n  var zIndices = new Array(length * (inputOrder + 1));\n  var i;\n  for (i = 0; i < length; i++) {\n    for (var j = 0; j < inputOrder + 1; j++) {\n      zIndices[i * (inputOrder + 1) + j] = i;\n    }\n  }\n\n  var zIndiceslength = zIndices.length;\n  var coefficients = arrayScratch;\n  var highestNonZeroCoef = fillCoefficientList(\n    coefficients,\n    zIndices,\n    xTable,\n    yTable,\n    yStride,\n    inputOrder\n  );\n  var reservedIndices = [];\n\n  var tmp = (zIndiceslength * (zIndiceslength + 1)) / 2;\n  var loopStop = Math.min(highestNonZeroCoef, outputOrder);\n  for (var d = 0; d <= loopStop; d++) {\n    for (i = d; i <= highestNonZeroCoef; i++) {\n      reservedIndices.length = 0;\n      var tempTerm = calculateCoefficientTerm(\n        x,\n        zIndices,\n        xTable,\n        d,\n        i,\n        reservedIndices\n      );\n      var dimTwo = Math.floor((i * (1 - i)) / 2) + zIndiceslength * i;\n\n      for (var s = 0; s < yStride; s++) {\n        var dimOne = Math.floor(s * tmp);\n        var coef = coefficients[dimOne + dimTwo];\n        result[s + d * yStride] += coef * tempTerm;\n      }\n    }\n  }\n\n  return result;\n};\n\nfunction fillCoefficientList(\n  coefficients,\n  zIndices,\n  xTable,\n  yTable,\n  yStride,\n  inputOrder\n) {\n  var j;\n  var index;\n  var highestNonZero = -1;\n  var zIndiceslength = zIndices.length;\n  var tmp = (zIndiceslength * (zIndiceslength + 1)) / 2;\n\n  for (var s = 0; s < yStride; s++) {\n    var dimOne = Math.floor(s * tmp);\n\n    for (j = 0; j < zIndiceslength; j++) {\n      index = zIndices[j] * yStride * (inputOrder + 1) + s;\n      coefficients[dimOne + j] = yTable[index];\n    }\n\n    for (var i = 1; i < zIndiceslength; i++) {\n      var coefIndex = 0;\n      var dimTwo = Math.floor((i * (1 - i)) / 2) + zIndiceslength * i;\n      var nonZeroCoefficients = false;\n\n      for (j = 0; j < zIndiceslength - i; j++) {\n        var zj = xTable[zIndices[j]];\n        var zn = xTable[zIndices[j + i]];\n\n        var numerator;\n        var coefficient;\n        if (zn - zj <= 0) {\n          index = zIndices[j] * yStride * (inputOrder + 1) + yStride * i + s;\n          numerator = yTable[index];\n          coefficient = numerator / CesiumMath.factorial(i);\n          coefficients[dimOne + dimTwo + coefIndex] = coefficient;\n          coefIndex++;\n        } else {\n          var dimTwoMinusOne =\n            Math.floor(((i - 1) * (2 - i)) / 2) + zIndiceslength * (i - 1);\n          numerator =\n            coefficients[dimOne + dimTwoMinusOne + j + 1] -\n            coefficients[dimOne + dimTwoMinusOne + j];\n          coefficient = numerator / (zn - zj);\n          coefficients[dimOne + dimTwo + coefIndex] = coefficient;\n          coefIndex++;\n        }\n        nonZeroCoefficients = nonZeroCoefficients || numerator !== 0.0;\n      }\n\n      if (nonZeroCoefficients) {\n        highestNonZero = Math.max(highestNonZero, i);\n      }\n    }\n  }\n\n  return highestNonZero;\n}\nexport default HermitePolynomialApproximation;\n","import defined from \"./defined.js\";\n\n/**\n * An {@link InterpolationAlgorithm} for performing Lagrange interpolation.\n *\n * @namespace LagrangePolynomialApproximation\n */\nvar LagrangePolynomialApproximation = {\n  type: \"Lagrange\",\n};\n\n/**\n * Given the desired degree, returns the number of data points required for interpolation.\n *\n * @param {Number} degree The desired degree of interpolation.\n * @returns {Number} The number of required data points needed for the desired degree of interpolation.\n */\nLagrangePolynomialApproximation.getRequiredDataPoints = function (degree) {\n  return Math.max(degree + 1.0, 2);\n};\n\n/**\n * Interpolates values using Lagrange Polynomial Approximation.\n *\n * @param {Number} x The independent variable for which the dependent variables will be interpolated.\n * @param {Number[]} xTable The array of independent variables to use to interpolate.  The values\n * in this array must be in increasing order and the same value must not occur twice in the array.\n * @param {Number[]} yTable The array of dependent variables to use to interpolate.  For a set of three\n * dependent values (p,q,w) at time 1 and time 2 this should be as follows: {p1, q1, w1, p2, q2, w2}.\n * @param {Number} yStride The number of dependent variable values in yTable corresponding to\n * each independent variable value in xTable.\n * @param {Number[]} [result] An existing array into which to store the result.\n * @returns {Number[]} The array of interpolated values, or the result parameter if one was provided.\n */\nLagrangePolynomialApproximation.interpolateOrderZero = function (\n  x,\n  xTable,\n  yTable,\n  yStride,\n  result\n) {\n  if (!defined(result)) {\n    result = new Array(yStride);\n  }\n\n  var i;\n  var j;\n  var length = xTable.length;\n\n  for (i = 0; i < yStride; i++) {\n    result[i] = 0;\n  }\n\n  for (i = 0; i < length; i++) {\n    var coefficient = 1;\n\n    for (j = 0; j < length; j++) {\n      if (j !== i) {\n        var diffX = xTable[i] - xTable[j];\n        coefficient *= (x - xTable[j]) / diffX;\n      }\n    }\n\n    for (j = 0; j < yStride; j++) {\n      result[j] += coefficient * yTable[i * yStride + j];\n    }\n  }\n\n  return result;\n};\nexport default LagrangePolynomialApproximation;\n","import Check from \"./Check.js\";\nimport defaultValue from \"./defaultValue.js\";\nimport defined from \"./defined.js\";\n\n/**\n * A set of curvilinear 3-dimensional coordinates.\n *\n * @alias Spherical\n * @constructor\n *\n * @param {Number} [clock=0.0] The angular coordinate lying in the xy-plane measured from the positive x-axis and toward the positive y-axis.\n * @param {Number} [cone=0.0] The angular coordinate measured from the positive z-axis and toward the negative z-axis.\n * @param {Number} [magnitude=1.0] The linear coordinate measured from the origin.\n */\nfunction Spherical(clock, cone, magnitude) {\n  /**\n   * The clock component.\n   * @type {Number}\n   * @default 0.0\n   */\n  this.clock = defaultValue(clock, 0.0);\n  /**\n   * The cone component.\n   * @type {Number}\n   * @default 0.0\n   */\n  this.cone = defaultValue(cone, 0.0);\n  /**\n   * The magnitude component.\n   * @type {Number}\n   * @default 1.0\n   */\n  this.magnitude = defaultValue(magnitude, 1.0);\n}\n\n/**\n * Converts the provided Cartesian3 into Spherical coordinates.\n *\n * @param {Cartesian3} cartesian3 The Cartesian3 to be converted to Spherical.\n * @param {Spherical} [result] The object in which the result will be stored, if undefined a new instance will be created.\n * @returns {Spherical} The modified result parameter, or a new instance if one was not provided.\n */\nSpherical.fromCartesian3 = function (cartesian3, result) {\n  \n\n  var x = cartesian3.x;\n  var y = cartesian3.y;\n  var z = cartesian3.z;\n  var radialSquared = x * x + y * y;\n\n  if (!defined(result)) {\n    result = new Spherical();\n  }\n\n  result.clock = Math.atan2(y, x);\n  result.cone = Math.atan2(Math.sqrt(radialSquared), z);\n  result.magnitude = Math.sqrt(radialSquared + z * z);\n  return result;\n};\n\n/**\n * Creates a duplicate of a Spherical.\n *\n * @param {Spherical} spherical The spherical to clone.\n * @param {Spherical} [result] The object to store the result into, if undefined a new instance will be created.\n * @returns {Spherical} The modified result parameter or a new instance if result was undefined. (Returns undefined if spherical is undefined)\n */\nSpherical.clone = function (spherical, result) {\n  if (!defined(spherical)) {\n    return undefined;\n  }\n\n  if (!defined(result)) {\n    return new Spherical(spherical.clock, spherical.cone, spherical.magnitude);\n  }\n\n  result.clock = spherical.clock;\n  result.cone = spherical.cone;\n  result.magnitude = spherical.magnitude;\n  return result;\n};\n\n/**\n * Computes the normalized version of the provided spherical.\n *\n * @param {Spherical} spherical The spherical to be normalized.\n * @param {Spherical} [result] The object to store the result into, if undefined a new instance will be created.\n * @returns {Spherical} The modified result parameter or a new instance if result was undefined.\n */\nSpherical.normalize = function (spherical, result) {\n  \n\n  if (!defined(result)) {\n    return new Spherical(spherical.clock, spherical.cone, 1.0);\n  }\n\n  result.clock = spherical.clock;\n  result.cone = spherical.cone;\n  result.magnitude = 1.0;\n  return result;\n};\n\n/**\n * Returns true if the first spherical is equal to the second spherical, false otherwise.\n *\n * @param {Spherical} left The first Spherical to be compared.\n * @param {Spherical} right The second Spherical to be compared.\n * @returns {Boolean} true if the first spherical is equal to the second spherical, false otherwise.\n */\nSpherical.equals = function (left, right) {\n  return (\n    left === right ||\n    (defined(left) &&\n      defined(right) &&\n      left.clock === right.clock &&\n      left.cone === right.cone &&\n      left.magnitude === right.magnitude)\n  );\n};\n\n/**\n * Returns true if the first spherical is within the provided epsilon of the second spherical, false otherwise.\n *\n * @param {Spherical} left The first Spherical to be compared.\n * @param {Spherical} right The second Spherical to be compared.\n * @param {Number} [epsilon=0.0] The epsilon to compare against.\n * @returns {Boolean} true if the first spherical is within the provided epsilon of the second spherical, false otherwise.\n */\nSpherical.equalsEpsilon = function (left, right, epsilon) {\n  epsilon = defaultValue(epsilon, 0.0);\n  return (\n    left === right ||\n    (defined(left) &&\n      defined(right) &&\n      Math.abs(left.clock - right.clock) <= epsilon &&\n      Math.abs(left.cone - right.cone) <= epsilon &&\n      Math.abs(left.magnitude - right.magnitude) <= epsilon)\n  );\n};\n\n/**\n * Returns true if this spherical is equal to the provided spherical, false otherwise.\n *\n * @param {Spherical} other The Spherical to be compared.\n * @returns {Boolean} true if this spherical is equal to the provided spherical, false otherwise.\n */\nSpherical.prototype.equals = function (other) {\n  return Spherical.equals(this, other);\n};\n\n/**\n * Creates a duplicate of this Spherical.\n *\n * @param {Spherical} [result] The object to store the result into, if undefined a new instance will be created.\n * @returns {Spherical} The modified result parameter or a new instance if result was undefined.\n */\nSpherical.prototype.clone = function (result) {\n  return Spherical.clone(this, result);\n};\n\n/**\n * Returns true if this spherical is within the provided epsilon of the provided spherical, false otherwise.\n *\n * @param {Spherical} other The Spherical to be compared.\n * @param {Number} epsilon The epsilon to compare against.\n * @returns {Boolean} true if this spherical is within the provided epsilon of the provided spherical, false otherwise.\n */\nSpherical.prototype.equalsEpsilon = function (other, epsilon) {\n  return Spherical.equalsEpsilon(this, other, epsilon);\n};\n\n/**\n * Returns a string representing this instance in the format (clock, cone, magnitude).\n *\n * @returns {String} A string representing this instance.\n */\nSpherical.prototype.toString = function () {\n  return \"(\" + this.clock + \", \" + this.cone + \", \" + this.magnitude + \")\";\n};\nexport default Spherical;\n","import Cartesian2 from \"../Core/Cartesian2.js\";\nimport Color from \"../Core/Color.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport Event from \"../Core/Event.js\";\nimport createPropertyDescriptor from \"./createPropertyDescriptor.js\";\nimport Property from \"./Property.js\";\n\nvar defaultEvenColor = Color.WHITE;\nvar defaultOddColor = Color.BLACK;\nvar defaultRepeat = new Cartesian2(2.0, 2.0);\n\n/**\n * A {@link MaterialProperty} that maps to checkerboard {@link Material} uniforms.\n * @alias CheckerboardMaterialProperty\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Property|Color} [options.evenColor=Color.WHITE] A Property specifying the first {@link Color}.\n * @param {Property|Color} [options.oddColor=Color.BLACK] A Property specifying the second {@link Color}.\n * @param {Property|Cartesian2} [options.repeat=new Cartesian2(2.0, 2.0)] A {@link Cartesian2} Property specifying how many times the tiles repeat in each direction.\n */\nfunction CheckerboardMaterialProperty(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  this._definitionChanged = new Event();\n  this._evenColor = undefined;\n  this._evenColorSubscription = undefined;\n  this._oddColor = undefined;\n  this._oddColorSubscription = undefined;\n  this._repeat = undefined;\n  this._repeatSubscription = undefined;\n\n  this.evenColor = options.evenColor;\n  this.oddColor = options.oddColor;\n  this.repeat = options.repeat;\n}\n\nObject.defineProperties(CheckerboardMaterialProperty.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.  A property is considered\n   * constant if getValue always returns the same result for the current definition.\n   * @memberof CheckerboardMaterialProperty.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      return (\n        Property.isConstant(this._evenColor) && //\n        Property.isConstant(this._oddColor) && //\n        Property.isConstant(this._repeat)\n      );\n    },\n  },\n\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * The definition is considered to have changed if a call to getValue would return\n   * a different result for the same time.\n   * @memberof CheckerboardMaterialProperty.prototype\n   *\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n\n  /**\n   * Gets or sets the Property specifying the first {@link Color}.\n   * @memberof CheckerboardMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default Color.WHITE\n   */\n  evenColor: createPropertyDescriptor(\"evenColor\"),\n\n  /**\n   * Gets or sets the Property specifying the second {@link Color}.\n   * @memberof CheckerboardMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default Color.BLACK\n   */\n  oddColor: createPropertyDescriptor(\"oddColor\"),\n\n  /**\n   * Gets or sets the {@link Cartesian2} Property specifying how many times the tiles repeat in each direction.\n   * @memberof CheckerboardMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default new Cartesian2(2.0, 2.0)\n   */\n  repeat: createPropertyDescriptor(\"repeat\"),\n});\n\n/**\n * Gets the {@link Material} type at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the type.\n * @returns {String} The type of material.\n */\nCheckerboardMaterialProperty.prototype.getType = function (time) {\n  return \"Checkerboard\";\n};\n\n/**\n * Gets the value of the property at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nCheckerboardMaterialProperty.prototype.getValue = function (time, result) {\n  if (!defined(result)) {\n    result = {};\n  }\n  result.lightColor = Property.getValueOrClonedDefault(\n    this._evenColor,\n    time,\n    defaultEvenColor,\n    result.lightColor\n  );\n  result.darkColor = Property.getValueOrClonedDefault(\n    this._oddColor,\n    time,\n    defaultOddColor,\n    result.darkColor\n  );\n  result.repeat = Property.getValueOrDefault(this._repeat, time, defaultRepeat);\n  return result;\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nCheckerboardMaterialProperty.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof CheckerboardMaterialProperty && //\n      Property.equals(this._evenColor, other._evenColor) && //\n      Property.equals(this._oddColor, other._oddColor) && //\n      Property.equals(this._repeat, other._repeat))\n  );\n};\nexport default CheckerboardMaterialProperty;\n","import defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Event from \"../Core/Event.js\";\nimport CompositeProperty from \"./CompositeProperty.js\";\nimport Property from \"./Property.js\";\n\n/**\n * A {@link CompositeProperty} which is also a {@link MaterialProperty}.\n *\n * @alias CompositeMaterialProperty\n * @constructor\n */\nfunction CompositeMaterialProperty() {\n  this._definitionChanged = new Event();\n  this._composite = new CompositeProperty();\n  this._composite.definitionChanged.addEventListener(\n    CompositeMaterialProperty.prototype._raiseDefinitionChanged,\n    this\n  );\n}\n\nObject.defineProperties(CompositeMaterialProperty.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.  A property is considered\n   * constant if getValue always returns the same result for the current definition.\n   * @memberof CompositeMaterialProperty.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      return this._composite.isConstant;\n    },\n  },\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * The definition is changed whenever setValue is called with data different\n   * than the current value.\n   * @memberof CompositeMaterialProperty.prototype\n   *\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n  /**\n   * Gets the interval collection.\n   * @memberof CompositeMaterialProperty.prototype\n   *\n   * @type {TimeIntervalCollection}\n   */\n  intervals: {\n    get: function () {\n      return this._composite._intervals;\n    },\n  },\n});\n\n/**\n * Gets the {@link Material} type at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the type.\n * @returns {String} The type of material.\n */\nCompositeMaterialProperty.prototype.getType = function (time) {\n  \n\n  var innerProperty = this._composite._intervals.findDataForIntervalContainingDate(\n    time\n  );\n  if (defined(innerProperty)) {\n    return innerProperty.getType(time);\n  }\n  return undefined;\n};\n\n/**\n * Gets the value of the property at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nCompositeMaterialProperty.prototype.getValue = function (time, result) {\n  \n\n  var innerProperty = this._composite._intervals.findDataForIntervalContainingDate(\n    time\n  );\n  if (defined(innerProperty)) {\n    return innerProperty.getValue(time, result);\n  }\n  return undefined;\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nCompositeMaterialProperty.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof CompositeMaterialProperty && //\n      this._composite.equals(other._composite, Property.equals))\n  );\n};\n\n/**\n * @private\n */\nCompositeMaterialProperty.prototype._raiseDefinitionChanged = function () {\n  this._definitionChanged.raiseEvent(this);\n};\nexport default CompositeMaterialProperty;\n","import Cartesian2 from \"../Core/Cartesian2.js\";\nimport Color from \"../Core/Color.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport Event from \"../Core/Event.js\";\nimport createPropertyDescriptor from \"./createPropertyDescriptor.js\";\nimport Property from \"./Property.js\";\n\nvar defaultColor = Color.WHITE;\nvar defaultCellAlpha = 0.1;\nvar defaultLineCount = new Cartesian2(8, 8);\nvar defaultLineOffset = new Cartesian2(0, 0);\nvar defaultLineThickness = new Cartesian2(1, 1);\n\n/**\n * A {@link MaterialProperty} that maps to grid {@link Material} uniforms.\n * @alias GridMaterialProperty\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Property|Color} [options.color=Color.WHITE] A Property specifying the grid {@link Color}.\n * @param {Property|Number} [options.cellAlpha=0.1] A numeric Property specifying cell alpha values.\n * @param {Property|Cartesian2} [options.lineCount=new Cartesian2(8, 8)] A {@link Cartesian2} Property specifying the number of grid lines along each axis.\n * @param {Property|Cartesian2} [options.lineThickness=new Cartesian2(1.0, 1.0)] A {@link Cartesian2} Property specifying the thickness of grid lines along each axis.\n * @param {Property|Cartesian2} [options.lineOffset=new Cartesian2(0.0, 0.0)] A {@link Cartesian2} Property specifying starting offset of grid lines along each axis.\n *\n * @constructor\n */\nfunction GridMaterialProperty(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  this._definitionChanged = new Event();\n  this._color = undefined;\n  this._colorSubscription = undefined;\n  this._cellAlpha = undefined;\n  this._cellAlphaSubscription = undefined;\n  this._lineCount = undefined;\n  this._lineCountSubscription = undefined;\n  this._lineThickness = undefined;\n  this._lineThicknessSubscription = undefined;\n  this._lineOffset = undefined;\n  this._lineOffsetSubscription = undefined;\n\n  this.color = options.color;\n  this.cellAlpha = options.cellAlpha;\n  this.lineCount = options.lineCount;\n  this.lineThickness = options.lineThickness;\n  this.lineOffset = options.lineOffset;\n}\n\nObject.defineProperties(GridMaterialProperty.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.  A property is considered\n   * constant if getValue always returns the same result for the current definition.\n   * @memberof GridMaterialProperty.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      return (\n        Property.isConstant(this._color) &&\n        Property.isConstant(this._cellAlpha) &&\n        Property.isConstant(this._lineCount) &&\n        Property.isConstant(this._lineThickness) &&\n        Property.isConstant(this._lineOffset)\n      );\n    },\n  },\n\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * The definition is considered to have changed if a call to getValue would return\n   * a different result for the same time.\n   * @memberof GridMaterialProperty.prototype\n   *\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n\n  /**\n   * Gets or sets the Property specifying the grid {@link Color}.\n   * @memberof GridMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default Color.WHITE\n   */\n  color: createPropertyDescriptor(\"color\"),\n\n  /**\n   * Gets or sets the numeric Property specifying cell alpha values.\n   * @memberof GridMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default 0.1\n   */\n  cellAlpha: createPropertyDescriptor(\"cellAlpha\"),\n\n  /**\n   * Gets or sets the {@link Cartesian2} Property specifying the number of grid lines along each axis.\n   * @memberof GridMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default new Cartesian2(8.0, 8.0)\n   */\n  lineCount: createPropertyDescriptor(\"lineCount\"),\n\n  /**\n   * Gets or sets the {@link Cartesian2} Property specifying the thickness of grid lines along each axis.\n   * @memberof GridMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default new Cartesian2(1.0, 1.0)\n   */\n  lineThickness: createPropertyDescriptor(\"lineThickness\"),\n\n  /**\n   * Gets or sets the {@link Cartesian2} Property specifying the starting offset of grid lines along each axis.\n   * @memberof GridMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default new Cartesian2(0.0, 0.0)\n   */\n  lineOffset: createPropertyDescriptor(\"lineOffset\"),\n});\n\n/**\n * Gets the {@link Material} type at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the type.\n * @returns {String} The type of material.\n */\nGridMaterialProperty.prototype.getType = function (time) {\n  return \"Grid\";\n};\n\n/**\n * Gets the value of the property at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nGridMaterialProperty.prototype.getValue = function (time, result) {\n  if (!defined(result)) {\n    result = {};\n  }\n  result.color = Property.getValueOrClonedDefault(\n    this._color,\n    time,\n    defaultColor,\n    result.color\n  );\n  result.cellAlpha = Property.getValueOrDefault(\n    this._cellAlpha,\n    time,\n    defaultCellAlpha\n  );\n  result.lineCount = Property.getValueOrClonedDefault(\n    this._lineCount,\n    time,\n    defaultLineCount,\n    result.lineCount\n  );\n  result.lineThickness = Property.getValueOrClonedDefault(\n    this._lineThickness,\n    time,\n    defaultLineThickness,\n    result.lineThickness\n  );\n  result.lineOffset = Property.getValueOrClonedDefault(\n    this._lineOffset,\n    time,\n    defaultLineOffset,\n    result.lineOffset\n  );\n  return result;\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nGridMaterialProperty.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof GridMaterialProperty && //\n      Property.equals(this._color, other._color) && //\n      Property.equals(this._cellAlpha, other._cellAlpha) && //\n      Property.equals(this._lineCount, other._lineCount) && //\n      Property.equals(this._lineThickness, other._lineThickness) && //\n      Property.equals(this._lineOffset, other._lineOffset))\n  );\n};\nexport default GridMaterialProperty;\n","import Color from \"../Core/Color.js\";\nimport defined from \"../Core/defined.js\";\nimport Event from \"../Core/Event.js\";\nimport createPropertyDescriptor from \"./createPropertyDescriptor.js\";\nimport Property from \"./Property.js\";\n\n/**\n * A {@link MaterialProperty} that maps to PolylineArrow {@link Material} uniforms.\n *\n * @param {Property|Color} [color=Color.WHITE] The {@link Color} Property to be used.\n *\n * @alias PolylineArrowMaterialProperty\n * @constructor\n */\nfunction PolylineArrowMaterialProperty(color) {\n  this._definitionChanged = new Event();\n  this._color = undefined;\n  this._colorSubscription = undefined;\n\n  this.color = color;\n}\n\nObject.defineProperties(PolylineArrowMaterialProperty.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.  A property is considered\n   * constant if getValue always returns the same result for the current definition.\n   * @memberof PolylineArrowMaterialProperty.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      return Property.isConstant(this._color);\n    },\n  },\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * The definition is considered to have changed if a call to getValue would return\n   * a different result for the same time.\n   * @memberof PolylineArrowMaterialProperty.prototype\n   *\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n  /**\n   * Gets or sets the {@link Color} {@link Property}.\n   * @memberof PolylineArrowMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default Color.WHITE\n   */\n  color: createPropertyDescriptor(\"color\"),\n});\n\n/**\n * Gets the {@link Material} type at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the type.\n * @returns {String} The type of material.\n */\nPolylineArrowMaterialProperty.prototype.getType = function (time) {\n  return \"PolylineArrow\";\n};\n\n/**\n * Gets the value of the property at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nPolylineArrowMaterialProperty.prototype.getValue = function (time, result) {\n  if (!defined(result)) {\n    result = {};\n  }\n  result.color = Property.getValueOrClonedDefault(\n    this._color,\n    time,\n    Color.WHITE,\n    result.color\n  );\n  return result;\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nPolylineArrowMaterialProperty.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof PolylineArrowMaterialProperty && //\n      Property.equals(this._color, other._color))\n  );\n};\nexport default PolylineArrowMaterialProperty;\n","import Color from \"../Core/Color.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport Event from \"../Core/Event.js\";\nimport createPropertyDescriptor from \"./createPropertyDescriptor.js\";\nimport Property from \"./Property.js\";\n\nvar defaultColor = Color.WHITE;\nvar defaultGapColor = Color.TRANSPARENT;\nvar defaultDashLength = 16.0;\nvar defaultDashPattern = 255.0;\n\n/**\n * A {@link MaterialProperty} that maps to polyline dash {@link Material} uniforms.\n * @alias PolylineDashMaterialProperty\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Property|Color} [options.color=Color.WHITE] A Property specifying the {@link Color} of the line.\n * @param {Property|Color} [options.gapColor=Color.TRANSPARENT] A Property specifying the {@link Color} of the gaps in the line.\n * @param {Property|Number} [options.dashLength=16.0] A numeric Property specifying the length of the dash pattern in pixels.\n * @param {Property|Number} [options.dashPattern=255.0] A numeric Property specifying a 16 bit pattern for the dash\n */\nfunction PolylineDashMaterialProperty(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  this._definitionChanged = new Event();\n  this._color = undefined;\n  this._colorSubscription = undefined;\n  this._gapColor = undefined;\n  this._gapColorSubscription = undefined;\n  this._dashLength = undefined;\n  this._dashLengthSubscription = undefined;\n  this._dashPattern = undefined;\n  this._dashPatternSubscription = undefined;\n\n  this.color = options.color;\n  this.gapColor = options.gapColor;\n  this.dashLength = options.dashLength;\n  this.dashPattern = options.dashPattern;\n}\n\nObject.defineProperties(PolylineDashMaterialProperty.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.  A property is considered\n   * constant if getValue always returns the same result for the current definition.\n   * @memberof PolylineDashMaterialProperty.prototype\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      return (\n        Property.isConstant(this._color) &&\n        Property.isConstant(this._gapColor) &&\n        Property.isConstant(this._dashLength) &&\n        Property.isConstant(this._dashPattern)\n      );\n    },\n  },\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * The definition is considered to have changed if a call to getValue would return\n   * a different result for the same time.\n   * @memberof PolylineDashMaterialProperty.prototype\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n  /**\n   * Gets or sets the Property specifying the {@link Color} of the line.\n   * @memberof PolylineDashMaterialProperty.prototype\n   * @type {Property|undefined}\n   */\n  color: createPropertyDescriptor(\"color\"),\n\n  /**\n   * Gets or sets the Property specifying the {@link Color} of the gaps in the line.\n   * @memberof PolylineDashMaterialProperty.prototype\n   * @type {Property|undefined}\n   */\n  gapColor: createPropertyDescriptor(\"gapColor\"),\n\n  /**\n   * Gets or sets the numeric Property specifying the length of a dash cycle\n   * @memberof PolylineDashMaterialProperty.prototype\n   * @type {Property|undefined}\n   */\n  dashLength: createPropertyDescriptor(\"dashLength\"),\n\n  /**\n   * Gets or sets the numeric Property specifying a dash pattern\n   * @memberof PolylineDashMaterialProperty.prototype\n   * @type {Property|undefined}\n   */\n  dashPattern: createPropertyDescriptor(\"dashPattern\"),\n});\n\n/**\n * Gets the {@link Material} type at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the type.\n * @returns {String} The type of material.\n */\nPolylineDashMaterialProperty.prototype.getType = function (time) {\n  return \"PolylineDash\";\n};\n\n/**\n * Gets the value of the property at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nPolylineDashMaterialProperty.prototype.getValue = function (time, result) {\n  if (!defined(result)) {\n    result = {};\n  }\n  result.color = Property.getValueOrClonedDefault(\n    this._color,\n    time,\n    defaultColor,\n    result.color\n  );\n  result.gapColor = Property.getValueOrClonedDefault(\n    this._gapColor,\n    time,\n    defaultGapColor,\n    result.gapColor\n  );\n  result.dashLength = Property.getValueOrDefault(\n    this._dashLength,\n    time,\n    defaultDashLength,\n    result.dashLength\n  );\n  result.dashPattern = Property.getValueOrDefault(\n    this._dashPattern,\n    time,\n    defaultDashPattern,\n    result.dashPattern\n  );\n  return result;\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nPolylineDashMaterialProperty.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof PolylineDashMaterialProperty &&\n      Property.equals(this._color, other._color) &&\n      Property.equals(this._gapColor, other._gapColor) &&\n      Property.equals(this._dashLength, other._dashLength) &&\n      Property.equals(this._dashPattern, other._dashPattern))\n  );\n};\nexport default PolylineDashMaterialProperty;\n","import Color from \"../Core/Color.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport Event from \"../Core/Event.js\";\nimport createPropertyDescriptor from \"./createPropertyDescriptor.js\";\nimport Property from \"./Property.js\";\n\nvar defaultColor = Color.WHITE;\nvar defaultOutlineColor = Color.BLACK;\nvar defaultOutlineWidth = 1.0;\n\n/**\n * A {@link MaterialProperty} that maps to polyline outline {@link Material} uniforms.\n * @alias PolylineOutlineMaterialProperty\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Property|Color} [options.color=Color.WHITE] A Property specifying the {@link Color} of the line.\n * @param {Property|Color} [options.outlineColor=Color.BLACK] A Property specifying the {@link Color} of the outline.\n * @param {Property|Number} [options.outlineWidth=1.0] A numeric Property specifying the width of the outline, in pixels.\n */\nfunction PolylineOutlineMaterialProperty(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  this._definitionChanged = new Event();\n  this._color = undefined;\n  this._colorSubscription = undefined;\n  this._outlineColor = undefined;\n  this._outlineColorSubscription = undefined;\n  this._outlineWidth = undefined;\n  this._outlineWidthSubscription = undefined;\n\n  this.color = options.color;\n  this.outlineColor = options.outlineColor;\n  this.outlineWidth = options.outlineWidth;\n}\n\nObject.defineProperties(PolylineOutlineMaterialProperty.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.  A property is considered\n   * constant if getValue always returns the same result for the current definition.\n   * @memberof PolylineOutlineMaterialProperty.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      return (\n        Property.isConstant(this._color) &&\n        Property.isConstant(this._outlineColor) &&\n        Property.isConstant(this._outlineWidth)\n      );\n    },\n  },\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * The definition is considered to have changed if a call to getValue would return\n   * a different result for the same time.\n   * @memberof PolylineOutlineMaterialProperty.prototype\n   *\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n  /**\n   * Gets or sets the Property specifying the {@link Color} of the line.\n   * @memberof PolylineOutlineMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default Color.WHITE\n   */\n  color: createPropertyDescriptor(\"color\"),\n\n  /**\n   * Gets or sets the Property specifying the {@link Color} of the outline.\n   * @memberof PolylineOutlineMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default Color.BLACK\n   */\n  outlineColor: createPropertyDescriptor(\"outlineColor\"),\n\n  /**\n   * Gets or sets the numeric Property specifying the width of the outline.\n   * @memberof PolylineOutlineMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default 1.0\n   */\n  outlineWidth: createPropertyDescriptor(\"outlineWidth\"),\n});\n\n/**\n * Gets the {@link Material} type at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the type.\n * @returns {String} The type of material.\n */\nPolylineOutlineMaterialProperty.prototype.getType = function (time) {\n  return \"PolylineOutline\";\n};\n\n/**\n * Gets the value of the property at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nPolylineOutlineMaterialProperty.prototype.getValue = function (time, result) {\n  if (!defined(result)) {\n    result = {};\n  }\n  result.color = Property.getValueOrClonedDefault(\n    this._color,\n    time,\n    defaultColor,\n    result.color\n  );\n  result.outlineColor = Property.getValueOrClonedDefault(\n    this._outlineColor,\n    time,\n    defaultOutlineColor,\n    result.outlineColor\n  );\n  result.outlineWidth = Property.getValueOrDefault(\n    this._outlineWidth,\n    time,\n    defaultOutlineWidth\n  );\n  return result;\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nPolylineOutlineMaterialProperty.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof PolylineOutlineMaterialProperty && //\n      Property.equals(this._color, other._color) && //\n      Property.equals(this._outlineColor, other._outlineColor) && //\n      Property.equals(this._outlineWidth, other._outlineWidth))\n  );\n};\nexport default PolylineOutlineMaterialProperty;\n","import defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Event from \"../Core/Event.js\";\nimport EventHelper from \"../Core/EventHelper.js\";\nimport Property from \"./Property.js\";\n\n/**\n * A {@link Property} whose value is an array whose items are the computed value\n * of other property instances.\n *\n * @alias PropertyArray\n * @constructor\n *\n * @param {Property[]} [value] An array of Property instances.\n */\nfunction PropertyArray(value) {\n  this._value = undefined;\n  this._definitionChanged = new Event();\n  this._eventHelper = new EventHelper();\n  this.setValue(value);\n}\n\nObject.defineProperties(PropertyArray.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.  This property\n   * is considered constant if all property items in the array are constant.\n   * @memberof PropertyArray.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      var value = this._value;\n      if (!defined(value)) {\n        return true;\n      }\n      var length = value.length;\n      for (var i = 0; i < length; i++) {\n        if (!Property.isConstant(value[i])) {\n          return false;\n        }\n      }\n      return true;\n    },\n  },\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * The definition is changed whenever setValue is called with data different\n   * than the current value or one of the properties in the array also changes.\n   * @memberof PropertyArray.prototype\n   *\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n});\n\n/**\n * Gets the value of the property.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {Object[]} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Object[]} The modified result parameter, which is an array of values produced by evaluating each of the contained properties at the given time or a new instance if the result parameter was not supplied.\n */\nPropertyArray.prototype.getValue = function (time, result) {\n  \n\n  var value = this._value;\n  if (!defined(value)) {\n    return undefined;\n  }\n\n  var length = value.length;\n  if (!defined(result)) {\n    result = new Array(length);\n  }\n  var i = 0;\n  var x = 0;\n  while (i < length) {\n    var property = this._value[i];\n    var itemValue = property.getValue(time, result[i]);\n    if (defined(itemValue)) {\n      result[x] = itemValue;\n      x++;\n    }\n    i++;\n  }\n  result.length = x;\n  return result;\n};\n\n/**\n * Sets the value of the property.\n *\n * @param {Property[]} value An array of Property instances.\n */\nPropertyArray.prototype.setValue = function (value) {\n  var eventHelper = this._eventHelper;\n  eventHelper.removeAll();\n\n  if (defined(value)) {\n    this._value = value.slice();\n    var length = value.length;\n    for (var i = 0; i < length; i++) {\n      var property = value[i];\n      if (defined(property)) {\n        eventHelper.add(\n          property.definitionChanged,\n          PropertyArray.prototype._raiseDefinitionChanged,\n          this\n        );\n      }\n    }\n  } else {\n    this._value = undefined;\n  }\n  this._definitionChanged.raiseEvent(this);\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nPropertyArray.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof PropertyArray && //\n      Property.arrayEquals(this._value, other._value))\n  );\n};\n\nPropertyArray.prototype._raiseDefinitionChanged = function () {\n  this._definitionChanged.raiseEvent(this);\n};\nexport default PropertyArray;\n","import defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport CesiumMath from \"../Core/Math.js\";\n\n/**\n * Represents a {@link Packable} number that always interpolates values\n * towards the shortest angle of rotation. This object is never used directly\n * but is instead passed to the constructor of {@link SampledProperty}\n * in order to represent a two-dimensional angle of rotation.\n *\n * @interface Rotation\n *\n *\n * @example\n * var time1 = Cesium.JulianDate.fromIso8601('2010-05-07T00:00:00');\n * var time2 = Cesium.JulianDate.fromIso8601('2010-05-07T00:01:00');\n * var time3 = Cesium.JulianDate.fromIso8601('2010-05-07T00:02:00');\n *\n * var property = new Cesium.SampledProperty(Cesium.Rotation);\n * property.addSample(time1, 0);\n * property.addSample(time3, Cesium.Math.toRadians(350));\n *\n * //Getting the value at time2 will equal 355 degrees instead\n * //of 175 degrees (which is what you get if you construct\n * //a SampledProperty(Number) instead.  Note, the actual\n * //return value is in radians, not degrees.\n * property.getValue(time2);\n *\n * @see PackableForInterpolation\n */\nvar Rotation = {\n  /**\n   * The number of elements used to pack the object into an array.\n   * @type {Number}\n   */\n  packedLength: 1,\n\n  /**\n   * Stores the provided instance into the provided array.\n   *\n   * @param {Rotation} value The value to pack.\n   * @param {Number[]} array The array to pack into.\n   * @param {Number} [startingIndex=0] The index into the array at which to start packing the elements.\n   *\n   * @returns {Number[]} The array that was packed into\n   */\n  pack: function (value, array, startingIndex) {\n    \n\n    startingIndex = defaultValue(startingIndex, 0);\n    array[startingIndex] = value;\n\n    return array;\n  },\n\n  /**\n   * Retrieves an instance from a packed array.\n   *\n   * @param {Number[]} array The packed array.\n   * @param {Number} [startingIndex=0] The starting index of the element to be unpacked.\n   * @param {Rotation} [result] The object into which to store the result.\n   * @returns {Rotation} The modified result parameter or a new Rotation instance if one was not provided.\n   */\n  unpack: function (array, startingIndex, result) {\n    \n\n    startingIndex = defaultValue(startingIndex, 0);\n    return array[startingIndex];\n  },\n\n  /**\n   * Converts a packed array into a form suitable for interpolation.\n   *\n   * @param {Number[]} packedArray The packed array.\n   * @param {Number} [startingIndex=0] The index of the first element to be converted.\n   * @param {Number} [lastIndex=packedArray.length] The index of the last element to be converted.\n   * @param {Number[]} [result] The object into which to store the result.\n   */\n  convertPackedArrayForInterpolation: function (\n    packedArray,\n    startingIndex,\n    lastIndex,\n    result\n  ) {\n    \n\n    if (!defined(result)) {\n      result = [];\n    }\n\n    startingIndex = defaultValue(startingIndex, 0);\n    lastIndex = defaultValue(lastIndex, packedArray.length);\n\n    var previousValue;\n    for (var i = 0, len = lastIndex - startingIndex + 1; i < len; i++) {\n      var value = packedArray[startingIndex + i];\n      if (i === 0 || Math.abs(previousValue - value) < Math.PI) {\n        result[i] = value;\n      } else {\n        result[i] = value - CesiumMath.TWO_PI;\n      }\n      previousValue = value;\n    }\n  },\n\n  /**\n   * Retrieves an instance from a packed array converted with {@link Rotation.convertPackedArrayForInterpolation}.\n   *\n   * @param {Number[]} array The array previously packed for interpolation.\n   * @param {Number[]} sourceArray The original packed array.\n   * @param {Number} [firstIndex=0] The firstIndex used to convert the array.\n   * @param {Number} [lastIndex=packedArray.length] The lastIndex used to convert the array.\n   * @param {Rotation} [result] The object into which to store the result.\n   * @returns {Rotation} The modified result parameter or a new Rotation instance if one was not provided.\n   */\n  unpackInterpolationResult: function (\n    array,\n    sourceArray,\n    firstIndex,\n    lastIndex,\n    result\n  ) {\n    \n\n    result = array[0];\n    if (result < 0) {\n      return result + CesiumMath.TWO_PI;\n    }\n    return result;\n  },\n};\nexport default Rotation;\n","/**\n * Defined the orientation of stripes in {@link StripeMaterialProperty}.\n *\n * @enum {Number}\n */\nvar StripeOrientation = {\n  /**\n   * Horizontal orientation.\n   * @type {Number}\n   */\n  HORIZONTAL: 0,\n\n  /**\n   * Vertical orientation.\n   * @type {Number}\n   */\n  VERTICAL: 1,\n};\nexport default Object.freeze(StripeOrientation);\n","import Color from \"../Core/Color.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport Event from \"../Core/Event.js\";\nimport createPropertyDescriptor from \"./createPropertyDescriptor.js\";\nimport Property from \"./Property.js\";\nimport StripeOrientation from \"./StripeOrientation.js\";\n\nvar defaultOrientation = StripeOrientation.HORIZONTAL;\nvar defaultEvenColor = Color.WHITE;\nvar defaultOddColor = Color.BLACK;\nvar defaultOffset = 0;\nvar defaultRepeat = 1;\n\n/**\n * A {@link MaterialProperty} that maps to stripe {@link Material} uniforms.\n * @alias StripeMaterialProperty\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Property|StripeOrientation} [options.orientation=StripeOrientation.HORIZONTAL] A Property specifying the {@link StripeOrientation}.\n * @param {Property|Color} [options.evenColor=Color.WHITE] A Property specifying the first {@link Color}.\n * @param {Property|Color} [options.oddColor=Color.BLACK] A Property specifying the second {@link Color}.\n * @param {Property|Number} [options.offset=0] A numeric Property specifying how far into the pattern to start the material.\n * @param {Property|Number} [options.repeat=1] A numeric Property specifying how many times the stripes repeat.\n */\nfunction StripeMaterialProperty(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  this._definitionChanged = new Event();\n  this._orientation = undefined;\n  this._orientationSubscription = undefined;\n  this._evenColor = undefined;\n  this._evenColorSubscription = undefined;\n  this._oddColor = undefined;\n  this._oddColorSubscription = undefined;\n  this._offset = undefined;\n  this._offsetSubscription = undefined;\n  this._repeat = undefined;\n  this._repeatSubscription = undefined;\n\n  this.orientation = options.orientation;\n  this.evenColor = options.evenColor;\n  this.oddColor = options.oddColor;\n  this.offset = options.offset;\n  this.repeat = options.repeat;\n}\n\nObject.defineProperties(StripeMaterialProperty.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.  A property is considered\n   * constant if getValue always returns the same result for the current definition.\n   * @memberof StripeMaterialProperty.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      return (\n        Property.isConstant(this._orientation) && //\n        Property.isConstant(this._evenColor) && //\n        Property.isConstant(this._oddColor) && //\n        Property.isConstant(this._offset) && //\n        Property.isConstant(this._repeat)\n      );\n    },\n  },\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * The definition is considered to have changed if a call to getValue would return\n   * a different result for the same time.\n   * @memberof StripeMaterialProperty.prototype\n   *\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n\n  /**\n   * Gets or sets the Property specifying the {@link StripeOrientation}/\n   * @memberof StripeMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default StripeOrientation.HORIZONTAL\n   */\n  orientation: createPropertyDescriptor(\"orientation\"),\n\n  /**\n   * Gets or sets the Property specifying the first {@link Color}.\n   * @memberof StripeMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default Color.WHITE\n   */\n  evenColor: createPropertyDescriptor(\"evenColor\"),\n\n  /**\n   * Gets or sets the Property specifying the second {@link Color}.\n   * @memberof StripeMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default Color.BLACK\n   */\n  oddColor: createPropertyDescriptor(\"oddColor\"),\n\n  /**\n   * Gets or sets the numeric Property specifying the point into the pattern\n   * to begin drawing; with 0.0 being the beginning of the even color, 1.0 the beginning\n   * of the odd color, 2.0 being the even color again, and any multiple or fractional values\n   * being in between.\n   * @memberof StripeMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default 0.0\n   */\n  offset: createPropertyDescriptor(\"offset\"),\n\n  /**\n   * Gets or sets the numeric Property specifying how many times the stripes repeat.\n   * @memberof StripeMaterialProperty.prototype\n   * @type {Property|undefined}\n   * @default 1.0\n   */\n  repeat: createPropertyDescriptor(\"repeat\"),\n});\n\n/**\n * Gets the {@link Material} type at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the type.\n * @returns {String} The type of material.\n */\nStripeMaterialProperty.prototype.getType = function (time) {\n  return \"Stripe\";\n};\n\n/**\n * Gets the value of the property at the provided time.\n *\n * @param {JulianDate} time The time for which to retrieve the value.\n * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nStripeMaterialProperty.prototype.getValue = function (time, result) {\n  if (!defined(result)) {\n    result = {};\n  }\n  result.horizontal =\n    Property.getValueOrDefault(this._orientation, time, defaultOrientation) ===\n    StripeOrientation.HORIZONTAL;\n  result.evenColor = Property.getValueOrClonedDefault(\n    this._evenColor,\n    time,\n    defaultEvenColor,\n    result.evenColor\n  );\n  result.oddColor = Property.getValueOrClonedDefault(\n    this._oddColor,\n    time,\n    defaultOddColor,\n    result.oddColor\n  );\n  result.offset = Property.getValueOrDefault(this._offset, time, defaultOffset);\n  result.repeat = Property.getValueOrDefault(this._repeat, time, defaultRepeat);\n  return result;\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nStripeMaterialProperty.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof StripeMaterialProperty && //\n      Property.equals(this._orientation, other._orientation) && //\n      Property.equals(this._evenColor, other._evenColor) && //\n      Property.equals(this._oddColor, other._oddColor) && //\n      Property.equals(this._offset, other._offset) && //\n      Property.equals(this._repeat, other._repeat))\n  );\n};\nexport default StripeMaterialProperty;\n","import Cartesian3 from \"../Core/Cartesian3.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Event from \"../Core/Event.js\";\nimport JulianDate from \"../Core/JulianDate.js\";\nimport Property from \"./Property.js\";\n\n/**\n * A {@link Property} which evaluates to a {@link Cartesian3} vector\n * based on the velocity of the provided {@link PositionProperty}.\n *\n * @alias VelocityVectorProperty\n * @constructor\n *\n * @param {PositionProperty} [position] The position property used to compute the velocity.\n * @param {Boolean} [normalize=true] Whether to normalize the computed velocity vector.\n *\n * @example\n * //Create an entity with a billboard rotated to match its velocity.\n * var position = new Cesium.SampledProperty();\n * position.addSamples(...);\n * var entity = viewer.entities.add({\n *   position : position,\n *   billboard : {\n *     image : 'image.png',\n *     alignedAxis : new Cesium.VelocityVectorProperty(position, true) // alignedAxis must be a unit vector\n *   }\n * }));\n */\nfunction VelocityVectorProperty(position, normalize) {\n  this._position = undefined;\n  this._subscription = undefined;\n  this._definitionChanged = new Event();\n  this._normalize = defaultValue(normalize, true);\n\n  this.position = position;\n}\n\nObject.defineProperties(VelocityVectorProperty.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.\n   * @memberof VelocityVectorProperty.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      return Property.isConstant(this._position);\n    },\n  },\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * @memberof VelocityVectorProperty.prototype\n   *\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n  /**\n   * Gets or sets the position property used to compute the velocity vector.\n   * @memberof VelocityVectorProperty.prototype\n   *\n   * @type {Property|undefined}\n   */\n  position: {\n    get: function () {\n      return this._position;\n    },\n    set: function (value) {\n      var oldValue = this._position;\n      if (oldValue !== value) {\n        if (defined(oldValue)) {\n          this._subscription();\n        }\n\n        this._position = value;\n\n        if (defined(value)) {\n          this._subscription = value._definitionChanged.addEventListener(\n            function () {\n              this._definitionChanged.raiseEvent(this);\n            },\n            this\n          );\n        }\n\n        this._definitionChanged.raiseEvent(this);\n      }\n    },\n  },\n  /**\n   * Gets or sets whether the vector produced by this property\n   * will be normalized or not.\n   * @memberof VelocityVectorProperty.prototype\n   *\n   * @type {Boolean}\n   */\n  normalize: {\n    get: function () {\n      return this._normalize;\n    },\n    set: function (value) {\n      if (this._normalize === value) {\n        return;\n      }\n\n      this._normalize = value;\n      this._definitionChanged.raiseEvent(this);\n    },\n  },\n});\n\nvar position1Scratch = new Cartesian3();\nvar position2Scratch = new Cartesian3();\nvar timeScratch = new JulianDate();\nvar step = 1.0 / 60.0;\n\n/**\n * Gets the value of the property at the provided time.\n *\n * @param {JulianDate} [time] The time for which to retrieve the value.\n * @param {Cartesian3} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Cartesian3} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nVelocityVectorProperty.prototype.getValue = function (time, result) {\n  return this._getValue(time, result);\n};\n\n/**\n * @private\n */\nVelocityVectorProperty.prototype._getValue = function (\n  time,\n  velocityResult,\n  positionResult\n) {\n  \n\n  if (!defined(velocityResult)) {\n    velocityResult = new Cartesian3();\n  }\n\n  var property = this._position;\n  if (Property.isConstant(property)) {\n    return this._normalize\n      ? undefined\n      : Cartesian3.clone(Cartesian3.ZERO, velocityResult);\n  }\n\n  var position1 = property.getValue(time, position1Scratch);\n  var position2 = property.getValue(\n    JulianDate.addSeconds(time, step, timeScratch),\n    position2Scratch\n  );\n\n  //If we don't have a position for now, return undefined.\n  if (!defined(position1)) {\n    return undefined;\n  }\n\n  //If we don't have a position for now + step, see if we have a position for now - step.\n  if (!defined(position2)) {\n    position2 = position1;\n    position1 = property.getValue(\n      JulianDate.addSeconds(time, -step, timeScratch),\n      position2Scratch\n    );\n\n    if (!defined(position1)) {\n      return undefined;\n    }\n  }\n\n  if (Cartesian3.equals(position1, position2)) {\n    return this._normalize\n      ? undefined\n      : Cartesian3.clone(Cartesian3.ZERO, velocityResult);\n  }\n\n  if (defined(positionResult)) {\n    position1.clone(positionResult);\n  }\n\n  var velocity = Cartesian3.subtract(position2, position1, velocityResult);\n  if (this._normalize) {\n    return Cartesian3.normalize(velocity, velocityResult);\n  }\n\n  return Cartesian3.divideByScalar(velocity, step, velocityResult);\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nVelocityVectorProperty.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof VelocityVectorProperty &&\n      Property.equals(this._position, other._position))\n  );\n};\nexport default VelocityVectorProperty;\n","import Cartesian3 from \"../Core/Cartesian3.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport Ellipsoid from \"../Core/Ellipsoid.js\";\nimport Event from \"../Core/Event.js\";\nimport Matrix3 from \"../Core/Matrix3.js\";\nimport Quaternion from \"../Core/Quaternion.js\";\nimport Transforms from \"../Core/Transforms.js\";\nimport Property from \"./Property.js\";\nimport VelocityVectorProperty from \"./VelocityVectorProperty.js\";\n\n/**\n * A {@link Property} which evaluates to a {@link Quaternion} rotation\n * based on the velocity of the provided {@link PositionProperty}.\n *\n * @alias VelocityOrientationProperty\n * @constructor\n *\n * @param {PositionProperty} [position] The position property used to compute the orientation.\n * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid used to determine which way is up.\n *\n * @example\n * //Create an entity with position and orientation.\n * var position = new Cesium.SampledProperty();\n * position.addSamples(...);\n * var entity = viewer.entities.add({\n *   position : position,\n *   orientation : new Cesium.VelocityOrientationProperty(position)\n * }));\n */\nfunction VelocityOrientationProperty(position, ellipsoid) {\n  this._velocityVectorProperty = new VelocityVectorProperty(position, true);\n  this._subscription = undefined;\n  this._ellipsoid = undefined;\n  this._definitionChanged = new Event();\n\n  this.ellipsoid = defaultValue(ellipsoid, Ellipsoid.WGS84);\n\n  var that = this;\n  this._velocityVectorProperty.definitionChanged.addEventListener(function () {\n    that._definitionChanged.raiseEvent(that);\n  });\n}\n\nObject.defineProperties(VelocityOrientationProperty.prototype, {\n  /**\n   * Gets a value indicating if this property is constant.\n   * @memberof VelocityOrientationProperty.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  isConstant: {\n    get: function () {\n      return Property.isConstant(this._velocityVectorProperty);\n    },\n  },\n  /**\n   * Gets the event that is raised whenever the definition of this property changes.\n   * @memberof VelocityOrientationProperty.prototype\n   *\n   * @type {Event}\n   * @readonly\n   */\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n  /**\n   * Gets or sets the position property used to compute orientation.\n   * @memberof VelocityOrientationProperty.prototype\n   *\n   * @type {Property|undefined}\n   */\n  position: {\n    get: function () {\n      return this._velocityVectorProperty.position;\n    },\n    set: function (value) {\n      this._velocityVectorProperty.position = value;\n    },\n  },\n  /**\n   * Gets or sets the ellipsoid used to determine which way is up.\n   * @memberof VelocityOrientationProperty.prototype\n   *\n   * @type {Property|undefined}\n   */\n  ellipsoid: {\n    get: function () {\n      return this._ellipsoid;\n    },\n    set: function (value) {\n      var oldValue = this._ellipsoid;\n      if (oldValue !== value) {\n        this._ellipsoid = value;\n        this._definitionChanged.raiseEvent(this);\n      }\n    },\n  },\n});\n\nvar positionScratch = new Cartesian3();\nvar velocityScratch = new Cartesian3();\nvar rotationScratch = new Matrix3();\n\n/**\n * Gets the value of the property at the provided time.\n *\n * @param {JulianDate} [time] The time for which to retrieve the value.\n * @param {Quaternion} [result] The object to store the value into, if omitted, a new instance is created and returned.\n * @returns {Quaternion} The modified result parameter or a new instance if the result parameter was not supplied.\n */\nVelocityOrientationProperty.prototype.getValue = function (time, result) {\n  var velocity = this._velocityVectorProperty._getValue(\n    time,\n    velocityScratch,\n    positionScratch\n  );\n\n  if (!defined(velocity)) {\n    return undefined;\n  }\n\n  Transforms.rotationMatrixFromPositionVelocity(\n    positionScratch,\n    velocity,\n    this._ellipsoid,\n    rotationScratch\n  );\n  return Quaternion.fromRotationMatrix(rotationScratch, result);\n};\n\n/**\n * Compares this property to the provided property and returns\n * <code>true</code> if they are equal, <code>false</code> otherwise.\n *\n * @param {Property} [other] The other property.\n * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n */\nVelocityOrientationProperty.prototype.equals = function (other) {\n  return (\n    this === other || //\n    (other instanceof VelocityOrientationProperty &&\n      Property.equals(\n        this._velocityVectorProperty,\n        other._velocityVectorProperty\n      ) &&\n      (this._ellipsoid === other._ellipsoid ||\n        this._ellipsoid.equals(other._ellipsoid)))\n  );\n};\nexport default VelocityOrientationProperty;\n","import ArcType from \"../Core/ArcType.js\";\nimport BoundingRectangle from \"../Core/BoundingRectangle.js\";\nimport Cartesian2 from \"../Core/Cartesian2.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Cartographic from \"../Core/Cartographic.js\";\nimport ClockRange from \"../Core/ClockRange.js\";\nimport ClockStep from \"../Core/ClockStep.js\";\nimport Color from \"../Core/Color.js\";\nimport CornerType from \"../Core/CornerType.js\";\nimport Credit from \"../Core/Credit.js\";\nimport createGuid from \"../Core/createGuid.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport DistanceDisplayCondition from \"../Core/DistanceDisplayCondition.js\";\nimport Ellipsoid from \"../Core/Ellipsoid.js\";\nimport Event from \"../Core/Event.js\";\nimport ExtrapolationType from \"../Core/ExtrapolationType.js\";\nimport getFilenameFromUri from \"../Core/getFilenameFromUri.js\";\nimport HermitePolynomialApproximation from \"../Core/HermitePolynomialApproximation.js\";\nimport Iso8601 from \"../Core/Iso8601.js\";\nimport JulianDate from \"../Core/JulianDate.js\";\nimport LagrangePolynomialApproximation from \"../Core/LagrangePolynomialApproximation.js\";\nimport LinearApproximation from \"../Core/LinearApproximation.js\";\nimport CesiumMath from \"../Core/Math.js\";\nimport NearFarScalar from \"../Core/NearFarScalar.js\";\nimport PolygonHierarchy from \"../Core/PolygonHierarchy.js\";\nimport Quaternion from \"../Core/Quaternion.js\";\nimport Rectangle from \"../Core/Rectangle.js\";\nimport ReferenceFrame from \"../Core/ReferenceFrame.js\";\nimport Resource from \"../Core/Resource.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport Spherical from \"../Core/Spherical.js\";\nimport TimeInterval from \"../Core/TimeInterval.js\";\nimport TimeIntervalCollection from \"../Core/TimeIntervalCollection.js\";\nimport ClassificationType from \"../Scene/ClassificationType.js\";\nimport ColorBlendMode from \"../Scene/ColorBlendMode.js\";\nimport HeightReference from \"../Scene/HeightReference.js\";\nimport HorizontalOrigin from \"../Scene/HorizontalOrigin.js\";\nimport LabelStyle from \"../Scene/LabelStyle.js\";\nimport ShadowMode from \"../Scene/ShadowMode.js\";\nimport VerticalOrigin from \"../Scene/VerticalOrigin.js\";\nimport Uri from \"../ThirdParty/Uri.js\";\nimport when from \"../ThirdParty/when.js\";\nimport BillboardGraphics from \"./BillboardGraphics.js\";\nimport BoxGraphics from \"./BoxGraphics.js\";\nimport CallbackProperty from \"./CallbackProperty.js\";\nimport CheckerboardMaterialProperty from \"./CheckerboardMaterialProperty.js\";\nimport ColorMaterialProperty from \"./ColorMaterialProperty.js\";\nimport CompositeMaterialProperty from \"./CompositeMaterialProperty.js\";\nimport CompositePositionProperty from \"./CompositePositionProperty.js\";\nimport CompositeProperty from \"./CompositeProperty.js\";\nimport ConstantPositionProperty from \"./ConstantPositionProperty.js\";\nimport ConstantProperty from \"./ConstantProperty.js\";\nimport CorridorGraphics from \"./CorridorGraphics.js\";\nimport CylinderGraphics from \"./CylinderGraphics.js\";\nimport DataSource from \"./DataSource.js\";\nimport DataSourceClock from \"./DataSourceClock.js\";\nimport EllipseGraphics from \"./EllipseGraphics.js\";\nimport EllipsoidGraphics from \"./EllipsoidGraphics.js\";\nimport EntityCluster from \"./EntityCluster.js\";\nimport EntityCollection from \"./EntityCollection.js\";\nimport GridMaterialProperty from \"./GridMaterialProperty.js\";\nimport ImageMaterialProperty from \"./ImageMaterialProperty.js\";\nimport LabelGraphics from \"./LabelGraphics.js\";\nimport ModelGraphics from \"./ModelGraphics.js\";\nimport NodeTransformationProperty from \"./NodeTransformationProperty.js\";\nimport PathGraphics from \"./PathGraphics.js\";\nimport PointGraphics from \"./PointGraphics.js\";\nimport PolygonGraphics from \"./PolygonGraphics.js\";\nimport PolylineArrowMaterialProperty from \"./PolylineArrowMaterialProperty.js\";\nimport PolylineDashMaterialProperty from \"./PolylineDashMaterialProperty.js\";\nimport PolylineGlowMaterialProperty from \"./PolylineGlowMaterialProperty.js\";\nimport PolylineGraphics from \"./PolylineGraphics.js\";\nimport PolylineOutlineMaterialProperty from \"./PolylineOutlineMaterialProperty.js\";\nimport PolylineVolumeGraphics from \"./PolylineVolumeGraphics.js\";\nimport PositionPropertyArray from \"./PositionPropertyArray.js\";\nimport Property from \"./Property.js\";\nimport PropertyArray from \"./PropertyArray.js\";\nimport PropertyBag from \"./PropertyBag.js\";\nimport RectangleGraphics from \"./RectangleGraphics.js\";\nimport ReferenceProperty from \"./ReferenceProperty.js\";\nimport Rotation from \"./Rotation.js\";\nimport SampledPositionProperty from \"./SampledPositionProperty.js\";\nimport SampledProperty from \"./SampledProperty.js\";\nimport StripeMaterialProperty from \"./StripeMaterialProperty.js\";\nimport StripeOrientation from \"./StripeOrientation.js\";\nimport TimeIntervalCollectionPositionProperty from \"./TimeIntervalCollectionPositionProperty.js\";\nimport TimeIntervalCollectionProperty from \"./TimeIntervalCollectionProperty.js\";\nimport VelocityOrientationProperty from \"./VelocityOrientationProperty.js\";\nimport VelocityVectorProperty from \"./VelocityVectorProperty.js\";\nimport WallGraphics from \"./WallGraphics.js\";\nimport Cesium3DTilesetGraphics from \"./Cesium3DTilesetGraphics.js\";\n\n// A marker type to distinguish CZML properties where we need to end up with a unit vector.\n// The data is still loaded into Cartesian3 objects but they are normalized.\nfunction UnitCartesian3() {}\nUnitCartesian3.packedLength = Cartesian3.packedLength;\nUnitCartesian3.unpack = Cartesian3.unpack;\nUnitCartesian3.pack = Cartesian3.pack;\n\n// As a side note, for the purposes of CZML, Quaternion always indicates a unit quaternion.\n\nvar currentId;\n\nfunction createReferenceProperty(entityCollection, referenceString) {\n  if (referenceString[0] === \"#\") {\n    referenceString = currentId + referenceString;\n  }\n  return ReferenceProperty.fromString(entityCollection, referenceString);\n}\n\nfunction createSpecializedProperty(type, entityCollection, packetData) {\n  if (defined(packetData.reference)) {\n    return createReferenceProperty(entityCollection, packetData.reference);\n  }\n\n  if (defined(packetData.velocityReference)) {\n    var referenceProperty = createReferenceProperty(\n      entityCollection,\n      packetData.velocityReference\n    );\n    switch (type) {\n      case Cartesian3:\n      case UnitCartesian3:\n        return new VelocityVectorProperty(\n          referenceProperty,\n          type === UnitCartesian3\n        );\n      case Quaternion:\n        return new VelocityOrientationProperty(referenceProperty);\n    }\n  }\n\n  throw new RuntimeError(JSON.stringify(packetData) + \" is not valid CZML.\");\n}\n\nfunction createAdapterProperty(property, adapterFunction) {\n  return new CallbackProperty(function (time, result) {\n    return adapterFunction(property.getValue(time, result));\n  }, property.isConstant);\n}\n\nvar scratchCartesian = new Cartesian3();\nvar scratchSpherical = new Spherical();\nvar scratchCartographic = new Cartographic();\nvar scratchTimeInterval = new TimeInterval();\nvar scratchQuaternion = new Quaternion();\n\nfunction unwrapColorInterval(czmlInterval) {\n  var rgbaf = czmlInterval.rgbaf;\n  if (defined(rgbaf)) {\n    return rgbaf;\n  }\n\n  var rgba = czmlInterval.rgba;\n  if (!defined(rgba)) {\n    return undefined;\n  }\n\n  var length = rgba.length;\n  if (length === Color.packedLength) {\n    return [\n      Color.byteToFloat(rgba[0]),\n      Color.byteToFloat(rgba[1]),\n      Color.byteToFloat(rgba[2]),\n      Color.byteToFloat(rgba[3]),\n    ];\n  }\n\n  rgbaf = new Array(length);\n  for (var i = 0; i < length; i += 5) {\n    rgbaf[i] = rgba[i];\n    rgbaf[i + 1] = Color.byteToFloat(rgba[i + 1]);\n    rgbaf[i + 2] = Color.byteToFloat(rgba[i + 2]);\n    rgbaf[i + 3] = Color.byteToFloat(rgba[i + 3]);\n    rgbaf[i + 4] = Color.byteToFloat(rgba[i + 4]);\n  }\n  return rgbaf;\n}\n\nfunction unwrapUriInterval(czmlInterval, sourceUri) {\n  var uri = defaultValue(czmlInterval.uri, czmlInterval);\n  if (defined(sourceUri)) {\n    return sourceUri.getDerivedResource({\n      url: uri,\n    });\n  }\n\n  return Resource.createIfNeeded(uri);\n}\n\nfunction unwrapRectangleInterval(czmlInterval) {\n  var wsen = czmlInterval.wsen;\n  if (defined(wsen)) {\n    return wsen;\n  }\n\n  var wsenDegrees = czmlInterval.wsenDegrees;\n  if (!defined(wsenDegrees)) {\n    return undefined;\n  }\n\n  var length = wsenDegrees.length;\n  if (length === Rectangle.packedLength) {\n    return [\n      CesiumMath.toRadians(wsenDegrees[0]),\n      CesiumMath.toRadians(wsenDegrees[1]),\n      CesiumMath.toRadians(wsenDegrees[2]),\n      CesiumMath.toRadians(wsenDegrees[3]),\n    ];\n  }\n\n  wsen = new Array(length);\n  for (var i = 0; i < length; i += 5) {\n    wsen[i] = wsenDegrees[i];\n    wsen[i + 1] = CesiumMath.toRadians(wsenDegrees[i + 1]);\n    wsen[i + 2] = CesiumMath.toRadians(wsenDegrees[i + 2]);\n    wsen[i + 3] = CesiumMath.toRadians(wsenDegrees[i + 3]);\n    wsen[i + 4] = CesiumMath.toRadians(wsenDegrees[i + 4]);\n  }\n  return wsen;\n}\n\nfunction convertUnitSphericalToCartesian(unitSpherical) {\n  var length = unitSpherical.length;\n  scratchSpherical.magnitude = 1.0;\n  if (length === 2) {\n    scratchSpherical.clock = unitSpherical[0];\n    scratchSpherical.cone = unitSpherical[1];\n    Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n    return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n  }\n\n  var result = new Array((length / 3) * 4);\n  for (var i = 0, j = 0; i < length; i += 3, j += 4) {\n    result[j] = unitSpherical[i];\n\n    scratchSpherical.clock = unitSpherical[i + 1];\n    scratchSpherical.cone = unitSpherical[i + 2];\n    Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n\n    result[j + 1] = scratchCartesian.x;\n    result[j + 2] = scratchCartesian.y;\n    result[j + 3] = scratchCartesian.z;\n  }\n  return result;\n}\n\nfunction convertSphericalToCartesian(spherical) {\n  var length = spherical.length;\n  if (length === 3) {\n    scratchSpherical.clock = spherical[0];\n    scratchSpherical.cone = spherical[1];\n    scratchSpherical.magnitude = spherical[2];\n    Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n    return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n  }\n\n  var result = new Array(length);\n  for (var i = 0; i < length; i += 4) {\n    result[i] = spherical[i];\n\n    scratchSpherical.clock = spherical[i + 1];\n    scratchSpherical.cone = spherical[i + 2];\n    scratchSpherical.magnitude = spherical[i + 3];\n    Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n\n    result[i + 1] = scratchCartesian.x;\n    result[i + 2] = scratchCartesian.y;\n    result[i + 3] = scratchCartesian.z;\n  }\n  return result;\n}\n\nfunction convertCartographicRadiansToCartesian(cartographicRadians) {\n  var length = cartographicRadians.length;\n  if (length === 3) {\n    scratchCartographic.longitude = cartographicRadians[0];\n    scratchCartographic.latitude = cartographicRadians[1];\n    scratchCartographic.height = cartographicRadians[2];\n    Ellipsoid.WGS84.cartographicToCartesian(\n      scratchCartographic,\n      scratchCartesian\n    );\n    return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n  }\n\n  var result = new Array(length);\n  for (var i = 0; i < length; i += 4) {\n    result[i] = cartographicRadians[i];\n\n    scratchCartographic.longitude = cartographicRadians[i + 1];\n    scratchCartographic.latitude = cartographicRadians[i + 2];\n    scratchCartographic.height = cartographicRadians[i + 3];\n    Ellipsoid.WGS84.cartographicToCartesian(\n      scratchCartographic,\n      scratchCartesian\n    );\n\n    result[i + 1] = scratchCartesian.x;\n    result[i + 2] = scratchCartesian.y;\n    result[i + 3] = scratchCartesian.z;\n  }\n  return result;\n}\n\nfunction convertCartographicDegreesToCartesian(cartographicDegrees) {\n  var length = cartographicDegrees.length;\n  if (length === 3) {\n    scratchCartographic.longitude = CesiumMath.toRadians(\n      cartographicDegrees[0]\n    );\n    scratchCartographic.latitude = CesiumMath.toRadians(cartographicDegrees[1]);\n    scratchCartographic.height = cartographicDegrees[2];\n    Ellipsoid.WGS84.cartographicToCartesian(\n      scratchCartographic,\n      scratchCartesian\n    );\n    return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n  }\n\n  var result = new Array(length);\n  for (var i = 0; i < length; i += 4) {\n    result[i] = cartographicDegrees[i];\n\n    scratchCartographic.longitude = CesiumMath.toRadians(\n      cartographicDegrees[i + 1]\n    );\n    scratchCartographic.latitude = CesiumMath.toRadians(\n      cartographicDegrees[i + 2]\n    );\n    scratchCartographic.height = cartographicDegrees[i + 3];\n    Ellipsoid.WGS84.cartographicToCartesian(\n      scratchCartographic,\n      scratchCartesian\n    );\n\n    result[i + 1] = scratchCartesian.x;\n    result[i + 2] = scratchCartesian.y;\n    result[i + 3] = scratchCartesian.z;\n  }\n  return result;\n}\n\nfunction unwrapCartesianInterval(czmlInterval) {\n  var cartesian = czmlInterval.cartesian;\n  if (defined(cartesian)) {\n    return cartesian;\n  }\n\n  var cartesianVelocity = czmlInterval.cartesianVelocity;\n  if (defined(cartesianVelocity)) {\n    return cartesianVelocity;\n  }\n\n  var unitCartesian = czmlInterval.unitCartesian;\n  if (defined(unitCartesian)) {\n    return unitCartesian;\n  }\n\n  var unitSpherical = czmlInterval.unitSpherical;\n  if (defined(unitSpherical)) {\n    return convertUnitSphericalToCartesian(unitSpherical);\n  }\n\n  var spherical = czmlInterval.spherical;\n  if (defined(spherical)) {\n    return convertSphericalToCartesian(spherical);\n  }\n\n  var cartographicRadians = czmlInterval.cartographicRadians;\n  if (defined(cartographicRadians)) {\n    return convertCartographicRadiansToCartesian(cartographicRadians);\n  }\n\n  var cartographicDegrees = czmlInterval.cartographicDegrees;\n  if (defined(cartographicDegrees)) {\n    return convertCartographicDegreesToCartesian(cartographicDegrees);\n  }\n\n  throw new RuntimeError(\n    JSON.stringify(czmlInterval) + \" is not a valid CZML interval.\"\n  );\n}\n\nfunction normalizePackedCartesianArray(array, startingIndex) {\n  Cartesian3.unpack(array, startingIndex, scratchCartesian);\n  Cartesian3.normalize(scratchCartesian, scratchCartesian);\n  Cartesian3.pack(scratchCartesian, array, startingIndex);\n}\n\nfunction unwrapUnitCartesianInterval(czmlInterval) {\n  var cartesian = unwrapCartesianInterval(czmlInterval);\n  if (cartesian.length === 3) {\n    normalizePackedCartesianArray(cartesian, 0);\n    return cartesian;\n  }\n\n  for (var i = 1; i < cartesian.length; i += 4) {\n    normalizePackedCartesianArray(cartesian, i);\n  }\n\n  return cartesian;\n}\n\nfunction normalizePackedQuaternionArray(array, startingIndex) {\n  Quaternion.unpack(array, startingIndex, scratchQuaternion);\n  Quaternion.normalize(scratchQuaternion, scratchQuaternion);\n  Quaternion.pack(scratchQuaternion, array, startingIndex);\n}\n\nfunction unwrapQuaternionInterval(czmlInterval) {\n  var unitQuaternion = czmlInterval.unitQuaternion;\n  if (defined(unitQuaternion)) {\n    if (unitQuaternion.length === 4) {\n      normalizePackedQuaternionArray(unitQuaternion, 0);\n      return unitQuaternion;\n    }\n\n    for (var i = 1; i < unitQuaternion.length; i += 5) {\n      normalizePackedQuaternionArray(unitQuaternion, i);\n    }\n  }\n  return unitQuaternion;\n}\n\nfunction getPropertyType(czmlInterval) {\n  // The associations in this function need to be kept in sync with the\n  // associations in unwrapInterval.\n\n  // Intentionally omitted due to conficts in CZML property names:\n  // * Image (conflicts with Uri)\n  // * Rotation (conflicts with Number)\n  //\n  // cartesianVelocity is also omitted due to incomplete support for\n  // derivative information in CZML properties.\n  // (Currently cartesianVelocity is hacked directly into the position processing code)\n  if (typeof czmlInterval === \"boolean\") {\n    return Boolean;\n  } else if (typeof czmlInterval === \"number\") {\n    return Number;\n  } else if (typeof czmlInterval === \"string\") {\n    return String;\n  } else if (czmlInterval.hasOwnProperty(\"array\")) {\n    return Array;\n  } else if (czmlInterval.hasOwnProperty(\"boolean\")) {\n    return Boolean;\n  } else if (czmlInterval.hasOwnProperty(\"boundingRectangle\")) {\n    return BoundingRectangle;\n  } else if (czmlInterval.hasOwnProperty(\"cartesian2\")) {\n    return Cartesian2;\n  } else if (\n    czmlInterval.hasOwnProperty(\"cartesian\") ||\n    czmlInterval.hasOwnProperty(\"spherical\") ||\n    czmlInterval.hasOwnProperty(\"cartographicRadians\") ||\n    czmlInterval.hasOwnProperty(\"cartographicDegrees\")\n  ) {\n    return Cartesian3;\n  } else if (\n    czmlInterval.hasOwnProperty(\"unitCartesian\") ||\n    czmlInterval.hasOwnProperty(\"unitSpherical\")\n  ) {\n    return UnitCartesian3;\n  } else if (\n    czmlInterval.hasOwnProperty(\"rgba\") ||\n    czmlInterval.hasOwnProperty(\"rgbaf\")\n  ) {\n    return Color;\n  } else if (czmlInterval.hasOwnProperty(\"arcType\")) {\n    return ArcType;\n  } else if (czmlInterval.hasOwnProperty(\"classificationType\")) {\n    return ClassificationType;\n  } else if (czmlInterval.hasOwnProperty(\"colorBlendMode\")) {\n    return ColorBlendMode;\n  } else if (czmlInterval.hasOwnProperty(\"cornerType\")) {\n    return CornerType;\n  } else if (czmlInterval.hasOwnProperty(\"heightReference\")) {\n    return HeightReference;\n  } else if (czmlInterval.hasOwnProperty(\"horizontalOrigin\")) {\n    return HorizontalOrigin;\n  } else if (czmlInterval.hasOwnProperty(\"date\")) {\n    return JulianDate;\n  } else if (czmlInterval.hasOwnProperty(\"labelStyle\")) {\n    return LabelStyle;\n  } else if (czmlInterval.hasOwnProperty(\"number\")) {\n    return Number;\n  } else if (czmlInterval.hasOwnProperty(\"nearFarScalar\")) {\n    return NearFarScalar;\n  } else if (czmlInterval.hasOwnProperty(\"distanceDisplayCondition\")) {\n    return DistanceDisplayCondition;\n  } else if (\n    czmlInterval.hasOwnProperty(\"object\") ||\n    czmlInterval.hasOwnProperty(\"value\")\n  ) {\n    return Object;\n  } else if (czmlInterval.hasOwnProperty(\"unitQuaternion\")) {\n    return Quaternion;\n  } else if (czmlInterval.hasOwnProperty(\"shadowMode\")) {\n    return ShadowMode;\n  } else if (czmlInterval.hasOwnProperty(\"string\")) {\n    return String;\n  } else if (czmlInterval.hasOwnProperty(\"stripeOrientation\")) {\n    return StripeOrientation;\n  } else if (\n    czmlInterval.hasOwnProperty(\"wsen\") ||\n    czmlInterval.hasOwnProperty(\"wsenDegrees\")\n  ) {\n    return Rectangle;\n  } else if (czmlInterval.hasOwnProperty(\"uri\")) {\n    return Uri;\n  } else if (czmlInterval.hasOwnProperty(\"verticalOrigin\")) {\n    return VerticalOrigin;\n  }\n  // fallback case\n  return Object;\n}\n\nfunction unwrapInterval(type, czmlInterval, sourceUri) {\n  // The associations in this function need to be kept in sync with the\n  // associations in getPropertyType\n  switch (type) {\n    case ArcType:\n      return ArcType[defaultValue(czmlInterval.arcType, czmlInterval)];\n    case Array:\n      return czmlInterval.array;\n    case Boolean:\n      return defaultValue(czmlInterval[\"boolean\"], czmlInterval);\n    case BoundingRectangle:\n      return czmlInterval.boundingRectangle;\n    case Cartesian2:\n      return czmlInterval.cartesian2;\n    case Cartesian3:\n      return unwrapCartesianInterval(czmlInterval);\n    case UnitCartesian3:\n      return unwrapUnitCartesianInterval(czmlInterval);\n    case Color:\n      return unwrapColorInterval(czmlInterval);\n    case ClassificationType:\n      return ClassificationType[\n        defaultValue(czmlInterval.classificationType, czmlInterval)\n      ];\n    case ColorBlendMode:\n      return ColorBlendMode[\n        defaultValue(czmlInterval.colorBlendMode, czmlInterval)\n      ];\n    case CornerType:\n      return CornerType[defaultValue(czmlInterval.cornerType, czmlInterval)];\n    case HeightReference:\n      return HeightReference[\n        defaultValue(czmlInterval.heightReference, czmlInterval)\n      ];\n    case HorizontalOrigin:\n      return HorizontalOrigin[\n        defaultValue(czmlInterval.horizontalOrigin, czmlInterval)\n      ];\n    case Image:\n      return unwrapUriInterval(czmlInterval, sourceUri);\n    case JulianDate:\n      return JulianDate.fromIso8601(\n        defaultValue(czmlInterval.date, czmlInterval)\n      );\n    case LabelStyle:\n      return LabelStyle[defaultValue(czmlInterval.labelStyle, czmlInterval)];\n    case Number:\n      return defaultValue(czmlInterval.number, czmlInterval);\n    case NearFarScalar:\n      return czmlInterval.nearFarScalar;\n    case DistanceDisplayCondition:\n      return czmlInterval.distanceDisplayCondition;\n    case Object:\n      return defaultValue(\n        defaultValue(czmlInterval.object, czmlInterval.value),\n        czmlInterval\n      );\n    case Quaternion:\n      return unwrapQuaternionInterval(czmlInterval);\n    case Rectangle:\n      return unwrapRectangleInterval(czmlInterval);\n    case Rotation:\n      return defaultValue(czmlInterval.number, czmlInterval);\n    case ShadowMode:\n      return ShadowMode[\n        defaultValue(\n          defaultValue(czmlInterval.shadowMode, czmlInterval.shadows),\n          czmlInterval\n        )\n      ];\n    case String:\n      return defaultValue(czmlInterval.string, czmlInterval);\n    case StripeOrientation:\n      return StripeOrientation[\n        defaultValue(czmlInterval.stripeOrientation, czmlInterval)\n      ];\n    case Uri:\n      return unwrapUriInterval(czmlInterval, sourceUri);\n    case VerticalOrigin:\n      return VerticalOrigin[\n        defaultValue(czmlInterval.verticalOrigin, czmlInterval)\n      ];\n    default:\n      throw new RuntimeError(type);\n  }\n}\n\nvar interpolators = {\n  HERMITE: HermitePolynomialApproximation,\n  LAGRANGE: LagrangePolynomialApproximation,\n  LINEAR: LinearApproximation,\n};\n\nfunction updateInterpolationSettings(packetData, property) {\n  var interpolationAlgorithm = packetData.interpolationAlgorithm;\n  var interpolationDegree = packetData.interpolationDegree;\n  if (defined(interpolationAlgorithm) || defined(interpolationDegree)) {\n    property.setInterpolationOptions({\n      interpolationAlgorithm: interpolators[interpolationAlgorithm],\n      interpolationDegree: interpolationDegree,\n    });\n  }\n\n  var forwardExtrapolationType = packetData.forwardExtrapolationType;\n  if (defined(forwardExtrapolationType)) {\n    property.forwardExtrapolationType =\n      ExtrapolationType[forwardExtrapolationType];\n  }\n\n  var forwardExtrapolationDuration = packetData.forwardExtrapolationDuration;\n  if (defined(forwardExtrapolationDuration)) {\n    property.forwardExtrapolationDuration = forwardExtrapolationDuration;\n  }\n\n  var backwardExtrapolationType = packetData.backwardExtrapolationType;\n  if (defined(backwardExtrapolationType)) {\n    property.backwardExtrapolationType =\n      ExtrapolationType[backwardExtrapolationType];\n  }\n\n  var backwardExtrapolationDuration = packetData.backwardExtrapolationDuration;\n  if (defined(backwardExtrapolationDuration)) {\n    property.backwardExtrapolationDuration = backwardExtrapolationDuration;\n  }\n}\n\nvar iso8601Scratch = {\n  iso8601: undefined,\n};\n\nfunction intervalFromString(intervalString) {\n  if (!defined(intervalString)) {\n    return undefined;\n  }\n  iso8601Scratch.iso8601 = intervalString;\n  return TimeInterval.fromIso8601(iso8601Scratch);\n}\n\nfunction wrapPropertyInInfiniteInterval(property) {\n  var interval = Iso8601.MAXIMUM_INTERVAL.clone();\n  interval.data = property;\n  return interval;\n}\n\nfunction convertPropertyToComposite(property) {\n  // Create the composite and add the old property, wrapped in an infinite interval.\n  var composite = new CompositeProperty();\n  composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n  return composite;\n}\n\nfunction convertPositionPropertyToComposite(property) {\n  // Create the composite and add the old property, wrapped in an infinite interval.\n  var composite = new CompositePositionProperty(property.referenceFrame);\n  composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n  return composite;\n}\n\nfunction processProperty(\n  type,\n  object,\n  propertyName,\n  packetData,\n  constrainedInterval,\n  sourceUri,\n  entityCollection\n) {\n  var combinedInterval = intervalFromString(packetData.interval);\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(\n        combinedInterval,\n        constrainedInterval,\n        scratchTimeInterval\n      );\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var packedLength;\n  var unwrappedInterval;\n  var unwrappedIntervalLength;\n\n  // CZML properties can be defined in many ways.  Most ways represent a structure for\n  // encoding a single value (number, string, cartesian, etc.)  Regardless of the value type,\n  // if it encodes a single value it will get loaded into a ConstantProperty eventually.\n  // Alternatively, there are ways of defining a property that require specialized\n  // client-side representation. Currently, these are ReferenceProperty,\n  // and client-side velocity computation properties such as VelocityVectorProperty.\n  var isValue =\n    !defined(packetData.reference) && !defined(packetData.velocityReference);\n  var hasInterval =\n    defined(combinedInterval) &&\n    !combinedInterval.equals(Iso8601.MAXIMUM_INTERVAL);\n\n  if (packetData.delete === true) {\n    // If deleting this property for all time, we can simply set to undefined and return.\n    if (!hasInterval) {\n      object[propertyName] = undefined;\n      return;\n    }\n\n    // Deleting depends on the type of property we have.\n    return removePropertyData(object[propertyName], combinedInterval);\n  }\n\n  var isSampled = false;\n\n  if (isValue) {\n    unwrappedInterval = unwrapInterval(type, packetData, sourceUri);\n    if (!defined(unwrappedInterval)) {\n      // not a known value type, bail\n      return;\n    }\n    packedLength = defaultValue(type.packedLength, 1);\n    unwrappedIntervalLength = defaultValue(unwrappedInterval.length, 1);\n    isSampled =\n      !defined(packetData.array) &&\n      typeof unwrappedInterval !== \"string\" &&\n      unwrappedIntervalLength > packedLength &&\n      type !== Object;\n  }\n\n  // Rotation is a special case because it represents a native type (Number)\n  // and therefore does not need to be unpacked when loaded as a constant value.\n  var needsUnpacking = typeof type.unpack === \"function\" && type !== Rotation;\n\n  // Any time a constant value is assigned, it completely blows away anything else.\n  if (!isSampled && !hasInterval) {\n    if (isValue) {\n      object[propertyName] = new ConstantProperty(\n        needsUnpacking ? type.unpack(unwrappedInterval, 0) : unwrappedInterval\n      );\n    } else {\n      object[propertyName] = createSpecializedProperty(\n        type,\n        entityCollection,\n        packetData\n      );\n    }\n    return;\n  }\n\n  var property = object[propertyName];\n\n  var epoch;\n  var packetEpoch = packetData.epoch;\n  if (defined(packetEpoch)) {\n    epoch = JulianDate.fromIso8601(packetEpoch);\n  }\n\n  // Without an interval, any sampled value is infinite, meaning it completely\n  // replaces any non-sampled property that may exist.\n  if (isSampled && !hasInterval) {\n    if (!(property instanceof SampledProperty)) {\n      object[propertyName] = property = new SampledProperty(type);\n    }\n    property.addSamplesPackedArray(unwrappedInterval, epoch);\n    updateInterpolationSettings(packetData, property);\n    return;\n  }\n\n  var interval;\n\n  // A constant value with an interval is normally part of a TimeIntervalCollection,\n  // However, if the current property is not a time-interval collection, we need\n  // to turn it into a Composite, preserving the old data with the new interval.\n  if (!isSampled && hasInterval) {\n    // Create a new interval for the constant value.\n    combinedInterval = combinedInterval.clone();\n    if (isValue) {\n      combinedInterval.data = needsUnpacking\n        ? type.unpack(unwrappedInterval, 0)\n        : unwrappedInterval;\n    } else {\n      combinedInterval.data = createSpecializedProperty(\n        type,\n        entityCollection,\n        packetData\n      );\n    }\n\n    // If no property exists, simply use a new interval collection\n    if (!defined(property)) {\n      object[propertyName] = property = isValue\n        ? new TimeIntervalCollectionProperty()\n        : new CompositeProperty();\n    }\n\n    if (isValue && property instanceof TimeIntervalCollectionProperty) {\n      // If we created a collection, or it already was one, use it.\n      property.intervals.addInterval(combinedInterval);\n    } else if (property instanceof CompositeProperty) {\n      // If the collection was already a CompositeProperty, use it.\n      if (isValue) {\n        combinedInterval.data = new ConstantProperty(combinedInterval.data);\n      }\n      property.intervals.addInterval(combinedInterval);\n    } else {\n      // Otherwise, create a CompositeProperty but preserve the existing data.\n      object[propertyName] = property = convertPropertyToComposite(property);\n\n      // Change the new data to a ConstantProperty and add it.\n      if (isValue) {\n        combinedInterval.data = new ConstantProperty(combinedInterval.data);\n      }\n      property.intervals.addInterval(combinedInterval);\n    }\n\n    return;\n  }\n\n  // isSampled && hasInterval\n  if (!defined(property)) {\n    object[propertyName] = property = new CompositeProperty();\n  }\n\n  // Create a CompositeProperty but preserve the existing data.\n  if (!(property instanceof CompositeProperty)) {\n    object[propertyName] = property = convertPropertyToComposite(property);\n  }\n\n  // Check if the interval already exists in the composite.\n  var intervals = property.intervals;\n  interval = intervals.findInterval(combinedInterval);\n  if (!defined(interval) || !(interval.data instanceof SampledProperty)) {\n    // If not, create a SampledProperty for it.\n    interval = combinedInterval.clone();\n    interval.data = new SampledProperty(type);\n    intervals.addInterval(interval);\n  }\n  interval.data.addSamplesPackedArray(unwrappedInterval, epoch);\n  updateInterpolationSettings(packetData, interval.data);\n}\n\nfunction removePropertyData(property, interval) {\n  if (property instanceof SampledProperty) {\n    property.removeSamples(interval);\n    return;\n  } else if (property instanceof TimeIntervalCollectionProperty) {\n    property.intervals.removeInterval(interval);\n    return;\n  } else if (property instanceof CompositeProperty) {\n    var intervals = property.intervals;\n    for (var i = 0; i < intervals.length; ++i) {\n      var intersection = TimeInterval.intersect(\n        intervals.get(i),\n        interval,\n        scratchTimeInterval\n      );\n      if (!intersection.isEmpty) {\n        // remove data from the contained properties\n        removePropertyData(intersection.data, interval);\n      }\n    }\n    // remove the intervals from the composite\n    intervals.removeInterval(interval);\n    return;\n  }\n}\n\nfunction processPacketData(\n  type,\n  object,\n  propertyName,\n  packetData,\n  interval,\n  sourceUri,\n  entityCollection\n) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, len = packetData.length; i < len; ++i) {\n      processProperty(\n        type,\n        object,\n        propertyName,\n        packetData[i],\n        interval,\n        sourceUri,\n        entityCollection\n      );\n    }\n  } else {\n    processProperty(\n      type,\n      object,\n      propertyName,\n      packetData,\n      interval,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processPositionProperty(\n  object,\n  propertyName,\n  packetData,\n  constrainedInterval,\n  sourceUri,\n  entityCollection\n) {\n  var combinedInterval = intervalFromString(packetData.interval);\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(\n        combinedInterval,\n        constrainedInterval,\n        scratchTimeInterval\n      );\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var numberOfDerivatives = defined(packetData.cartesianVelocity) ? 1 : 0;\n  var packedLength = Cartesian3.packedLength * (numberOfDerivatives + 1);\n  var unwrappedInterval;\n  var unwrappedIntervalLength;\n  var isValue = !defined(packetData.reference);\n  var hasInterval =\n    defined(combinedInterval) &&\n    !combinedInterval.equals(Iso8601.MAXIMUM_INTERVAL);\n\n  if (packetData.delete === true) {\n    // If deleting this property for all time, we can simply set to undefined and return.\n    if (!hasInterval) {\n      object[propertyName] = undefined;\n      return;\n    }\n\n    // Deleting depends on the type of property we have.\n    return removePositionPropertyData(object[propertyName], combinedInterval);\n  }\n\n  var referenceFrame;\n  var isSampled = false;\n\n  if (isValue) {\n    if (defined(packetData.referenceFrame)) {\n      referenceFrame = ReferenceFrame[packetData.referenceFrame];\n    }\n    referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n    unwrappedInterval = unwrapCartesianInterval(packetData);\n    unwrappedIntervalLength = defaultValue(unwrappedInterval.length, 1);\n    isSampled = unwrappedIntervalLength > packedLength;\n  }\n\n  // Any time a constant value is assigned, it completely blows away anything else.\n  if (!isSampled && !hasInterval) {\n    if (isValue) {\n      object[propertyName] = new ConstantPositionProperty(\n        Cartesian3.unpack(unwrappedInterval),\n        referenceFrame\n      );\n    } else {\n      object[propertyName] = createReferenceProperty(\n        entityCollection,\n        packetData.reference\n      );\n    }\n    return;\n  }\n\n  var property = object[propertyName];\n\n  var epoch;\n  var packetEpoch = packetData.epoch;\n  if (defined(packetEpoch)) {\n    epoch = JulianDate.fromIso8601(packetEpoch);\n  }\n\n  // Without an interval, any sampled value is infinite, meaning it completely\n  // replaces any non-sampled property that may exist.\n  if (isSampled && !hasInterval) {\n    if (\n      !(property instanceof SampledPositionProperty) ||\n      (defined(referenceFrame) && property.referenceFrame !== referenceFrame)\n    ) {\n      object[propertyName] = property = new SampledPositionProperty(\n        referenceFrame,\n        numberOfDerivatives\n      );\n    }\n    property.addSamplesPackedArray(unwrappedInterval, epoch);\n    updateInterpolationSettings(packetData, property);\n    return;\n  }\n\n  var interval;\n\n  // A constant value with an interval is normally part of a TimeIntervalCollection,\n  // However, if the current property is not a time-interval collection, we need\n  // to turn it into a Composite, preserving the old data with the new interval.\n  if (!isSampled && hasInterval) {\n    // Create a new interval for the constant value.\n    combinedInterval = combinedInterval.clone();\n    if (isValue) {\n      combinedInterval.data = Cartesian3.unpack(unwrappedInterval);\n    } else {\n      combinedInterval.data = createReferenceProperty(\n        entityCollection,\n        packetData.reference\n      );\n    }\n\n    // If no property exists, simply use a new interval collection\n    if (!defined(property)) {\n      if (isValue) {\n        property = new TimeIntervalCollectionPositionProperty(referenceFrame);\n      } else {\n        property = new CompositePositionProperty(referenceFrame);\n      }\n      object[propertyName] = property;\n    }\n\n    if (\n      isValue &&\n      property instanceof TimeIntervalCollectionPositionProperty &&\n      defined(referenceFrame) &&\n      property.referenceFrame === referenceFrame\n    ) {\n      // If we create a collection, or it already existed, use it.\n      property.intervals.addInterval(combinedInterval);\n    } else if (property instanceof CompositePositionProperty) {\n      // If the collection was already a CompositePositionProperty, use it.\n      if (isValue) {\n        combinedInterval.data = new ConstantPositionProperty(\n          combinedInterval.data,\n          referenceFrame\n        );\n      }\n      property.intervals.addInterval(combinedInterval);\n    } else {\n      // Otherwise, create a CompositePositionProperty but preserve the existing data.\n      object[propertyName] = property = convertPositionPropertyToComposite(\n        property\n      );\n\n      // Change the new data to a ConstantPositionProperty and add it.\n      if (isValue) {\n        combinedInterval.data = new ConstantPositionProperty(\n          combinedInterval.data,\n          referenceFrame\n        );\n      }\n      property.intervals.addInterval(combinedInterval);\n    }\n\n    return;\n  }\n\n  // isSampled && hasInterval\n  if (!defined(property)) {\n    object[propertyName] = property = new CompositePositionProperty(\n      referenceFrame\n    );\n  } else if (!(property instanceof CompositePositionProperty)) {\n    // Create a CompositeProperty but preserve the existing data.\n    object[propertyName] = property = convertPositionPropertyToComposite(\n      property\n    );\n  }\n\n  // Check if the interval already exists in the composite.\n  var intervals = property.intervals;\n  interval = intervals.findInterval(combinedInterval);\n  if (\n    !defined(interval) ||\n    !(interval.data instanceof SampledPositionProperty) ||\n    (defined(referenceFrame) && interval.data.referenceFrame !== referenceFrame)\n  ) {\n    // If not, create a SampledPositionProperty for it.\n    interval = combinedInterval.clone();\n    interval.data = new SampledPositionProperty(\n      referenceFrame,\n      numberOfDerivatives\n    );\n    intervals.addInterval(interval);\n  }\n  interval.data.addSamplesPackedArray(unwrappedInterval, epoch);\n  updateInterpolationSettings(packetData, interval.data);\n}\n\nfunction removePositionPropertyData(property, interval) {\n  if (property instanceof SampledPositionProperty) {\n    property.removeSamples(interval);\n    return;\n  } else if (property instanceof TimeIntervalCollectionPositionProperty) {\n    property.intervals.removeInterval(interval);\n    return;\n  } else if (property instanceof CompositePositionProperty) {\n    var intervals = property.intervals;\n    for (var i = 0; i < intervals.length; ++i) {\n      var intersection = TimeInterval.intersect(\n        intervals.get(i),\n        interval,\n        scratchTimeInterval\n      );\n      if (!intersection.isEmpty) {\n        // remove data from the contained properties\n        removePositionPropertyData(intersection.data, interval);\n      }\n    }\n    // remove the intervals from the composite\n    intervals.removeInterval(interval);\n    return;\n  }\n}\n\nfunction processPositionPacketData(\n  object,\n  propertyName,\n  packetData,\n  interval,\n  sourceUri,\n  entityCollection\n) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, len = packetData.length; i < len; ++i) {\n      processPositionProperty(\n        object,\n        propertyName,\n        packetData[i],\n        interval,\n        sourceUri,\n        entityCollection\n      );\n    }\n  } else {\n    processPositionProperty(\n      object,\n      propertyName,\n      packetData,\n      interval,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processShapePacketData(\n  object,\n  propertyName,\n  packetData,\n  entityCollection\n) {\n  if (defined(packetData.references)) {\n    processReferencesArrayPacketData(\n      object,\n      propertyName,\n      packetData.references,\n      packetData.interval,\n      entityCollection,\n      PropertyArray,\n      CompositeProperty\n    );\n  } else {\n    if (defined(packetData.cartesian)) {\n      packetData.array = Cartesian2.unpackArray(packetData.cartesian);\n    }\n\n    if (defined(packetData.array)) {\n      processPacketData(\n        Array,\n        object,\n        propertyName,\n        packetData,\n        undefined,\n        undefined,\n        entityCollection\n      );\n    }\n  }\n}\n\nfunction processMaterialProperty(\n  object,\n  propertyName,\n  packetData,\n  constrainedInterval,\n  sourceUri,\n  entityCollection\n) {\n  var combinedInterval = intervalFromString(packetData.interval);\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(\n        combinedInterval,\n        constrainedInterval,\n        scratchTimeInterval\n      );\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var property = object[propertyName];\n  var existingMaterial;\n  var existingInterval;\n\n  if (defined(combinedInterval)) {\n    if (!(property instanceof CompositeMaterialProperty)) {\n      property = new CompositeMaterialProperty();\n      object[propertyName] = property;\n    }\n    //See if we already have data at that interval.\n    var thisIntervals = property.intervals;\n    existingInterval = thisIntervals.findInterval({\n      start: combinedInterval.start,\n      stop: combinedInterval.stop,\n    });\n    if (defined(existingInterval)) {\n      //We have an interval, but we need to make sure the\n      //new data is the same type of material as the old data.\n      existingMaterial = existingInterval.data;\n    } else {\n      //If not, create it.\n      existingInterval = combinedInterval.clone();\n      thisIntervals.addInterval(existingInterval);\n    }\n  } else {\n    existingMaterial = property;\n  }\n\n  var materialData;\n  if (defined(packetData.solidColor)) {\n    if (!(existingMaterial instanceof ColorMaterialProperty)) {\n      existingMaterial = new ColorMaterialProperty();\n    }\n    materialData = packetData.solidColor;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      undefined,\n      entityCollection\n    );\n  } else if (defined(packetData.grid)) {\n    if (!(existingMaterial instanceof GridMaterialProperty)) {\n      existingMaterial = new GridMaterialProperty();\n    }\n    materialData = packetData.grid;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"cellAlpha\",\n      materialData.cellAlpha,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Cartesian2,\n      existingMaterial,\n      \"lineCount\",\n      materialData.lineCount,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Cartesian2,\n      existingMaterial,\n      \"lineThickness\",\n      materialData.lineThickness,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Cartesian2,\n      existingMaterial,\n      \"lineOffset\",\n      materialData.lineOffset,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  } else if (defined(packetData.image)) {\n    if (!(existingMaterial instanceof ImageMaterialProperty)) {\n      existingMaterial = new ImageMaterialProperty();\n    }\n    materialData = packetData.image;\n    processPacketData(\n      Image,\n      existingMaterial,\n      \"image\",\n      materialData.image,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Cartesian2,\n      existingMaterial,\n      \"repeat\",\n      materialData.repeat,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Boolean,\n      existingMaterial,\n      \"transparent\",\n      materialData.transparent,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  } else if (defined(packetData.stripe)) {\n    if (!(existingMaterial instanceof StripeMaterialProperty)) {\n      existingMaterial = new StripeMaterialProperty();\n    }\n    materialData = packetData.stripe;\n    processPacketData(\n      StripeOrientation,\n      existingMaterial,\n      \"orientation\",\n      materialData.orientation,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"evenColor\",\n      materialData.evenColor,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"oddColor\",\n      materialData.oddColor,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"offset\",\n      materialData.offset,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"repeat\",\n      materialData.repeat,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  } else if (defined(packetData.polylineOutline)) {\n    if (!(existingMaterial instanceof PolylineOutlineMaterialProperty)) {\n      existingMaterial = new PolylineOutlineMaterialProperty();\n    }\n    materialData = packetData.polylineOutline;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"outlineColor\",\n      materialData.outlineColor,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"outlineWidth\",\n      materialData.outlineWidth,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  } else if (defined(packetData.polylineGlow)) {\n    if (!(existingMaterial instanceof PolylineGlowMaterialProperty)) {\n      existingMaterial = new PolylineGlowMaterialProperty();\n    }\n    materialData = packetData.polylineGlow;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"glowPower\",\n      materialData.glowPower,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"taperPower\",\n      materialData.taperPower,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  } else if (defined(packetData.polylineArrow)) {\n    if (!(existingMaterial instanceof PolylineArrowMaterialProperty)) {\n      existingMaterial = new PolylineArrowMaterialProperty();\n    }\n    materialData = packetData.polylineArrow;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      undefined,\n      entityCollection\n    );\n  } else if (defined(packetData.polylineDash)) {\n    if (!(existingMaterial instanceof PolylineDashMaterialProperty)) {\n      existingMaterial = new PolylineDashMaterialProperty();\n    }\n    materialData = packetData.polylineDash;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"color\",\n      materialData.color,\n      undefined,\n      undefined,\n      entityCollection\n    );\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"gapColor\",\n      materialData.gapColor,\n      undefined,\n      undefined,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"dashLength\",\n      materialData.dashLength,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Number,\n      existingMaterial,\n      \"dashPattern\",\n      materialData.dashPattern,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  } else if (defined(packetData.checkerboard)) {\n    if (!(existingMaterial instanceof CheckerboardMaterialProperty)) {\n      existingMaterial = new CheckerboardMaterialProperty();\n    }\n    materialData = packetData.checkerboard;\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"evenColor\",\n      materialData.evenColor,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Color,\n      existingMaterial,\n      \"oddColor\",\n      materialData.oddColor,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Cartesian2,\n      existingMaterial,\n      \"repeat\",\n      materialData.repeat,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  }\n\n  if (defined(existingInterval)) {\n    existingInterval.data = existingMaterial;\n  } else {\n    object[propertyName] = existingMaterial;\n  }\n}\n\nfunction processMaterialPacketData(\n  object,\n  propertyName,\n  packetData,\n  interval,\n  sourceUri,\n  entityCollection\n) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, len = packetData.length; i < len; ++i) {\n      processMaterialProperty(\n        object,\n        propertyName,\n        packetData[i],\n        interval,\n        sourceUri,\n        entityCollection\n      );\n    }\n  } else {\n    processMaterialProperty(\n      object,\n      propertyName,\n      packetData,\n      interval,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processName(entity, packet, entityCollection, sourceUri) {\n  var nameData = packet.name;\n  if (defined(nameData)) {\n    entity.name = packet.name;\n  }\n}\n\nfunction processDescription(entity, packet, entityCollection, sourceUri) {\n  var descriptionData = packet.description;\n  if (defined(descriptionData)) {\n    processPacketData(\n      String,\n      entity,\n      \"description\",\n      descriptionData,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processPosition(entity, packet, entityCollection, sourceUri) {\n  var positionData = packet.position;\n  if (defined(positionData)) {\n    processPositionPacketData(\n      entity,\n      \"position\",\n      positionData,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processViewFrom(entity, packet, entityCollection, sourceUri) {\n  var viewFromData = packet.viewFrom;\n  if (defined(viewFromData)) {\n    processPacketData(\n      Cartesian3,\n      entity,\n      \"viewFrom\",\n      viewFromData,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processOrientation(entity, packet, entityCollection, sourceUri) {\n  var orientationData = packet.orientation;\n  if (defined(orientationData)) {\n    processPacketData(\n      Quaternion,\n      entity,\n      \"orientation\",\n      orientationData,\n      undefined,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processProperties(entity, packet, entityCollection, sourceUri) {\n  var propertiesData = packet.properties;\n  if (defined(propertiesData)) {\n    if (!defined(entity.properties)) {\n      entity.properties = new PropertyBag();\n    }\n\n    // We cannot simply call processPacketData(entity, 'properties', propertyData, undefined, sourceUri, entityCollection)\n    // because each property of \"properties\" may vary separately.\n    // The properties will be accessible as entity.properties.myprop.getValue(time).\n\n    for (var key in propertiesData) {\n      if (propertiesData.hasOwnProperty(key)) {\n        if (!entity.properties.hasProperty(key)) {\n          entity.properties.addProperty(key);\n        }\n\n        var propertyData = propertiesData[key];\n        if (Array.isArray(propertyData)) {\n          for (var i = 0, len = propertyData.length; i < len; ++i) {\n            processProperty(\n              getPropertyType(propertyData[i]),\n              entity.properties,\n              key,\n              propertyData[i],\n              undefined,\n              sourceUri,\n              entityCollection\n            );\n          }\n        } else {\n          processProperty(\n            getPropertyType(propertyData),\n            entity.properties,\n            key,\n            propertyData,\n            undefined,\n            sourceUri,\n            entityCollection\n          );\n        }\n      }\n    }\n  }\n}\n\nfunction processReferencesArrayPacketData(\n  object,\n  propertyName,\n  references,\n  interval,\n  entityCollection,\n  PropertyArrayType,\n  CompositePropertyArrayType\n) {\n  var properties = references.map(function (reference) {\n    return createReferenceProperty(entityCollection, reference);\n  });\n\n  if (defined(interval)) {\n    interval = intervalFromString(interval);\n    var property = object[propertyName];\n    if (!(property instanceof CompositePropertyArrayType)) {\n      // If the property was not already a CompositeProperty,\n      // create a CompositeProperty but preserve the existing data.\n\n      // Create the composite and add the old property, wrapped in an infinite interval.\n      var composite = new CompositePropertyArrayType();\n      composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n\n      object[propertyName] = property = composite;\n    }\n\n    interval.data = new PropertyArrayType(properties);\n    property.intervals.addInterval(interval);\n  } else {\n    object[propertyName] = new PropertyArrayType(properties);\n  }\n}\n\nfunction processArrayPacketData(\n  object,\n  propertyName,\n  packetData,\n  entityCollection\n) {\n  var references = packetData.references;\n  if (defined(references)) {\n    processReferencesArrayPacketData(\n      object,\n      propertyName,\n      references,\n      packetData.interval,\n      entityCollection,\n      PropertyArray,\n      CompositeProperty\n    );\n  } else {\n    processPacketData(\n      Array,\n      object,\n      propertyName,\n      packetData,\n      undefined,\n      undefined,\n      entityCollection\n    );\n  }\n}\n\nfunction processArray(object, propertyName, packetData, entityCollection) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, length = packetData.length; i < length; ++i) {\n      processArrayPacketData(\n        object,\n        propertyName,\n        packetData[i],\n        entityCollection\n      );\n    }\n  } else {\n    processArrayPacketData(object, propertyName, packetData, entityCollection);\n  }\n}\n\nfunction processPositionArrayPacketData(\n  object,\n  propertyName,\n  packetData,\n  entityCollection\n) {\n  var references = packetData.references;\n  if (defined(references)) {\n    processReferencesArrayPacketData(\n      object,\n      propertyName,\n      references,\n      packetData.interval,\n      entityCollection,\n      PositionPropertyArray,\n      CompositePositionProperty\n    );\n  } else {\n    if (defined(packetData.cartesian)) {\n      packetData.array = Cartesian3.unpackArray(packetData.cartesian);\n    } else if (defined(packetData.cartographicRadians)) {\n      packetData.array = Cartesian3.fromRadiansArrayHeights(\n        packetData.cartographicRadians\n      );\n    } else if (defined(packetData.cartographicDegrees)) {\n      packetData.array = Cartesian3.fromDegreesArrayHeights(\n        packetData.cartographicDegrees\n      );\n    }\n\n    if (defined(packetData.array)) {\n      processPacketData(\n        Array,\n        object,\n        propertyName,\n        packetData,\n        undefined,\n        undefined,\n        entityCollection\n      );\n    }\n  }\n}\n\nfunction processPositionArray(\n  object,\n  propertyName,\n  packetData,\n  entityCollection\n) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, length = packetData.length; i < length; ++i) {\n      processPositionArrayPacketData(\n        object,\n        propertyName,\n        packetData[i],\n        entityCollection\n      );\n    }\n  } else {\n    processPositionArrayPacketData(\n      object,\n      propertyName,\n      packetData,\n      entityCollection\n    );\n  }\n}\n\nfunction unpackCartesianArray(array) {\n  return Cartesian3.unpackArray(array);\n}\n\nfunction unpackCartographicRadiansArray(array) {\n  return Cartesian3.fromRadiansArrayHeights(array);\n}\n\nfunction unpackCartographicDegreesArray(array) {\n  return Cartesian3.fromDegreesArrayHeights(array);\n}\n\nfunction processPositionArrayOfArraysPacketData(\n  object,\n  propertyName,\n  packetData,\n  entityCollection\n) {\n  var references = packetData.references;\n  if (defined(references)) {\n    var properties = references.map(function (referenceArray) {\n      var tempObj = {};\n      processReferencesArrayPacketData(\n        tempObj,\n        \"positions\",\n        referenceArray,\n        packetData.interval,\n        entityCollection,\n        PositionPropertyArray,\n        CompositePositionProperty\n      );\n      return tempObj.positions;\n    });\n    object[propertyName] = new PositionPropertyArray(properties);\n  } else {\n    if (defined(packetData.cartesian)) {\n      packetData.array = packetData.cartesian.map(unpackCartesianArray);\n    } else if (defined(packetData.cartographicRadians)) {\n      packetData.array = packetData.cartographicRadians.map(\n        unpackCartographicRadiansArray\n      );\n    } else if (defined(packetData.cartographicDegrees)) {\n      packetData.array = packetData.cartographicDegrees.map(\n        unpackCartographicDegreesArray\n      );\n    }\n\n    if (defined(packetData.array)) {\n      processPacketData(\n        Array,\n        object,\n        propertyName,\n        packetData,\n        undefined,\n        undefined,\n        entityCollection\n      );\n    }\n  }\n}\n\nfunction processPositionArrayOfArrays(\n  object,\n  propertyName,\n  packetData,\n  entityCollection\n) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, length = packetData.length; i < length; ++i) {\n      processPositionArrayOfArraysPacketData(\n        object,\n        propertyName,\n        packetData[i],\n        entityCollection\n      );\n    }\n  } else {\n    processPositionArrayOfArraysPacketData(\n      object,\n      propertyName,\n      packetData,\n      entityCollection\n    );\n  }\n}\n\nfunction processShape(object, propertyName, packetData, entityCollection) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  if (Array.isArray(packetData)) {\n    for (var i = 0, length = packetData.length; i < length; i++) {\n      processShapePacketData(\n        object,\n        propertyName,\n        packetData[i],\n        entityCollection\n      );\n    }\n  } else {\n    processShapePacketData(object, propertyName, packetData, entityCollection);\n  }\n}\n\nfunction processAvailability(entity, packet, entityCollection, sourceUri) {\n  var packetData = packet.availability;\n  if (!defined(packetData)) {\n    return;\n  }\n\n  var intervals;\n  if (Array.isArray(packetData)) {\n    for (var i = 0, len = packetData.length; i < len; ++i) {\n      if (!defined(intervals)) {\n        intervals = new TimeIntervalCollection();\n      }\n      intervals.addInterval(intervalFromString(packetData[i]));\n    }\n  } else {\n    intervals = new TimeIntervalCollection();\n    intervals.addInterval(intervalFromString(packetData));\n  }\n  entity.availability = intervals;\n}\n\nfunction processAlignedAxis(\n  billboard,\n  packetData,\n  interval,\n  sourceUri,\n  entityCollection\n) {\n  if (!defined(packetData)) {\n    return;\n  }\n\n  processPacketData(\n    UnitCartesian3,\n    billboard,\n    \"alignedAxis\",\n    packetData,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processBillboard(entity, packet, entityCollection, sourceUri) {\n  var billboardData = packet.billboard;\n  if (!defined(billboardData)) {\n    return;\n  }\n\n  var interval = intervalFromString(billboardData.interval);\n  var billboard = entity.billboard;\n  if (!defined(billboard)) {\n    entity.billboard = billboard = new BillboardGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    billboard,\n    \"show\",\n    billboardData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Image,\n    billboard,\n    \"image\",\n    billboardData.image,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    billboard,\n    \"scale\",\n    billboardData.scale,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian2,\n    billboard,\n    \"pixelOffset\",\n    billboardData.pixelOffset,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian3,\n    billboard,\n    \"eyeOffset\",\n    billboardData.eyeOffset,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HorizontalOrigin,\n    billboard,\n    \"horizontalOrigin\",\n    billboardData.horizontalOrigin,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    VerticalOrigin,\n    billboard,\n    \"verticalOrigin\",\n    billboardData.verticalOrigin,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    billboard,\n    \"heightReference\",\n    billboardData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    billboard,\n    \"color\",\n    billboardData.color,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rotation,\n    billboard,\n    \"rotation\",\n    billboardData.rotation,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processAlignedAxis(\n    billboard,\n    billboardData.alignedAxis,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    billboard,\n    \"sizeInMeters\",\n    billboardData.sizeInMeters,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    billboard,\n    \"width\",\n    billboardData.width,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    billboard,\n    \"height\",\n    billboardData.height,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    billboard,\n    \"scaleByDistance\",\n    billboardData.scaleByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    billboard,\n    \"translucencyByDistance\",\n    billboardData.translucencyByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    billboard,\n    \"pixelOffsetScaleByDistance\",\n    billboardData.pixelOffsetScaleByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    BoundingRectangle,\n    billboard,\n    \"imageSubRegion\",\n    billboardData.imageSubRegion,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    billboard,\n    \"distanceDisplayCondition\",\n    billboardData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    billboard,\n    \"disableDepthTestDistance\",\n    billboardData.disableDepthTestDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processBox(entity, packet, entityCollection, sourceUri) {\n  var boxData = packet.box;\n  if (!defined(boxData)) {\n    return;\n  }\n\n  var interval = intervalFromString(boxData.interval);\n  var box = entity.box;\n  if (!defined(box)) {\n    entity.box = box = new BoxGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    box,\n    \"show\",\n    boxData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian3,\n    box,\n    \"dimensions\",\n    boxData.dimensions,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    box,\n    \"heightReference\",\n    boxData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    box,\n    \"fill\",\n    boxData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    box,\n    \"material\",\n    boxData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    box,\n    \"outline\",\n    boxData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    box,\n    \"outlineColor\",\n    boxData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    box,\n    \"outlineWidth\",\n    boxData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    box,\n    \"shadows\",\n    boxData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    box,\n    \"distanceDisplayCondition\",\n    boxData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processCorridor(entity, packet, entityCollection, sourceUri) {\n  var corridorData = packet.corridor;\n  if (!defined(corridorData)) {\n    return;\n  }\n\n  var interval = intervalFromString(corridorData.interval);\n  var corridor = entity.corridor;\n  if (!defined(corridor)) {\n    entity.corridor = corridor = new CorridorGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    corridor,\n    \"show\",\n    corridorData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPositionArray(\n    corridor,\n    \"positions\",\n    corridorData.positions,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    corridor,\n    \"width\",\n    corridorData.width,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    corridor,\n    \"height\",\n    corridorData.height,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    corridor,\n    \"heightReference\",\n    corridorData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    corridor,\n    \"extrudedHeight\",\n    corridorData.extrudedHeight,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    corridor,\n    \"extrudedHeightReference\",\n    corridorData.extrudedHeightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    CornerType,\n    corridor,\n    \"cornerType\",\n    corridorData.cornerType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    corridor,\n    \"granularity\",\n    corridorData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    corridor,\n    \"fill\",\n    corridorData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    corridor,\n    \"material\",\n    corridorData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    corridor,\n    \"outline\",\n    corridorData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    corridor,\n    \"outlineColor\",\n    corridorData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    corridor,\n    \"outlineWidth\",\n    corridorData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    corridor,\n    \"shadows\",\n    corridorData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    corridor,\n    \"distanceDisplayCondition\",\n    corridorData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ClassificationType,\n    corridor,\n    \"classificationType\",\n    corridorData.classificationType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    corridor,\n    \"zIndex\",\n    corridorData.zIndex,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processCylinder(entity, packet, entityCollection, sourceUri) {\n  var cylinderData = packet.cylinder;\n  if (!defined(cylinderData)) {\n    return;\n  }\n\n  var interval = intervalFromString(cylinderData.interval);\n  var cylinder = entity.cylinder;\n  if (!defined(cylinder)) {\n    entity.cylinder = cylinder = new CylinderGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    cylinder,\n    \"show\",\n    cylinderData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    cylinder,\n    \"length\",\n    cylinderData.length,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    cylinder,\n    \"topRadius\",\n    cylinderData.topRadius,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    cylinder,\n    \"bottomRadius\",\n    cylinderData.bottomRadius,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    cylinder,\n    \"heightReference\",\n    cylinderData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    cylinder,\n    \"fill\",\n    cylinderData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    cylinder,\n    \"material\",\n    cylinderData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    cylinder,\n    \"outline\",\n    cylinderData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    cylinder,\n    \"outlineColor\",\n    cylinderData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    cylinder,\n    \"outlineWidth\",\n    cylinderData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    cylinder,\n    \"numberOfVerticalLines\",\n    cylinderData.numberOfVerticalLines,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    cylinder,\n    \"slices\",\n    cylinderData.slices,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    cylinder,\n    \"shadows\",\n    cylinderData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    cylinder,\n    \"distanceDisplayCondition\",\n    cylinderData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processDocument(packet, dataSource) {\n  var version = packet.version;\n  if (defined(version)) {\n    if (typeof version === \"string\") {\n      var tokens = version.split(\".\");\n      if (tokens.length === 2) {\n        if (tokens[0] !== \"1\") {\n          throw new RuntimeError(\"Cesium only supports CZML version 1.\");\n        }\n        dataSource._version = version;\n      }\n    }\n  }\n\n  if (!defined(dataSource._version)) {\n    throw new RuntimeError(\n      \"CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.\"\n    );\n  }\n\n  var documentPacket = dataSource._documentPacket;\n\n  if (defined(packet.name)) {\n    documentPacket.name = packet.name;\n  }\n\n  var clockPacket = packet.clock;\n  if (defined(clockPacket)) {\n    var clock = documentPacket.clock;\n    if (!defined(clock)) {\n      documentPacket.clock = {\n        interval: clockPacket.interval,\n        currentTime: clockPacket.currentTime,\n        range: clockPacket.range,\n        step: clockPacket.step,\n        multiplier: clockPacket.multiplier,\n      };\n    } else {\n      clock.interval = defaultValue(clockPacket.interval, clock.interval);\n      clock.currentTime = defaultValue(\n        clockPacket.currentTime,\n        clock.currentTime\n      );\n      clock.range = defaultValue(clockPacket.range, clock.range);\n      clock.step = defaultValue(clockPacket.step, clock.step);\n      clock.multiplier = defaultValue(clockPacket.multiplier, clock.multiplier);\n    }\n  }\n}\n\nfunction processEllipse(entity, packet, entityCollection, sourceUri) {\n  var ellipseData = packet.ellipse;\n  if (!defined(ellipseData)) {\n    return;\n  }\n\n  var interval = intervalFromString(ellipseData.interval);\n  var ellipse = entity.ellipse;\n  if (!defined(ellipse)) {\n    entity.ellipse = ellipse = new EllipseGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    ellipse,\n    \"show\",\n    ellipseData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"semiMajorAxis\",\n    ellipseData.semiMajorAxis,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"semiMinorAxis\",\n    ellipseData.semiMinorAxis,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"height\",\n    ellipseData.height,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    ellipse,\n    \"heightReference\",\n    ellipseData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"extrudedHeight\",\n    ellipseData.extrudedHeight,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    ellipse,\n    \"extrudedHeightReference\",\n    ellipseData.extrudedHeightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rotation,\n    ellipse,\n    \"rotation\",\n    ellipseData.rotation,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rotation,\n    ellipse,\n    \"stRotation\",\n    ellipseData.stRotation,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"granularity\",\n    ellipseData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    ellipse,\n    \"fill\",\n    ellipseData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    ellipse,\n    \"material\",\n    ellipseData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    ellipse,\n    \"outline\",\n    ellipseData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    ellipse,\n    \"outlineColor\",\n    ellipseData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"outlineWidth\",\n    ellipseData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"numberOfVerticalLines\",\n    ellipseData.numberOfVerticalLines,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    ellipse,\n    \"shadows\",\n    ellipseData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    ellipse,\n    \"distanceDisplayCondition\",\n    ellipseData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ClassificationType,\n    ellipse,\n    \"classificationType\",\n    ellipseData.classificationType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipse,\n    \"zIndex\",\n    ellipseData.zIndex,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processEllipsoid(entity, packet, entityCollection, sourceUri) {\n  var ellipsoidData = packet.ellipsoid;\n  if (!defined(ellipsoidData)) {\n    return;\n  }\n\n  var interval = intervalFromString(ellipsoidData.interval);\n  var ellipsoid = entity.ellipsoid;\n  if (!defined(ellipsoid)) {\n    entity.ellipsoid = ellipsoid = new EllipsoidGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    ellipsoid,\n    \"show\",\n    ellipsoidData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian3,\n    ellipsoid,\n    \"radii\",\n    ellipsoidData.radii,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian3,\n    ellipsoid,\n    \"innerRadii\",\n    ellipsoidData.innerRadii,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"minimumClock\",\n    ellipsoidData.minimumClock,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"maximumClock\",\n    ellipsoidData.maximumClock,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"minimumCone\",\n    ellipsoidData.minimumCone,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"maximumCone\",\n    ellipsoidData.maximumCone,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    ellipsoid,\n    \"heightReference\",\n    ellipsoidData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    ellipsoid,\n    \"fill\",\n    ellipsoidData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    ellipsoid,\n    \"material\",\n    ellipsoidData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    ellipsoid,\n    \"outline\",\n    ellipsoidData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    ellipsoid,\n    \"outlineColor\",\n    ellipsoidData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"outlineWidth\",\n    ellipsoidData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"stackPartitions\",\n    ellipsoidData.stackPartitions,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"slicePartitions\",\n    ellipsoidData.slicePartitions,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    ellipsoid,\n    \"subdivisions\",\n    ellipsoidData.subdivisions,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    ellipsoid,\n    \"shadows\",\n    ellipsoidData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    ellipsoid,\n    \"distanceDisplayCondition\",\n    ellipsoidData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processLabel(entity, packet, entityCollection, sourceUri) {\n  var labelData = packet.label;\n  if (!defined(labelData)) {\n    return;\n  }\n\n  var interval = intervalFromString(labelData.interval);\n  var label = entity.label;\n  if (!defined(label)) {\n    entity.label = label = new LabelGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    label,\n    \"show\",\n    labelData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    String,\n    label,\n    \"text\",\n    labelData.text,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    String,\n    label,\n    \"font\",\n    labelData.font,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    LabelStyle,\n    label,\n    \"style\",\n    labelData.style,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    label,\n    \"scale\",\n    labelData.scale,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    label,\n    \"showBackground\",\n    labelData.showBackground,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    label,\n    \"backgroundColor\",\n    labelData.backgroundColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian2,\n    label,\n    \"backgroundPadding\",\n    labelData.backgroundPadding,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian2,\n    label,\n    \"pixelOffset\",\n    labelData.pixelOffset,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Cartesian3,\n    label,\n    \"eyeOffset\",\n    labelData.eyeOffset,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HorizontalOrigin,\n    label,\n    \"horizontalOrigin\",\n    labelData.horizontalOrigin,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    VerticalOrigin,\n    label,\n    \"verticalOrigin\",\n    labelData.verticalOrigin,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    label,\n    \"heightReference\",\n    labelData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    label,\n    \"fillColor\",\n    labelData.fillColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    label,\n    \"outlineColor\",\n    labelData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    label,\n    \"outlineWidth\",\n    labelData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    label,\n    \"translucencyByDistance\",\n    labelData.translucencyByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    label,\n    \"pixelOffsetScaleByDistance\",\n    labelData.pixelOffsetScaleByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    label,\n    \"scaleByDistance\",\n    labelData.scaleByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    label,\n    \"distanceDisplayCondition\",\n    labelData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    label,\n    \"disableDepthTestDistance\",\n    labelData.disableDepthTestDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processModel(entity, packet, entityCollection, sourceUri) {\n  var modelData = packet.model;\n  if (!defined(modelData)) {\n    return;\n  }\n\n  var interval = intervalFromString(modelData.interval);\n  var model = entity.model;\n  if (!defined(model)) {\n    entity.model = model = new ModelGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    model,\n    \"show\",\n    modelData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Uri,\n    model,\n    \"uri\",\n    modelData.gltf,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    model,\n    \"scale\",\n    modelData.scale,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    model,\n    \"minimumPixelSize\",\n    modelData.minimumPixelSize,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    model,\n    \"maximumScale\",\n    modelData.maximumScale,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    model,\n    \"incrementallyLoadTextures\",\n    modelData.incrementallyLoadTextures,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    model,\n    \"runAnimations\",\n    modelData.runAnimations,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    model,\n    \"clampAnimations\",\n    modelData.clampAnimations,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    model,\n    \"shadows\",\n    modelData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    model,\n    \"heightReference\",\n    modelData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    model,\n    \"silhouetteColor\",\n    modelData.silhouetteColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    model,\n    \"silhouetteSize\",\n    modelData.silhouetteSize,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    model,\n    \"color\",\n    modelData.color,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ColorBlendMode,\n    model,\n    \"colorBlendMode\",\n    modelData.colorBlendMode,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    model,\n    \"colorBlendAmount\",\n    modelData.colorBlendAmount,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    model,\n    \"distanceDisplayCondition\",\n    modelData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n\n  var i, len;\n  var nodeTransformationsData = modelData.nodeTransformations;\n  if (defined(nodeTransformationsData)) {\n    if (Array.isArray(nodeTransformationsData)) {\n      for (i = 0, len = nodeTransformationsData.length; i < len; ++i) {\n        processNodeTransformations(\n          model,\n          nodeTransformationsData[i],\n          interval,\n          sourceUri,\n          entityCollection\n        );\n      }\n    } else {\n      processNodeTransformations(\n        model,\n        nodeTransformationsData,\n        interval,\n        sourceUri,\n        entityCollection\n      );\n    }\n  }\n\n  var articulationsData = modelData.articulations;\n  if (defined(articulationsData)) {\n    if (Array.isArray(articulationsData)) {\n      for (i = 0, len = articulationsData.length; i < len; ++i) {\n        processArticulations(\n          model,\n          articulationsData[i],\n          interval,\n          sourceUri,\n          entityCollection\n        );\n      }\n    } else {\n      processArticulations(\n        model,\n        articulationsData,\n        interval,\n        sourceUri,\n        entityCollection\n      );\n    }\n  }\n}\n\nfunction processNodeTransformations(\n  model,\n  nodeTransformationsData,\n  constrainedInterval,\n  sourceUri,\n  entityCollection\n) {\n  var combinedInterval = intervalFromString(nodeTransformationsData.interval);\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(\n        combinedInterval,\n        constrainedInterval,\n        scratchTimeInterval\n      );\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var nodeTransformations = model.nodeTransformations;\n  var nodeNames = Object.keys(nodeTransformationsData);\n  for (var i = 0, len = nodeNames.length; i < len; ++i) {\n    var nodeName = nodeNames[i];\n    if (nodeName === \"interval\") {\n      continue;\n    }\n\n    var nodeTransformationData = nodeTransformationsData[nodeName];\n    if (!defined(nodeTransformationData)) {\n      continue;\n    }\n\n    if (!defined(nodeTransformations)) {\n      model.nodeTransformations = nodeTransformations = new PropertyBag();\n    }\n\n    if (!nodeTransformations.hasProperty(nodeName)) {\n      nodeTransformations.addProperty(nodeName);\n    }\n\n    var nodeTransformation = nodeTransformations[nodeName];\n    if (!defined(nodeTransformation)) {\n      nodeTransformations[\n        nodeName\n      ] = nodeTransformation = new NodeTransformationProperty();\n    }\n\n    processPacketData(\n      Cartesian3,\n      nodeTransformation,\n      \"translation\",\n      nodeTransformationData.translation,\n      combinedInterval,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Quaternion,\n      nodeTransformation,\n      \"rotation\",\n      nodeTransformationData.rotation,\n      combinedInterval,\n      sourceUri,\n      entityCollection\n    );\n    processPacketData(\n      Cartesian3,\n      nodeTransformation,\n      \"scale\",\n      nodeTransformationData.scale,\n      combinedInterval,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processArticulations(\n  model,\n  articulationsData,\n  constrainedInterval,\n  sourceUri,\n  entityCollection\n) {\n  var combinedInterval = intervalFromString(articulationsData.interval);\n  if (defined(constrainedInterval)) {\n    if (defined(combinedInterval)) {\n      combinedInterval = TimeInterval.intersect(\n        combinedInterval,\n        constrainedInterval,\n        scratchTimeInterval\n      );\n    } else {\n      combinedInterval = constrainedInterval;\n    }\n  }\n\n  var articulations = model.articulations;\n  var keys = Object.keys(articulationsData);\n  for (var i = 0, len = keys.length; i < len; ++i) {\n    var key = keys[i];\n    if (key === \"interval\") {\n      continue;\n    }\n\n    var articulationStageData = articulationsData[key];\n    if (!defined(articulationStageData)) {\n      continue;\n    }\n\n    if (!defined(articulations)) {\n      model.articulations = articulations = new PropertyBag();\n    }\n\n    if (!articulations.hasProperty(key)) {\n      articulations.addProperty(key);\n    }\n\n    processPacketData(\n      Number,\n      articulations,\n      key,\n      articulationStageData,\n      combinedInterval,\n      sourceUri,\n      entityCollection\n    );\n  }\n}\n\nfunction processPath(entity, packet, entityCollection, sourceUri) {\n  var pathData = packet.path;\n  if (!defined(pathData)) {\n    return;\n  }\n\n  var interval = intervalFromString(pathData.interval);\n  var path = entity.path;\n  if (!defined(path)) {\n    entity.path = path = new PathGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    path,\n    \"show\",\n    pathData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    path,\n    \"leadTime\",\n    pathData.leadTime,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    path,\n    \"trailTime\",\n    pathData.trailTime,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    path,\n    \"width\",\n    pathData.width,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    path,\n    \"resolution\",\n    pathData.resolution,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    path,\n    \"material\",\n    pathData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    path,\n    \"distanceDisplayCondition\",\n    pathData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processPoint(entity, packet, entityCollection, sourceUri) {\n  var pointData = packet.point;\n  if (!defined(pointData)) {\n    return;\n  }\n\n  var interval = intervalFromString(pointData.interval);\n  var point = entity.point;\n  if (!defined(point)) {\n    entity.point = point = new PointGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    point,\n    \"show\",\n    pointData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    point,\n    \"pixelSize\",\n    pointData.pixelSize,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    point,\n    \"heightReference\",\n    pointData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    point,\n    \"color\",\n    pointData.color,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    point,\n    \"outlineColor\",\n    pointData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    point,\n    \"outlineWidth\",\n    pointData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    point,\n    \"scaleByDistance\",\n    pointData.scaleByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    NearFarScalar,\n    point,\n    \"translucencyByDistance\",\n    pointData.translucencyByDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    point,\n    \"distanceDisplayCondition\",\n    pointData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    point,\n    \"disableDepthTestDistance\",\n    pointData.disableDepthTestDistance,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction PolygonHierarchyProperty(polygon) {\n  this.polygon = polygon;\n  this._definitionChanged = new Event();\n}\n\nObject.defineProperties(PolygonHierarchyProperty.prototype, {\n  isConstant: {\n    get: function () {\n      var positions = this.polygon._positions;\n      var holes = this.polygon._holes;\n      return (\n        (!defined(positions) || positions.isConstant) &&\n        (!defined(holes) || holes.isConstant)\n      );\n    },\n  },\n  definitionChanged: {\n    get: function () {\n      return this._definitionChanged;\n    },\n  },\n});\n\nPolygonHierarchyProperty.prototype.getValue = function (time, result) {\n  var positions;\n  if (defined(this.polygon._positions)) {\n    positions = this.polygon._positions.getValue(time);\n  }\n\n  var holes;\n  if (defined(this.polygon._holes)) {\n    holes = this.polygon._holes.getValue(time);\n    if (defined(holes)) {\n      holes = holes.map(function (holePositions) {\n        return new PolygonHierarchy(holePositions);\n      });\n    }\n  }\n\n  if (!defined(result)) {\n    return new PolygonHierarchy(positions, holes);\n  }\n\n  result.positions = positions;\n  result.holes = holes;\n  return result;\n};\n\nPolygonHierarchyProperty.prototype.equals = function (other) {\n  return (\n    this === other ||\n    (other instanceof PolygonHierarchyProperty &&\n      Property.equals(this.polygon._positions, other.polygon._positions) &&\n      Property.equals(this.polygon._holes, other.polygon._holes))\n  );\n};\n\nfunction processPolygon(entity, packet, entityCollection, sourceUri) {\n  var polygonData = packet.polygon;\n  if (!defined(polygonData)) {\n    return;\n  }\n\n  var interval = intervalFromString(polygonData.interval);\n  var polygon = entity.polygon;\n  if (!defined(polygon)) {\n    entity.polygon = polygon = new PolygonGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    polygon,\n    \"show\",\n    polygonData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n\n  // adapt 'position' property producing Cartesian[]\n  // and 'holes' property producing Cartesian[][]\n  // to a single property producing PolygonHierarchy\n  processPositionArray(\n    polygon,\n    \"_positions\",\n    polygonData.positions,\n    entityCollection\n  );\n  processPositionArrayOfArrays(\n    polygon,\n    \"_holes\",\n    polygonData.holes,\n    entityCollection\n  );\n  if (defined(polygon._positions) || defined(polygon._holes)) {\n    polygon.hierarchy = new PolygonHierarchyProperty(polygon);\n  }\n\n  processPacketData(\n    Number,\n    polygon,\n    \"height\",\n    polygonData.height,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    polygon,\n    \"heightReference\",\n    polygonData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polygon,\n    \"extrudedHeight\",\n    polygonData.extrudedHeight,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    polygon,\n    \"extrudedHeightReference\",\n    polygonData.extrudedHeightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rotation,\n    polygon,\n    \"stRotation\",\n    polygonData.stRotation,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polygon,\n    \"granularity\",\n    polygonData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polygon,\n    \"fill\",\n    polygonData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    polygon,\n    \"material\",\n    polygonData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polygon,\n    \"outline\",\n    polygonData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    polygon,\n    \"outlineColor\",\n    polygonData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polygon,\n    \"outlineWidth\",\n    polygonData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polygon,\n    \"perPositionHeight\",\n    polygonData.perPositionHeight,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polygon,\n    \"closeTop\",\n    polygonData.closeTop,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polygon,\n    \"closeBottom\",\n    polygonData.closeBottom,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ArcType,\n    polygon,\n    \"arcType\",\n    polygonData.arcType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    polygon,\n    \"shadows\",\n    polygonData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    polygon,\n    \"distanceDisplayCondition\",\n    polygonData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ClassificationType,\n    polygon,\n    \"classificationType\",\n    polygonData.classificationType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polygon,\n    \"zIndex\",\n    polygonData.zIndex,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction adaptFollowSurfaceToArcType(followSurface) {\n  return followSurface ? ArcType.GEODESIC : ArcType.NONE;\n}\n\nfunction processPolyline(entity, packet, entityCollection, sourceUri) {\n  var polylineData = packet.polyline;\n  if (!defined(polylineData)) {\n    return;\n  }\n\n  var interval = intervalFromString(polylineData.interval);\n  var polyline = entity.polyline;\n  if (!defined(polyline)) {\n    entity.polyline = polyline = new PolylineGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    polyline,\n    \"show\",\n    polylineData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPositionArray(\n    polyline,\n    \"positions\",\n    polylineData.positions,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polyline,\n    \"width\",\n    polylineData.width,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polyline,\n    \"granularity\",\n    polylineData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    polyline,\n    \"material\",\n    polylineData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    polyline,\n    \"depthFailMaterial\",\n    polylineData.depthFailMaterial,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ArcType,\n    polyline,\n    \"arcType\",\n    polylineData.arcType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polyline,\n    \"clampToGround\",\n    polylineData.clampToGround,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    polyline,\n    \"shadows\",\n    polylineData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    polyline,\n    \"distanceDisplayCondition\",\n    polylineData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ClassificationType,\n    polyline,\n    \"classificationType\",\n    polylineData.classificationType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polyline,\n    \"zIndex\",\n    polylineData.zIndex,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n\n  // for backwards compatibility, adapt CZML followSurface to arcType.\n  if (defined(polylineData.followSurface) && !defined(polylineData.arcType)) {\n    var tempObj = {};\n    processPacketData(\n      Boolean,\n      tempObj,\n      \"followSurface\",\n      polylineData.followSurface,\n      interval,\n      sourceUri,\n      entityCollection\n    );\n    polyline.arcType = createAdapterProperty(\n      tempObj.followSurface,\n      adaptFollowSurfaceToArcType\n    );\n  }\n}\n\nfunction processPolylineVolume(entity, packet, entityCollection, sourceUri) {\n  var polylineVolumeData = packet.polylineVolume;\n  if (!defined(polylineVolumeData)) {\n    return;\n  }\n\n  var interval = intervalFromString(polylineVolumeData.interval);\n  var polylineVolume = entity.polylineVolume;\n  if (!defined(polylineVolume)) {\n    entity.polylineVolume = polylineVolume = new PolylineVolumeGraphics();\n  }\n\n  processPositionArray(\n    polylineVolume,\n    \"positions\",\n    polylineVolumeData.positions,\n    entityCollection\n  );\n  processShape(\n    polylineVolume,\n    \"shape\",\n    polylineVolumeData.shape,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polylineVolume,\n    \"show\",\n    polylineVolumeData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    CornerType,\n    polylineVolume,\n    \"cornerType\",\n    polylineVolumeData.cornerType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polylineVolume,\n    \"fill\",\n    polylineVolumeData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    polylineVolume,\n    \"material\",\n    polylineVolumeData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    polylineVolume,\n    \"outline\",\n    polylineVolumeData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    polylineVolume,\n    \"outlineColor\",\n    polylineVolumeData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polylineVolume,\n    \"outlineWidth\",\n    polylineVolumeData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    polylineVolume,\n    \"granularity\",\n    polylineVolumeData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    polylineVolume,\n    \"shadows\",\n    polylineVolumeData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    polylineVolume,\n    \"distanceDisplayCondition\",\n    polylineVolumeData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processRectangle(entity, packet, entityCollection, sourceUri) {\n  var rectangleData = packet.rectangle;\n  if (!defined(rectangleData)) {\n    return;\n  }\n\n  var interval = intervalFromString(rectangleData.interval);\n  var rectangle = entity.rectangle;\n  if (!defined(rectangle)) {\n    entity.rectangle = rectangle = new RectangleGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    rectangle,\n    \"show\",\n    rectangleData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rectangle,\n    rectangle,\n    \"coordinates\",\n    rectangleData.coordinates,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    rectangle,\n    \"height\",\n    rectangleData.height,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    rectangle,\n    \"heightReference\",\n    rectangleData.heightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    rectangle,\n    \"extrudedHeight\",\n    rectangleData.extrudedHeight,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    HeightReference,\n    rectangle,\n    \"extrudedHeightReference\",\n    rectangleData.extrudedHeightReference,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rotation,\n    rectangle,\n    \"rotation\",\n    rectangleData.rotation,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Rotation,\n    rectangle,\n    \"stRotation\",\n    rectangleData.stRotation,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    rectangle,\n    \"granularity\",\n    rectangleData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    rectangle,\n    \"fill\",\n    rectangleData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    rectangle,\n    \"material\",\n    rectangleData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    rectangle,\n    \"outline\",\n    rectangleData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    rectangle,\n    \"outlineColor\",\n    rectangleData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    rectangle,\n    \"outlineWidth\",\n    rectangleData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    rectangle,\n    \"shadows\",\n    rectangleData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    rectangle,\n    \"distanceDisplayCondition\",\n    rectangleData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ClassificationType,\n    rectangle,\n    \"classificationType\",\n    rectangleData.classificationType,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    rectangle,\n    \"zIndex\",\n    rectangleData.zIndex,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processTileset(entity, packet, entityCollection, sourceUri) {\n  var tilesetData = packet.tileset;\n  if (!defined(tilesetData)) {\n    return;\n  }\n\n  var interval = intervalFromString(tilesetData.interval);\n  var tileset = entity.tileset;\n  if (!defined(tileset)) {\n    entity.tileset = tileset = new Cesium3DTilesetGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    tileset,\n    \"show\",\n    tilesetData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Uri,\n    tileset,\n    \"uri\",\n    tilesetData.uri,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    tileset,\n    \"maximumScreenSpaceError\",\n    tilesetData.maximumScreenSpaceError,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processWall(entity, packet, entityCollection, sourceUri) {\n  var wallData = packet.wall;\n  if (!defined(wallData)) {\n    return;\n  }\n\n  var interval = intervalFromString(wallData.interval);\n  var wall = entity.wall;\n  if (!defined(wall)) {\n    entity.wall = wall = new WallGraphics();\n  }\n\n  processPacketData(\n    Boolean,\n    wall,\n    \"show\",\n    wallData.show,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPositionArray(wall, \"positions\", wallData.positions, entityCollection);\n  processArray(\n    wall,\n    \"minimumHeights\",\n    wallData.minimumHeights,\n    entityCollection\n  );\n  processArray(\n    wall,\n    \"maximumHeights\",\n    wallData.maximumHeights,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    wall,\n    \"granularity\",\n    wallData.granularity,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    wall,\n    \"fill\",\n    wallData.fill,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processMaterialPacketData(\n    wall,\n    \"material\",\n    wallData.material,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Boolean,\n    wall,\n    \"outline\",\n    wallData.outline,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Color,\n    wall,\n    \"outlineColor\",\n    wallData.outlineColor,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    Number,\n    wall,\n    \"outlineWidth\",\n    wallData.outlineWidth,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    ShadowMode,\n    wall,\n    \"shadows\",\n    wallData.shadows,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n  processPacketData(\n    DistanceDisplayCondition,\n    wall,\n    \"distanceDisplayCondition\",\n    wallData.distanceDisplayCondition,\n    interval,\n    sourceUri,\n    entityCollection\n  );\n}\n\nfunction processCzmlPacket(\n  packet,\n  entityCollection,\n  updaterFunctions,\n  sourceUri,\n  dataSource\n) {\n  var objectId = packet.id;\n  if (!defined(objectId)) {\n    objectId = createGuid();\n  }\n\n  currentId = objectId;\n\n  if (!defined(dataSource._version) && objectId !== \"document\") {\n    throw new RuntimeError(\n      \"The first CZML packet is required to be the document object.\"\n    );\n  }\n\n  if (packet[\"delete\"] === true) {\n    entityCollection.removeById(objectId);\n  } else if (objectId === \"document\") {\n    processDocument(packet, dataSource);\n  } else {\n    var entity = entityCollection.getOrCreateEntity(objectId);\n\n    var parentId = packet.parent;\n    if (defined(parentId)) {\n      entity.parent = entityCollection.getOrCreateEntity(parentId);\n    }\n\n    for (var i = updaterFunctions.length - 1; i > -1; i--) {\n      updaterFunctions[i](entity, packet, entityCollection, sourceUri);\n    }\n  }\n\n  currentId = undefined;\n}\n\nfunction updateClock(dataSource) {\n  var clock;\n  var clockPacket = dataSource._documentPacket.clock;\n  if (!defined(clockPacket)) {\n    if (!defined(dataSource._clock)) {\n      var availability = dataSource._entityCollection.computeAvailability();\n      if (!availability.start.equals(Iso8601.MINIMUM_VALUE)) {\n        var startTime = availability.start;\n        var stopTime = availability.stop;\n        var totalSeconds = JulianDate.secondsDifference(stopTime, startTime);\n        var multiplier = Math.round(totalSeconds / 120.0);\n\n        clock = new DataSourceClock();\n        clock.startTime = JulianDate.clone(startTime);\n        clock.stopTime = JulianDate.clone(stopTime);\n        clock.clockRange = ClockRange.LOOP_STOP;\n        clock.multiplier = multiplier;\n        clock.currentTime = JulianDate.clone(startTime);\n        clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n        dataSource._clock = clock;\n        return true;\n      }\n    }\n    return false;\n  }\n\n  if (defined(dataSource._clock)) {\n    clock = dataSource._clock.clone();\n  } else {\n    clock = new DataSourceClock();\n    clock.startTime = Iso8601.MINIMUM_VALUE.clone();\n    clock.stopTime = Iso8601.MAXIMUM_VALUE.clone();\n    clock.currentTime = Iso8601.MINIMUM_VALUE.clone();\n    clock.clockRange = ClockRange.LOOP_STOP;\n    clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n    clock.multiplier = 1.0;\n  }\n\n  var interval = intervalFromString(clockPacket.interval);\n  if (defined(interval)) {\n    clock.startTime = interval.start;\n    clock.stopTime = interval.stop;\n  }\n\n  if (defined(clockPacket.currentTime)) {\n    clock.currentTime = JulianDate.fromIso8601(clockPacket.currentTime);\n  }\n  if (defined(clockPacket.range)) {\n    clock.clockRange = defaultValue(\n      ClockRange[clockPacket.range],\n      ClockRange.LOOP_STOP\n    );\n  }\n  if (defined(clockPacket.step)) {\n    clock.clockStep = defaultValue(\n      ClockStep[clockPacket.step],\n      ClockStep.SYSTEM_CLOCK_MULTIPLIER\n    );\n  }\n  if (defined(clockPacket.multiplier)) {\n    clock.multiplier = clockPacket.multiplier;\n  }\n\n  if (!clock.equals(dataSource._clock)) {\n    dataSource._clock = clock.clone(dataSource._clock);\n    return true;\n  }\n\n  return false;\n}\n\nfunction load(dataSource, czml, options, clear) {\n  \n\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  var promise = czml;\n  var sourceUri = options.sourceUri;\n\n  // User specified credit\n  var credit = options.credit;\n  if (typeof credit === \"string\") {\n    credit = new Credit(credit);\n  }\n  dataSource._credit = credit;\n\n  // If the czml is a URL\n  if (typeof czml === \"string\" || czml instanceof Resource) {\n    czml = Resource.createIfNeeded(czml);\n    promise = czml.fetchJson();\n    sourceUri = defaultValue(sourceUri, czml.clone());\n\n    // Add resource credits to our list of credits to display\n    var resourceCredits = dataSource._resourceCredits;\n    var credits = czml.credits;\n    if (defined(credits)) {\n      var length = credits.length;\n      for (var i = 0; i < length; i++) {\n        resourceCredits.push(credits[i]);\n      }\n    }\n  }\n\n  sourceUri = Resource.createIfNeeded(sourceUri);\n\n  DataSource.setLoading(dataSource, true);\n\n  return when(promise, function (czml) {\n    return loadCzml(dataSource, czml, sourceUri, clear);\n  }).otherwise(function (error) {\n    DataSource.setLoading(dataSource, false);\n    dataSource._error.raiseEvent(dataSource, error);\n    console.log(error);\n    return when.reject(error);\n  });\n}\n\nfunction loadCzml(dataSource, czml, sourceUri, clear) {\n  DataSource.setLoading(dataSource, true);\n  var entityCollection = dataSource._entityCollection;\n\n  if (clear) {\n    dataSource._version = undefined;\n    dataSource._documentPacket = new DocumentPacket();\n    entityCollection.removeAll();\n  }\n\n  CzmlDataSource._processCzml(\n    czml,\n    entityCollection,\n    sourceUri,\n    undefined,\n    dataSource\n  );\n\n  var raiseChangedEvent = updateClock(dataSource);\n\n  var documentPacket = dataSource._documentPacket;\n  if (\n    defined(documentPacket.name) &&\n    dataSource._name !== documentPacket.name\n  ) {\n    dataSource._name = documentPacket.name;\n    raiseChangedEvent = true;\n  } else if (!defined(dataSource._name) && defined(sourceUri)) {\n    dataSource._name = getFilenameFromUri(sourceUri.getUrlComponent());\n    raiseChangedEvent = true;\n  }\n\n  DataSource.setLoading(dataSource, false);\n  if (raiseChangedEvent) {\n    dataSource._changed.raiseEvent(dataSource);\n  }\n\n  return dataSource;\n}\n\nfunction DocumentPacket() {\n  this.name = undefined;\n  this.clock = undefined;\n}\n\n/**\n * @typedef {Object} CzmlDataSource.LoadOptions\n *\n * Initialization options for the `load` method.\n *\n * @property {Resource|string} [sourceUri] Overrides the url to use for resolving relative links.\n * @property {Credit|string} [credit] A credit for the data source, which is displayed on the canvas.\n */\n\n/**\n * A {@link DataSource} which processes {@link https://github.com/AnalyticalGraphicsInc/czml-writer/wiki/CZML-Guide|CZML}.\n * @alias CzmlDataSource\n * @constructor\n *\n * @param {String} [name] An optional name for the data source.  This value will be overwritten if a loaded document contains a name.\n *\n * @demo {@link https://sandcastle.cesium.com/index.html?src=CZML.html|Cesium Sandcastle CZML Demo}\n */\nfunction CzmlDataSource(name) {\n  this._name = name;\n  this._changed = new Event();\n  this._error = new Event();\n  this._isLoading = false;\n  this._loading = new Event();\n  this._clock = undefined;\n  this._documentPacket = new DocumentPacket();\n  this._version = undefined;\n  this._entityCollection = new EntityCollection(this);\n  this._entityCluster = new EntityCluster();\n  this._credit = undefined;\n  this._resourceCredits = [];\n}\n\n/**\n * Creates a Promise to a new instance loaded with the provided CZML data.\n *\n * @param {Resource|String|Object} czml A url or CZML object to be processed.\n * @param {CzmlDataSource.LoadOptions} [options] An object specifying configuration options\n *\n * @returns {Promise.<CzmlDataSource>} A promise that resolves to the new instance once the data is processed.\n */\nCzmlDataSource.load = function (czml, options) {\n  return new CzmlDataSource().load(czml, options);\n};\n\nObject.defineProperties(CzmlDataSource.prototype, {\n  /**\n   * Gets a human-readable name for this instance.\n   * @memberof CzmlDataSource.prototype\n   * @type {String}\n   */\n  name: {\n    get: function () {\n      return this._name;\n    },\n  },\n  /**\n   * Gets the clock settings defined by the loaded CZML.  If no clock is explicitly\n   * defined in the CZML, the combined availability of all objects is returned.  If\n   * only static data exists, this value is undefined.\n   * @memberof CzmlDataSource.prototype\n   * @type {DataSourceClock}\n   */\n  clock: {\n    get: function () {\n      return this._clock;\n    },\n  },\n  /**\n   * Gets the collection of {@link Entity} instances.\n   * @memberof CzmlDataSource.prototype\n   * @type {EntityCollection}\n   */\n  entities: {\n    get: function () {\n      return this._entityCollection;\n    },\n  },\n  /**\n   * Gets a value indicating if the data source is currently loading data.\n   * @memberof CzmlDataSource.prototype\n   * @type {Boolean}\n   */\n  isLoading: {\n    get: function () {\n      return this._isLoading;\n    },\n  },\n  /**\n   * Gets an event that will be raised when the underlying data changes.\n   * @memberof CzmlDataSource.prototype\n   * @type {Event}\n   */\n  changedEvent: {\n    get: function () {\n      return this._changed;\n    },\n  },\n  /**\n   * Gets an event that will be raised if an error is encountered during processing.\n   * @memberof CzmlDataSource.prototype\n   * @type {Event}\n   */\n  errorEvent: {\n    get: function () {\n      return this._error;\n    },\n  },\n  /**\n   * Gets an event that will be raised when the data source either starts or stops loading.\n   * @memberof CzmlDataSource.prototype\n   * @type {Event}\n   */\n  loadingEvent: {\n    get: function () {\n      return this._loading;\n    },\n  },\n  /**\n   * Gets whether or not this data source should be displayed.\n   * @memberof CzmlDataSource.prototype\n   * @type {Boolean}\n   */\n  show: {\n    get: function () {\n      return this._entityCollection.show;\n    },\n    set: function (value) {\n      this._entityCollection.show = value;\n    },\n  },\n\n  /**\n   * Gets or sets the clustering options for this data source. This object can be shared between multiple data sources.\n   *\n   * @memberof CzmlDataSource.prototype\n   * @type {EntityCluster}\n   */\n  clustering: {\n    get: function () {\n      return this._entityCluster;\n    },\n    set: function (value) {\n      \n      this._entityCluster = value;\n    },\n  },\n  /**\n   * Gets the credit that will be displayed for the data source\n   * @memberof CzmlDataSource.prototype\n   * @type {Credit}\n   */\n  credit: {\n    get: function () {\n      return this._credit;\n    },\n  },\n});\n\n/**\n * Gets the array of CZML processing functions.\n * @memberof CzmlDataSource\n * @type Array\n */\nCzmlDataSource.updaters = [\n  processBillboard, //\n  processBox, //\n  processCorridor, //\n  processCylinder, //\n  processEllipse, //\n  processEllipsoid, //\n  processLabel, //\n  processModel, //\n  processName, //\n  processDescription, //\n  processPath, //\n  processPoint, //\n  processPolygon, //\n  processPolyline, //\n  processPolylineVolume, //\n  processProperties, //\n  processRectangle, //\n  processPosition, //\n  processTileset, //\n  processViewFrom, //\n  processWall, //\n  processOrientation, //\n  processAvailability,\n];\n\n/**\n * Processes the provided url or CZML object without clearing any existing data.\n *\n * @param {Resource|String|Object} czml A url or CZML object to be processed.\n * @param {Object} [options] An object with the following properties:\n * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links.\n * @returns {Promise.<CzmlDataSource>} A promise that resolves to this instances once the data is processed.\n */\nCzmlDataSource.prototype.process = function (czml, options) {\n  return load(this, czml, options, false);\n};\n\n/**\n * Loads the provided url or CZML object, replacing any existing data.\n *\n * @param {Resource|String|Object} czml A url or CZML object to be processed.\n * @param {CzmlDataSource.LoadOptions} [options] An object specifying configuration options\n\n * @returns {Promise.<CzmlDataSource>} A promise that resolves to this instances once the data is processed.\n */\nCzmlDataSource.prototype.load = function (czml, options) {\n  return load(this, czml, options, true);\n};\n\n/**\n * Updates the data source to the provided time.  This function is optional and\n * is not required to be implemented.  It is provided for data sources which\n * retrieve data based on the current animation time or scene state.\n * If implemented, update will be called by {@link DataSourceDisplay} once a frame.\n *\n * @param {JulianDate} time The simulation time.\n * @returns {Boolean} True if this data source is ready to be displayed at the provided time, false otherwise.\n */\nCzmlDataSource.prototype.update = function (time) {\n  return true;\n};\n\n/**\n * A helper function used by custom CZML updater functions\n * which creates or updates a {@link Property} from a CZML packet.\n * @function\n *\n * @param {Function} type The constructor function for the property being processed.\n * @param {Object} object The object on which the property will be added or updated.\n * @param {String} propertyName The name of the property on the object.\n * @param {Object} packetData The CZML packet being processed.\n * @param {TimeInterval} interval A constraining interval for which the data is valid.\n * @param {String} sourceUri The originating uri of the data being processed.\n * @param {EntityCollection} entityCollection The collection being processsed.\n */\nCzmlDataSource.processPacketData = processPacketData;\n\n/**\n * A helper function used by custom CZML updater functions\n * which creates or updates a {@link PositionProperty} from a CZML packet.\n * @function\n *\n * @param {Object} object The object on which the property will be added or updated.\n * @param {String} propertyName The name of the property on the object.\n * @param {Object} packetData The CZML packet being processed.\n * @param {TimeInterval} interval A constraining interval for which the data is valid.\n * @param {String} sourceUri The originating uri of the data being processed.\n * @param {EntityCollection} entityCollection The collection being processsed.\n */\nCzmlDataSource.processPositionPacketData = processPositionPacketData;\n\n/**\n * A helper function used by custom CZML updater functions\n * which creates or updates a {@link MaterialProperty} from a CZML packet.\n * @function\n *\n * @param {Object} object The object on which the property will be added or updated.\n * @param {String} propertyName The name of the property on the object.\n * @param {Object} packetData The CZML packet being processed.\n * @param {TimeInterval} interval A constraining interval for which the data is valid.\n * @param {String} sourceUri The originating uri of the data being processed.\n * @param {EntityCollection} entityCollection The collection being processsed.\n */\nCzmlDataSource.processMaterialPacketData = processMaterialPacketData;\n\nCzmlDataSource._processCzml = function (\n  czml,\n  entityCollection,\n  sourceUri,\n  updaterFunctions,\n  dataSource\n) {\n  updaterFunctions = defaultValue(updaterFunctions, CzmlDataSource.updaters);\n\n  if (Array.isArray(czml)) {\n    for (var i = 0, len = czml.length; i < len; ++i) {\n      processCzmlPacket(\n        czml[i],\n        entityCollection,\n        updaterFunctions,\n        sourceUri,\n        dataSource\n      );\n    }\n  } else {\n    processCzmlPacket(\n      czml,\n      entityCollection,\n      updaterFunctions,\n      sourceUri,\n      dataSource\n    );\n  }\n};\nexport default CzmlDataSource;\n","var tmp = {};\n\n/*!\n * Autolinker.js\n * 3.11.0\n *\n * Copyright(c) 2019 Gregory Jacobs <greg@greg-jacobs.com>\n * MIT License\n *\n * https-colon-slashslash github.com/gregjacobs/Autolinker.js\n */\n(function (global, factory) {\n    global.Autolinker = factory();\n}(tmp, function () { 'use strict';\n\n    /**\n     * Assigns (shallow copies) the properties of `src` onto `dest`, if the\n     * corresponding property on `dest` === `undefined`.\n     *\n     * @param {Object} dest The destination object.\n     * @param {Object} src The source object.\n     * @return {Object} The destination object (`dest`)\n     */\n    function defaults(dest, src) {\n        for (var prop in src) {\n            if (src.hasOwnProperty(prop) && dest[prop] === undefined) {\n                dest[prop] = src[prop];\n            }\n        }\n        return dest;\n    }\n    /**\n     * Truncates the `str` at `len - ellipsisChars.length`, and adds the `ellipsisChars` to the\n     * end of the string (by default, two periods: '..'). If the `str` length does not exceed\n     * `len`, the string will be returned unchanged.\n     *\n     * @param {String} str The string to truncate and add an ellipsis to.\n     * @param {Number} truncateLen The length to truncate the string at.\n     * @param {String} [ellipsisChars=...] The ellipsis character(s) to add to the end of `str`\n     *   when truncated. Defaults to '...'\n     */\n    function ellipsis(str, truncateLen, ellipsisChars) {\n        var ellipsisLength;\n        if (str.length > truncateLen) {\n            if (ellipsisChars == null) {\n                ellipsisChars = '&hellip;';\n                ellipsisLength = 3;\n            }\n            else {\n                ellipsisLength = ellipsisChars.length;\n            }\n            str = str.substring(0, truncateLen - ellipsisLength) + ellipsisChars;\n        }\n        return str;\n    }\n    /**\n     * Supports `Array.prototype.indexOf()` functionality for old IE (IE8 and below).\n     *\n     * @param {Array} arr The array to find an element of.\n     * @param {*} element The element to find in the array, and return the index of.\n     * @return {Number} The index of the `element`, or -1 if it was not found.\n     */\n    function indexOf(arr, element) {\n        if (Array.prototype.indexOf) {\n            return arr.indexOf(element);\n        }\n        else {\n            for (var i = 0, len = arr.length; i < len; i++) {\n                if (arr[i] === element)\n                    return i;\n            }\n            return -1;\n        }\n    }\n    /**\n     * Removes array elements based on a filtering function. Mutates the input\n     * array.\n     *\n     * Using this instead of the ES5 Array.prototype.filter() function, to allow\n     * Autolinker compatibility with IE8, and also to prevent creating many new\n     * arrays in memory for filtering.\n     *\n     * @param {Array} arr The array to remove elements from. This array is\n     *   mutated.\n     * @param {Function} fn A function which should return `true` to\n     *   remove an element.\n     * @return {Array} The mutated input `arr`.\n     */\n    function remove(arr, fn) {\n        for (var i = arr.length - 1; i >= 0; i--) {\n            if (fn(arr[i]) === true) {\n                arr.splice(i, 1);\n            }\n        }\n    }\n    /**\n     * Performs the functionality of what modern browsers do when `String.prototype.split()` is called\n     * with a regular expression that contains capturing parenthesis.\n     *\n     * For example:\n     *\n     *     // Modern browsers:\n     *     \"a,b,c\".split( /(,)/ );  // --> [ 'a', ',', 'b', ',', 'c' ]\n     *\n     *     // Old IE (including IE8):\n     *     \"a,b,c\".split( /(,)/ );  // --> [ 'a', 'b', 'c' ]\n     *\n     * This method emulates the functionality of modern browsers for the old IE case.\n     *\n     * @param {String} str The string to split.\n     * @param {RegExp} splitRegex The regular expression to split the input `str` on. The splitting\n     *   character(s) will be spliced into the array, as in the \"modern browsers\" example in the\n     *   description of this method.\n     *   Note #1: the supplied regular expression **must** have the 'g' flag specified.\n     *   Note #2: for simplicity's sake, the regular expression does not need\n     *   to contain capturing parenthesis - it will be assumed that any match has them.\n     * @return {String[]} The split array of strings, with the splitting character(s) included.\n     */\n    function splitAndCapture(str, splitRegex) {\n        if (!splitRegex.global)\n            throw new Error(\"`splitRegex` must have the 'g' flag set\");\n        var result = [], lastIdx = 0, match;\n        while (match = splitRegex.exec(str)) {\n            result.push(str.substring(lastIdx, match.index));\n            result.push(match[0]); // push the splitting char(s)\n            lastIdx = match.index + match[0].length;\n        }\n        result.push(str.substring(lastIdx));\n        return result;\n    }\n    /**\n     * Function that should never be called but is used to check that every\n     * enum value is handled using TypeScript's 'never' type.\n     */\n    function throwUnhandledCaseError(theValue) {\n        throw new Error(\"Unhandled case for value: '\" + theValue + \"'\");\n    }\n\n    /**\n     * @class Autolinker.HtmlTag\n     * @extends Object\n     *\n     * Represents an HTML tag, which can be used to easily build/modify HTML tags programmatically.\n     *\n     * Autolinker uses this abstraction to create HTML tags, and then write them out as strings. You may also use\n     * this class in your code, especially within a {@link Autolinker#replaceFn replaceFn}.\n     *\n     * ## Examples\n     *\n     * Example instantiation:\n     *\n     *     var tag = new Autolinker.HtmlTag( {\n     *         tagName : 'a',\n     *         attrs   : { 'href': 'http-colon-slashslash google.com', 'class': 'external-link' },\n     *         innerHtml : 'Google'\n     *     } );\n     *\n     *     tag.toAnchorString();  // <a href=\"http-colon-slashslash google.com\" class=\"external-link\">Google</a>\n     *\n     *     // Individual accessor methods\n     *     tag.getTagName();                 // 'a'\n     *     tag.getAttr( 'href' );            // 'http-colon-slashslash google.com'\n     *     tag.hasClass( 'external-link' );  // true\n     *\n     *\n     * Using mutator methods (which may be used in combination with instantiation config properties):\n     *\n     *     var tag = new Autolinker.HtmlTag();\n     *     tag.setTagName( 'a' );\n     *     tag.setAttr( 'href', 'http-colon-slashslash google.com' );\n     *     tag.addClass( 'external-link' );\n     *     tag.setInnerHtml( 'Google' );\n     *\n     *     tag.getTagName();                 // 'a'\n     *     tag.getAttr( 'href' );            // 'http-colon-slashslash google.com'\n     *     tag.hasClass( 'external-link' );  // true\n     *\n     *     tag.toAnchorString();  // <a href=\"http-colon-slashslash google.com\" class=\"external-link\">Google</a>\n     *\n     *\n     * ## Example use within a {@link Autolinker#replaceFn replaceFn}\n     *\n     *     var html = Autolinker.link( \"Test google.com\", {\n     *         replaceFn : function( match ) {\n     *             var tag = match.buildTag();  // returns an {@link Autolinker.HtmlTag} instance, configured with the Match's href and anchor text\n     *             tag.setAttr( 'rel', 'nofollow' );\n     *\n     *             return tag;\n     *         }\n     *     } );\n     *\n     *     // generated html:\n     *     //   Test <a href=\"http-colon-slashslash google.com\" target=\"_blank\" rel=\"nofollow\">google.com</a>\n     *\n     *\n     * ## Example use with a new tag for the replacement\n     *\n     *     var html = Autolinker.link( \"Test google.com\", {\n     *         replaceFn : function( match ) {\n     *             var tag = new Autolinker.HtmlTag( {\n     *                 tagName : 'button',\n     *                 attrs   : { 'title': 'Load URL: ' + match.getAnchorHref() },\n     *                 innerHtml : 'Load URL: ' + match.getAnchorText()\n     *             } );\n     *\n     *             return tag;\n     *         }\n     *     } );\n     *\n     *     // generated html:\n     *     //   Test <button title=\"Load URL: http-colon-slashslash google.com\">Load URL: google.com</button>\n     */\n    var HtmlTag = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} [cfg] The configuration properties for this class, in an Object (map)\n         */\n        function HtmlTag(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            /**\n             * @cfg {String} tagName\n             *\n             * The tag name. Ex: 'a', 'button', etc.\n             *\n             * Not required at instantiation time, but should be set using {@link #setTagName} before {@link #toAnchorString}\n             * is executed.\n             */\n            this.tagName = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object.<String, String>} attrs\n             *\n             * An key/value Object (map) of attributes to create the tag with. The keys are the attribute names, and the\n             * values are the attribute values.\n             */\n            this.attrs = {}; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} innerHTML\n             *\n             * The inner HTML for the tag.\n             */\n            this.innerHTML = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @protected\n             * @property {RegExp} whitespaceRegex\n             *\n             * Regular expression used to match whitespace in a string of CSS classes.\n             */\n            this.whitespaceRegex = /\\s+/; // default value just to get the above doc comment in the ES5 output and documentation generator\n            this.tagName = cfg.tagName || '';\n            this.attrs = cfg.attrs || {};\n            this.innerHTML = cfg.innerHtml || cfg.innerHTML || ''; // accept either the camelCased form or the fully capitalized acronym as in the DOM\n        }\n        /**\n         * Sets the tag name that will be used to generate the tag with.\n         *\n         * @param {String} tagName\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setTagName = function (tagName) {\n            this.tagName = tagName;\n            return this;\n        };\n        /**\n         * Retrieves the tag name.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getTagName = function () {\n            return this.tagName || '';\n        };\n        /**\n         * Sets an attribute on the HtmlTag.\n         *\n         * @param {String} attrName The attribute name to set.\n         * @param {String} attrValue The attribute value to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setAttr = function (attrName, attrValue) {\n            var tagAttrs = this.getAttrs();\n            tagAttrs[attrName] = attrValue;\n            return this;\n        };\n        /**\n         * Retrieves an attribute from the HtmlTag. If the attribute does not exist, returns `undefined`.\n         *\n         * @param {String} attrName The attribute name to retrieve.\n         * @return {String} The attribute's value, or `undefined` if it does not exist on the HtmlTag.\n         */\n        HtmlTag.prototype.getAttr = function (attrName) {\n            return this.getAttrs()[attrName];\n        };\n        /**\n         * Sets one or more attributes on the HtmlTag.\n         *\n         * @param {Object.<String, String>} attrs A key/value Object (map) of the attributes to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setAttrs = function (attrs) {\n            Object.assign(this.getAttrs(), attrs);\n            return this;\n        };\n        /**\n         * Retrieves the attributes Object (map) for the HtmlTag.\n         *\n         * @return {Object.<String, String>} A key/value object of the attributes for the HtmlTag.\n         */\n        HtmlTag.prototype.getAttrs = function () {\n            return this.attrs || (this.attrs = {});\n        };\n        /**\n         * Sets the provided `cssClass`, overwriting any current CSS classes on the HtmlTag.\n         *\n         * @param {String} cssClass One or more space-separated CSS classes to set (overwrite).\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setClass = function (cssClass) {\n            return this.setAttr('class', cssClass);\n        };\n        /**\n         * Convenience method to add one or more CSS classes to the HtmlTag. Will not add duplicate CSS classes.\n         *\n         * @param {String} cssClass One or more space-separated CSS classes to add.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.addClass = function (cssClass) {\n            var classAttr = this.getClass(), whitespaceRegex = this.whitespaceRegex, classes = (!classAttr) ? [] : classAttr.split(whitespaceRegex), newClasses = cssClass.split(whitespaceRegex), newClass;\n            while (newClass = newClasses.shift()) {\n                if (indexOf(classes, newClass) === -1) {\n                    classes.push(newClass);\n                }\n            }\n            this.getAttrs()['class'] = classes.join(\" \");\n            return this;\n        };\n        /**\n         * Convenience method to remove one or more CSS classes from the HtmlTag.\n         *\n         * @param {String} cssClass One or more space-separated CSS classes to remove.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.removeClass = function (cssClass) {\n            var classAttr = this.getClass(), whitespaceRegex = this.whitespaceRegex, classes = (!classAttr) ? [] : classAttr.split(whitespaceRegex), removeClasses = cssClass.split(whitespaceRegex), removeClass;\n            while (classes.length && (removeClass = removeClasses.shift())) {\n                var idx = indexOf(classes, removeClass);\n                if (idx !== -1) {\n                    classes.splice(idx, 1);\n                }\n            }\n            this.getAttrs()['class'] = classes.join(\" \");\n            return this;\n        };\n        /**\n         * Convenience method to retrieve the CSS class(es) for the HtmlTag, which will each be separated by spaces when\n         * there are multiple.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getClass = function () {\n            return this.getAttrs()['class'] || \"\";\n        };\n        /**\n         * Convenience method to check if the tag has a CSS class or not.\n         *\n         * @param {String} cssClass The CSS class to check for.\n         * @return {Boolean} `true` if the HtmlTag has the CSS class, `false` otherwise.\n         */\n        HtmlTag.prototype.hasClass = function (cssClass) {\n            return (' ' + this.getClass() + ' ').indexOf(' ' + cssClass + ' ') !== -1;\n        };\n        /**\n         * Sets the inner HTML for the tag.\n         *\n         * @param {String} html The inner HTML to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setInnerHTML = function (html) {\n            this.innerHTML = html;\n            return this;\n        };\n        /**\n         * Backwards compatibility method name.\n         *\n         * @param {String} html The inner HTML to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setInnerHtml = function (html) {\n            return this.setInnerHTML(html);\n        };\n        /**\n         * Retrieves the inner HTML for the tag.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getInnerHTML = function () {\n            return this.innerHTML || \"\";\n        };\n        /**\n         * Backward compatibility method name.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getInnerHtml = function () {\n            return this.getInnerHTML();\n        };\n        /**\n         * Override of superclass method used to generate the HTML string for the tag.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.toAnchorString = function () {\n            var tagName = this.getTagName(), attrsStr = this.buildAttrsStr();\n            attrsStr = (attrsStr) ? ' ' + attrsStr : ''; // prepend a space if there are actually attributes\n            return ['<', tagName, attrsStr, '>', this.getInnerHtml(), '</', tagName, '>'].join(\"\");\n        };\n        /**\n         * Support method for {@link #toAnchorString}, returns the string space-separated key=\"value\" pairs, used to populate\n         * the stringified HtmlTag.\n         *\n         * @protected\n         * @return {String} Example return: `attr1=\"value1\" attr2=\"value2\"`\n         */\n        HtmlTag.prototype.buildAttrsStr = function () {\n            if (!this.attrs)\n                return \"\"; // no `attrs` Object (map) has been set, return empty string\n            var attrs = this.getAttrs(), attrsArr = [];\n            for (var prop in attrs) {\n                if (attrs.hasOwnProperty(prop)) {\n                    attrsArr.push(prop + '=\"' + attrs[prop] + '\"');\n                }\n            }\n            return attrsArr.join(\" \");\n        };\n        return HtmlTag;\n    }());\n\n    /**\n     * Date: 2015-10-05\n     * Author: Kasper Sfren <soefritz@gmail.com> (https-colon-slashslash github.com/kafoso)\n     *\n     * A truncation feature, where the ellipsis will be placed at a section within\n     * the URL making it still somewhat human readable.\n     *\n     * @param {String} url\t\t\t\t\t\t A URL.\n     * @param {Number} truncateLen\t\t The maximum length of the truncated output URL string.\n     * @param {String} ellipsisChars\t The characters to place within the url, e.g. \"...\".\n     * @return {String} The truncated URL.\n     */\n    function truncateSmart(url, truncateLen, ellipsisChars) {\n        var ellipsisLengthBeforeParsing;\n        var ellipsisLength;\n        if (ellipsisChars == null) {\n            ellipsisChars = '&hellip;';\n            ellipsisLength = 3;\n            ellipsisLengthBeforeParsing = 8;\n        }\n        else {\n            ellipsisLength = ellipsisChars.length;\n            ellipsisLengthBeforeParsing = ellipsisChars.length;\n        }\n        var parse_url = function (url) {\n            var urlObj = {};\n            var urlSub = url;\n            var match = urlSub.match(/^([a-z]+):\\/\\//i);\n            if (match) {\n                urlObj.scheme = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^(.*?)(?=(\\?|#|\\/|$))/i);\n            if (match) {\n                urlObj.host = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^\\/(.*?)(?=(\\?|#|$))/i);\n            if (match) {\n                urlObj.path = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^\\?(.*?)(?=(#|$))/i);\n            if (match) {\n                urlObj.query = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^#(.*?)$/i);\n            if (match) {\n                urlObj.fragment = match[1];\n                //urlSub = urlSub.substr(match[0].length);  -- not used. Uncomment if adding another block.\n            }\n            return urlObj;\n        };\n        var buildUrl = function (urlObj) {\n            var url = \"\";\n            if (urlObj.scheme && urlObj.host) {\n                url += urlObj.scheme + \"://\";\n            }\n            if (urlObj.host) {\n                url += urlObj.host;\n            }\n            if (urlObj.path) {\n                url += \"/\" + urlObj.path;\n            }\n            if (urlObj.query) {\n                url += \"?\" + urlObj.query;\n            }\n            if (urlObj.fragment) {\n                url += \"#\" + urlObj.fragment;\n            }\n            return url;\n        };\n        var buildSegment = function (segment, remainingAvailableLength) {\n            var remainingAvailableLengthHalf = remainingAvailableLength / 2, startOffset = Math.ceil(remainingAvailableLengthHalf), endOffset = (-1) * Math.floor(remainingAvailableLengthHalf), end = \"\";\n            if (endOffset < 0) {\n                end = segment.substr(endOffset);\n            }\n            return segment.substr(0, startOffset) + ellipsisChars + end;\n        };\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        var availableLength = truncateLen - ellipsisLength;\n        var urlObj = parse_url(url);\n        // Clean up the URL\n        if (urlObj.query) {\n            var matchQuery = urlObj.query.match(/^(.*?)(?=(\\?|\\#))(.*?)$/i);\n            if (matchQuery) {\n                // Malformed URL; two or more \"?\". Removed any content behind the 2nd.\n                urlObj.query = urlObj.query.substr(0, matchQuery[1].length);\n                url = buildUrl(urlObj);\n            }\n        }\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        if (urlObj.host) {\n            urlObj.host = urlObj.host.replace(/^www\\./, \"\");\n            url = buildUrl(urlObj);\n        }\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        // Process and build the URL\n        var str = \"\";\n        if (urlObj.host) {\n            str += urlObj.host;\n        }\n        if (str.length >= availableLength) {\n            if (urlObj.host.length == truncateLen) {\n                return (urlObj.host.substr(0, (truncateLen - ellipsisLength)) + ellipsisChars).substr(0, availableLength + ellipsisLengthBeforeParsing);\n            }\n            return buildSegment(str, availableLength).substr(0, availableLength + ellipsisLengthBeforeParsing);\n        }\n        var pathAndQuery = \"\";\n        if (urlObj.path) {\n            pathAndQuery += \"/\" + urlObj.path;\n        }\n        if (urlObj.query) {\n            pathAndQuery += \"?\" + urlObj.query;\n        }\n        if (pathAndQuery) {\n            if ((str + pathAndQuery).length >= availableLength) {\n                if ((str + pathAndQuery).length == truncateLen) {\n                    return (str + pathAndQuery).substr(0, truncateLen);\n                }\n                var remainingAvailableLength = availableLength - str.length;\n                return (str + buildSegment(pathAndQuery, remainingAvailableLength)).substr(0, availableLength + ellipsisLengthBeforeParsing);\n            }\n            else {\n                str += pathAndQuery;\n            }\n        }\n        if (urlObj.fragment) {\n            var fragment = \"#\" + urlObj.fragment;\n            if ((str + fragment).length >= availableLength) {\n                if ((str + fragment).length == truncateLen) {\n                    return (str + fragment).substr(0, truncateLen);\n                }\n                var remainingAvailableLength2 = availableLength - str.length;\n                return (str + buildSegment(fragment, remainingAvailableLength2)).substr(0, availableLength + ellipsisLengthBeforeParsing);\n            }\n            else {\n                str += fragment;\n            }\n        }\n        if (urlObj.scheme && urlObj.host) {\n            var scheme = urlObj.scheme + \"://\";\n            if ((str + scheme).length < availableLength) {\n                return (scheme + str).substr(0, truncateLen);\n            }\n        }\n        if (str.length <= truncateLen) {\n            return str;\n        }\n        var end = \"\";\n        if (availableLength > 0) {\n            end = str.substr((-1) * Math.floor(availableLength / 2));\n        }\n        return (str.substr(0, Math.ceil(availableLength / 2)) + ellipsisChars + end).substr(0, availableLength + ellipsisLengthBeforeParsing);\n    }\n\n    /**\n     * Date: 2015-10-05\n     * Author: Kasper Sfren <soefritz@gmail.com> (https-colon-slashslash github.com/kafoso)\n     *\n     * A truncation feature, where the ellipsis will be placed in the dead-center of the URL.\n     *\n     * @param {String} url             A URL.\n     * @param {Number} truncateLen     The maximum length of the truncated output URL string.\n     * @param {String} ellipsisChars   The characters to place within the url, e.g. \"..\".\n     * @return {String} The truncated URL.\n     */\n    function truncateMiddle(url, truncateLen, ellipsisChars) {\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        var ellipsisLengthBeforeParsing;\n        var ellipsisLength;\n        if (ellipsisChars == null) {\n            ellipsisChars = '&hellip;';\n            ellipsisLengthBeforeParsing = 8;\n            ellipsisLength = 3;\n        }\n        else {\n            ellipsisLengthBeforeParsing = ellipsisChars.length;\n            ellipsisLength = ellipsisChars.length;\n        }\n        var availableLength = truncateLen - ellipsisLength;\n        var end = \"\";\n        if (availableLength > 0) {\n            end = url.substr((-1) * Math.floor(availableLength / 2));\n        }\n        return (url.substr(0, Math.ceil(availableLength / 2)) + ellipsisChars + end).substr(0, availableLength + ellipsisLengthBeforeParsing);\n    }\n\n    /**\n     * A truncation feature where the ellipsis will be placed at the end of the URL.\n     *\n     * @param {String} anchorText\n     * @param {Number} truncateLen The maximum length of the truncated output URL string.\n     * @param {String} ellipsisChars The characters to place within the url, e.g. \"..\".\n     * @return {String} The truncated URL.\n     */\n    function truncateEnd(anchorText, truncateLen, ellipsisChars) {\n        return ellipsis(anchorText, truncateLen, ellipsisChars);\n    }\n\n    /**\n     * @protected\n     * @class Autolinker.AnchorTagBuilder\n     * @extends Object\n     *\n     * Builds anchor (&lt;a&gt;) tags for the Autolinker utility when a match is\n     * found.\n     *\n     * Normally this class is instantiated, configured, and used internally by an\n     * {@link Autolinker} instance, but may actually be used indirectly in a\n     * {@link Autolinker#replaceFn replaceFn} to create {@link Autolinker.HtmlTag HtmlTag}\n     * instances which may be modified before returning from the\n     * {@link Autolinker#replaceFn replaceFn}. For example:\n     *\n     *     var html = Autolinker.link( \"Test google.com\", {\n     *         replaceFn : function( match ) {\n     *             var tag = match.buildTag();  // returns an {@link Autolinker.HtmlTag} instance\n     *             tag.setAttr( 'rel', 'nofollow' );\n     *\n     *             return tag;\n     *         }\n     *     } );\n     *\n     *     // generated html:\n     *     //   Test <a href=\"http-colon-slashslash google.com\" target=\"_blank\" rel=\"nofollow\">google.com</a>\n     */\n    var AnchorTagBuilder = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} [cfg] The configuration options for the AnchorTagBuilder instance, specified in an Object (map).\n         */\n        function AnchorTagBuilder(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            /**\n             * @cfg {Boolean} newWindow\n             * @inheritdoc Autolinker#newWindow\n             */\n            this.newWindow = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object} truncate\n             * @inheritdoc Autolinker#truncate\n             */\n            this.truncate = {}; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} className\n             * @inheritdoc Autolinker#className\n             */\n            this.className = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            this.newWindow = cfg.newWindow || false;\n            this.truncate = cfg.truncate || {};\n            this.className = cfg.className || '';\n        }\n        /**\n         * Generates the actual anchor (&lt;a&gt;) tag to use in place of the\n         * matched text, via its `match` object.\n         *\n         * @param {Autolinker.match.Match} match The Match instance to generate an\n         *   anchor tag from.\n         * @return {Autolinker.HtmlTag} The HtmlTag instance for the anchor tag.\n         */\n        AnchorTagBuilder.prototype.build = function (match) {\n            return new HtmlTag({\n                tagName: 'a',\n                attrs: this.createAttrs(match),\n                innerHtml: this.processAnchorText(match.getAnchorText())\n            });\n        };\n        /**\n         * Creates the Object (map) of the HTML attributes for the anchor (&lt;a&gt;)\n         *   tag being generated.\n         *\n         * @protected\n         * @param {Autolinker.match.Match} match The Match instance to generate an\n         *   anchor tag from.\n         * @return {Object} A key/value Object (map) of the anchor tag's attributes.\n         */\n        AnchorTagBuilder.prototype.createAttrs = function (match) {\n            var attrs = {\n                'href': match.getAnchorHref() // we'll always have the `href` attribute\n            };\n            var cssClass = this.createCssClass(match);\n            if (cssClass) {\n                attrs['class'] = cssClass;\n            }\n            if (this.newWindow) {\n                attrs['target'] = \"_blank\";\n                attrs['rel'] = \"noopener noreferrer\"; // Issue #149. See https://mathiasbynens.github.io/rel-noopener/\n            }\n            if (this.truncate) {\n                if (this.truncate.length && this.truncate.length < match.getAnchorText().length) {\n                    attrs['title'] = match.getAnchorHref();\n                }\n            }\n            return attrs;\n        };\n        /**\n         * Creates the CSS class that will be used for a given anchor tag, based on\n         * the `matchType` and the {@link #className} config.\n         *\n         * Example returns:\n         *\n         * - \"\"                                      // no {@link #className}\n         * - \"myLink myLink-url\"                     // url match\n         * - \"myLink myLink-email\"                   // email match\n         * - \"myLink myLink-phone\"                   // phone match\n         * - \"myLink myLink-hashtag\"                 // hashtag match\n         * - \"myLink myLink-mention myLink-twitter\"  // mention match with Twitter service\n         *\n         * @protected\n         * @param {Autolinker.match.Match} match The Match instance to generate an\n         *   anchor tag from.\n         * @return {String} The CSS class string for the link. Example return:\n         *   \"myLink myLink-url\". If no {@link #className} was configured, returns\n         *   an empty string.\n         */\n        AnchorTagBuilder.prototype.createCssClass = function (match) {\n            var className = this.className;\n            if (!className) {\n                return \"\";\n            }\n            else {\n                var returnClasses = [className], cssClassSuffixes = match.getCssClassSuffixes();\n                for (var i = 0, len = cssClassSuffixes.length; i < len; i++) {\n                    returnClasses.push(className + '-' + cssClassSuffixes[i]);\n                }\n                return returnClasses.join(' ');\n            }\n        };\n        /**\n         * Processes the `anchorText` by truncating the text according to the\n         * {@link #truncate} config.\n         *\n         * @private\n         * @param {String} anchorText The anchor tag's text (i.e. what will be\n         *   displayed).\n         * @return {String} The processed `anchorText`.\n         */\n        AnchorTagBuilder.prototype.processAnchorText = function (anchorText) {\n            anchorText = this.doTruncate(anchorText);\n            return anchorText;\n        };\n        /**\n         * Performs the truncation of the `anchorText` based on the {@link #truncate}\n         * option. If the `anchorText` is longer than the length specified by the\n         * {@link #truncate} option, the truncation is performed based on the\n         * `location` property. See {@link #truncate} for details.\n         *\n         * @private\n         * @param {String} anchorText The anchor tag's text (i.e. what will be\n         *   displayed).\n         * @return {String} The truncated anchor text.\n         */\n        AnchorTagBuilder.prototype.doTruncate = function (anchorText) {\n            var truncate = this.truncate;\n            if (!truncate || !truncate.length)\n                return anchorText;\n            var truncateLength = truncate.length, truncateLocation = truncate.location;\n            if (truncateLocation === 'smart') {\n                return truncateSmart(anchorText, truncateLength);\n            }\n            else if (truncateLocation === 'middle') {\n                return truncateMiddle(anchorText, truncateLength);\n            }\n            else {\n                return truncateEnd(anchorText, truncateLength);\n            }\n        };\n        return AnchorTagBuilder;\n    }());\n\n    /**\n     * @abstract\n     * @class Autolinker.match.Match\n     *\n     * Represents a match found in an input string which should be Autolinked. A Match object is what is provided in a\n     * {@link Autolinker#replaceFn replaceFn}, and may be used to query for details about the match.\n     *\n     * For example:\n     *\n     *     var input = \"...\";  // string with URLs, Email Addresses, and Mentions (Twitter, Instagram, Soundcloud)\n     *\n     *     var linkedText = Autolinker.link( input, {\n     *         replaceFn : function( match ) {\n     *             console.log( \"href = \", match.getAnchorHref() );\n     *             console.log( \"text = \", match.getAnchorText() );\n     *\n     *             switch( match.getType() ) {\n     *                 case 'url' :\n     *                     console.log( \"url: \", match.getUrl() );\n     *\n     *                 case 'email' :\n     *                     console.log( \"email: \", match.getEmail() );\n     *\n     *                 case 'mention' :\n     *                     console.log( \"mention: \", match.getMention() );\n     *             }\n     *         }\n     *     } );\n     *\n     * See the {@link Autolinker} class for more details on using the {@link Autolinker#replaceFn replaceFn}.\n     */\n    var Match = /** @class */ (function () {\n        /**\n         * @member Autolinker.match.Match\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function Match(cfg) {\n            /**\n             * @cfg {Autolinker.AnchorTagBuilder} tagBuilder (required)\n             *\n             * Reference to the AnchorTagBuilder instance to use to generate an anchor\n             * tag for the Match.\n             */\n            this.__jsduckDummyDocProp = null; // property used just to get the above doc comment into the ES5 output and documentation generator\n            /**\n             * @cfg {String} matchedText (required)\n             *\n             * The original text that was matched by the {@link Autolinker.matcher.Matcher}.\n             */\n            this.matchedText = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Number} offset (required)\n             *\n             * The offset of where the match was made in the input string.\n             */\n            this.offset = 0; // default value just to get the above doc comment in the ES5 output and documentation generator\n            this.tagBuilder = cfg.tagBuilder;\n            this.matchedText = cfg.matchedText;\n            this.offset = cfg.offset;\n        }\n        /**\n         * Returns the original text that was matched.\n         *\n         * @return {String}\n         */\n        Match.prototype.getMatchedText = function () {\n            return this.matchedText;\n        };\n        /**\n         * Sets the {@link #offset} of where the match was made in the input string.\n         *\n         * A {@link Autolinker.matcher.Matcher} will be fed only HTML text nodes,\n         * and will therefore set an original offset that is relative to the HTML\n         * text node itself. However, we want this offset to be relative to the full\n         * HTML input string, and thus if using {@link Autolinker#parse} (rather\n         * than calling a {@link Autolinker.matcher.Matcher} directly), then this\n         * offset is corrected after the Matcher itself has done its job.\n         *\n         * @param {Number} offset\n         */\n        Match.prototype.setOffset = function (offset) {\n            this.offset = offset;\n        };\n        /**\n         * Returns the offset of where the match was made in the input string. This\n         * is the 0-based index of the match.\n         *\n         * @return {Number}\n         */\n        Match.prototype.getOffset = function () {\n            return this.offset;\n        };\n        /**\n         * Returns the CSS class suffix(es) for this match.\n         *\n         * A CSS class suffix is appended to the {@link Autolinker#className} in\n         * the {@link Autolinker.AnchorTagBuilder} when a match is translated into\n         * an anchor tag.\n         *\n         * For example, if {@link Autolinker#className} was configured as 'myLink',\n         * and this method returns `[ 'url' ]`, the final class name of the element\n         * will become: 'myLink myLink-url'.\n         *\n         * The match may provide multiple CSS class suffixes to be appended to the\n         * {@link Autolinker#className} in order to facilitate better styling\n         * options for different match criteria. See {@link Autolinker.match.Mention}\n         * for an example.\n         *\n         * By default, this method returns a single array with the match's\n         * {@link #getType type} name, but may be overridden by subclasses.\n         *\n         * @return {String[]}\n         */\n        Match.prototype.getCssClassSuffixes = function () {\n            return [this.getType()];\n        };\n        /**\n         * Builds and returns an {@link Autolinker.HtmlTag} instance based on the\n         * Match.\n         *\n         * This can be used to easily generate anchor tags from matches, and either\n         * return their HTML string, or modify them before doing so.\n         *\n         * Example Usage:\n         *\n         *     var tag = match.buildTag();\n         *     tag.addClass( 'cordova-link' );\n         *     tag.setAttr( 'target', '_system' );\n         *\n         *     tag.toAnchorString();  // <a href=\"http-colon-slashslash google.com\" class=\"cordova-link\" target=\"_system\">Google</a>\n         *\n         * Example Usage in {@link Autolinker#replaceFn}:\n         *\n         *     var html = Autolinker.link( \"Test google.com\", {\n         *         replaceFn : function( match ) {\n         *             var tag = match.buildTag();  // returns an {@link Autolinker.HtmlTag} instance\n         *             tag.setAttr( 'rel', 'nofollow' );\n         *\n         *             return tag;\n         *         }\n         *     } );\n         *\n         *     // generated html:\n         *     //   Test <a href=\"http-colon-slashslash google.com\" target=\"_blank\" rel=\"nofollow\">google.com</a>\n         */\n        Match.prototype.buildTag = function () {\n            return this.tagBuilder.build(this);\n        };\n        return Match;\n    }());\n\n    /*! *****************************************************************************\n    Copyright (c) Microsoft Corporation. All rights reserved.\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\n    this file except in compliance with the License. You may obtain a copy of the\n    License at http-colon-slashslash www.apache.org/licenses/LICENSE-2.0\n\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\n    MERCHANTABLITY OR NON-INFRINGEMENT.\n\n    See the Apache Version 2.0 License for specific language governing permissions\n    and limitations under the License.\n    ***************************************************************************** */\n    /* global Reflect, Promise */\n\n    var extendStatics = function(d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n\n    function __extends(d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    }\n\n    var __assign = function() {\n        __assign = Object.assign || function __assign(t) {\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\n                s = arguments[i];\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n            }\n            return t;\n        };\n        return __assign.apply(this, arguments);\n    };\n\n    /**\n     * @class Autolinker.match.Email\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Email match found in an input string which should be Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more details.\n     */\n    var EmailMatch = /** @class */ (function (_super) {\n        __extends(EmailMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function EmailMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} email (required)\n             *\n             * The email address that was matched.\n             */\n            _this.email = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.email = cfg.email;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of EmailMatch, returns 'email'.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getType = function () {\n            return 'email';\n        };\n        /**\n         * Returns the email address that was matched.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getEmail = function () {\n            return this.email;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getAnchorHref = function () {\n            return 'mailto:' + this.email;\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getAnchorText = function () {\n            return this.email;\n        };\n        return EmailMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Hashtag\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Hashtag match found in an input string which should be\n     * Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more\n     * details.\n     */\n    var HashtagMatch = /** @class */ (function (_super) {\n        __extends(HashtagMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function HashtagMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} serviceName\n             *\n             * The service to point hashtag matches to. See {@link Autolinker#hashtag}\n             * for available values.\n             */\n            _this.serviceName = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} hashtag (required)\n             *\n             * The HashtagMatch that was matched, without the '#'.\n             */\n            _this.hashtag = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.serviceName = cfg.serviceName;\n            _this.hashtag = cfg.hashtag;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of HashtagMatch, returns 'hashtag'.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getType = function () {\n            return 'hashtag';\n        };\n        /**\n         * Returns the configured {@link #serviceName} to point the HashtagMatch to.\n         * Ex: 'facebook', 'twitter'.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getServiceName = function () {\n            return this.serviceName;\n        };\n        /**\n         * Returns the matched hashtag, without the '#' character.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getHashtag = function () {\n            return this.hashtag;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getAnchorHref = function () {\n            var serviceName = this.serviceName, hashtag = this.hashtag;\n            switch (serviceName) {\n                case 'twitter':\n                    return 'https://twitter.com/hashtag/' + hashtag;\n                case 'facebook':\n                    return 'https://www.facebook.com/hashtag/' + hashtag;\n                case 'instagram':\n                    return 'https://instagram.com/explore/tags/' + hashtag;\n                default: // Shouldn't happen because Autolinker's constructor should block any invalid values, but just in case.\n                    throw new Error('Unknown service name to point hashtag to: ' + serviceName);\n            }\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getAnchorText = function () {\n            return '#' + this.hashtag;\n        };\n        return HashtagMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Mention\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Mention match found in an input string which should be Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more details.\n     */\n    var MentionMatch = /** @class */ (function (_super) {\n        __extends(MentionMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function MentionMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} serviceName\n             *\n             * The service to point mention matches to. See {@link Autolinker#mention}\n             * for available values.\n             */\n            _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} mention (required)\n             *\n             * The Mention that was matched, without the '@' character.\n             */\n            _this.mention = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.mention = cfg.mention;\n            _this.serviceName = cfg.serviceName;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of MentionMatch, returns 'mention'.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getType = function () {\n            return 'mention';\n        };\n        /**\n         * Returns the mention, without the '@' character.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getMention = function () {\n            return this.mention;\n        };\n        /**\n         * Returns the configured {@link #serviceName} to point the mention to.\n         * Ex: 'instagram', 'twitter', 'soundcloud'.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getServiceName = function () {\n            return this.serviceName;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getAnchorHref = function () {\n            switch (this.serviceName) {\n                case 'twitter':\n                    return 'https://twitter.com/' + this.mention;\n                case 'instagram':\n                    return 'https://instagram.com/' + this.mention;\n                case 'soundcloud':\n                    return 'https://soundcloud.com/' + this.mention;\n                default: // Shouldn't happen because Autolinker's constructor should block any invalid values, but just in case.\n                    throw new Error('Unknown service name to point mention to: ' + this.serviceName);\n            }\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getAnchorText = function () {\n            return '@' + this.mention;\n        };\n        /**\n         * Returns the CSS class suffixes that should be used on a tag built with\n         * the match. See {@link Autolinker.match.Match#getCssClassSuffixes} for\n         * details.\n         *\n         * @return {String[]}\n         */\n        MentionMatch.prototype.getCssClassSuffixes = function () {\n            var cssClassSuffixes = _super.prototype.getCssClassSuffixes.call(this), serviceName = this.getServiceName();\n            if (serviceName) {\n                cssClassSuffixes.push(serviceName);\n            }\n            return cssClassSuffixes;\n        };\n        return MentionMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Phone\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Phone number match found in an input string which should be\n     * Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more\n     * details.\n     */\n    var PhoneMatch = /** @class */ (function (_super) {\n        __extends(PhoneMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function PhoneMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @protected\n             * @property {String} number (required)\n             *\n             * The phone number that was matched, without any delimiter characters.\n             *\n             * Note: This is a string to allow for prefixed 0's.\n             */\n            _this.number = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @protected\n             * @property  {Boolean} plusSign (required)\n             *\n             * `true` if the matched phone number started with a '+' sign. We'll include\n             * it in the `tel:` URL if so, as this is needed for international numbers.\n             *\n             * Ex: '+1 (123) 456 7879'\n             */\n            _this.plusSign = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.number = cfg.number;\n            _this.plusSign = cfg.plusSign;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of PhoneMatch, returns 'phone'.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getType = function () {\n            return 'phone';\n        };\n        /**\n         * Returns the phone number that was matched as a string, without any\n         * delimiter characters.\n         *\n         * Note: This is a string to allow for prefixed 0's.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getPhoneNumber = function () {\n            return this.number;\n        };\n        /**\n         * Alias of {@link #getPhoneNumber}, returns the phone number that was\n         * matched as a string, without any delimiter characters.\n         *\n         * Note: This is a string to allow for prefixed 0's.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getNumber = function () {\n            return this.getPhoneNumber();\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getAnchorHref = function () {\n            return 'tel:' + (this.plusSign ? '+' : '') + this.number;\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getAnchorText = function () {\n            return this.matchedText;\n        };\n        return PhoneMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Url\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Url match found in an input string which should be Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more details.\n     */\n    var UrlMatch = /** @class */ (function (_super) {\n        __extends(UrlMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function UrlMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} url (required)\n             *\n             * The url that was matched.\n             */\n            _this.url = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {\"scheme\"/\"www\"/\"tld\"} urlMatchType (required)\n             *\n             * The type of URL match that this class represents. This helps to determine\n             * if the match was made in the original text with a prefixed scheme (ex:\n             * 'http-colon-slashslash www.google.com'), a prefixed 'www' (ex: 'www.google.com'), or\n             * was matched by a known top-level domain (ex: 'google.com').\n             */\n            _this.urlMatchType = 'scheme'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} protocolUrlMatch (required)\n             *\n             * `true` if the URL is a match which already has a protocol (i.e.\n             * 'http-colon-slashslash '), `false` if the match was from a 'www' or known TLD match.\n             */\n            _this.protocolUrlMatch = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} protocolRelativeMatch (required)\n             *\n             * `true` if the URL is a protocol-relative match. A protocol-relative match\n             * is a URL that starts with '//', and will be either http-colon-slashslash  or https-colon-slashslash \n             * based on the protocol that the site is loaded under.\n             */\n            _this.protocolRelativeMatch = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object} stripPrefix (required)\n             *\n             * The Object form of {@link Autolinker#cfg-stripPrefix}.\n             */\n            _this.stripPrefix = { scheme: true, www: true }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} stripTrailingSlash (required)\n             * @inheritdoc Autolinker#cfg-stripTrailingSlash\n             */\n            _this.stripTrailingSlash = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} decodePercentEncoding (required)\n             * @inheritdoc Autolinker#cfg-decodePercentEncoding\n             */\n            _this.decodePercentEncoding = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @private\n             * @property {RegExp} schemePrefixRegex\n             *\n             * A regular expression used to remove the 'http-colon-slashslash ' or 'https-colon-slashslash ' from\n             * URLs.\n             */\n            _this.schemePrefixRegex = /^(https?:\\/\\/)?/i;\n            /**\n             * @private\n             * @property {RegExp} wwwPrefixRegex\n             *\n             * A regular expression used to remove the 'www.' from URLs.\n             */\n            _this.wwwPrefixRegex = /^(https?:\\/\\/)?(www\\.)?/i;\n            /**\n             * @private\n             * @property {RegExp} protocolRelativeRegex\n             *\n             * The regular expression used to remove the protocol-relative '//' from the {@link #url} string, for purposes\n             * of {@link #getAnchorText}. A protocol-relative URL is, for example, \"//yahoo.com\"\n             */\n            _this.protocolRelativeRegex = /^\\/\\//;\n            /**\n             * @private\n             * @property {Boolean} protocolPrepended\n             *\n             * Will be set to `true` if the 'http-colon-slashslash ' protocol has been prepended to the {@link #url} (because the\n             * {@link #url} did not have a protocol)\n             */\n            _this.protocolPrepended = false;\n            _this.urlMatchType = cfg.urlMatchType;\n            _this.url = cfg.url;\n            _this.protocolUrlMatch = cfg.protocolUrlMatch;\n            _this.protocolRelativeMatch = cfg.protocolRelativeMatch;\n            _this.stripPrefix = cfg.stripPrefix;\n            _this.stripTrailingSlash = cfg.stripTrailingSlash;\n            _this.decodePercentEncoding = cfg.decodePercentEncoding;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of UrlMatch, returns 'url'.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getType = function () {\n            return 'url';\n        };\n        /**\n         * Returns a string name for the type of URL match that this class\n         * represents.\n         *\n         * This helps to determine if the match was made in the original text with a\n         * prefixed scheme (ex: 'http-colon-slashslash www.google.com'), a prefixed 'www' (ex:\n         * 'www.google.com'), or was matched by a known top-level domain (ex:\n         * 'google.com').\n         *\n         * @return {\"scheme\"/\"www\"/\"tld\"}\n         */\n        UrlMatch.prototype.getUrlMatchType = function () {\n            return this.urlMatchType;\n        };\n        /**\n         * Returns the url that was matched, assuming the protocol to be 'http-colon-slashslash ' if the original\n         * match was missing a protocol.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getUrl = function () {\n            var url = this.url;\n            // if the url string doesn't begin with a protocol, assume 'http://'\n            if (!this.protocolRelativeMatch && !this.protocolUrlMatch && !this.protocolPrepended) {\n                url = this.url = 'http://' + url;\n                this.protocolPrepended = true;\n            }\n            return url;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getAnchorHref = function () {\n            var url = this.getUrl();\n            return url.replace(/&amp;/g, '&'); // any &amp;'s in the URL should be converted back to '&' if they were displayed as &amp; in the source html\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getAnchorText = function () {\n            var anchorText = this.getMatchedText();\n            if (this.protocolRelativeMatch) {\n                // Strip off any protocol-relative '//' from the anchor text\n                anchorText = this.stripProtocolRelativePrefix(anchorText);\n            }\n            if (this.stripPrefix.scheme) {\n                anchorText = this.stripSchemePrefix(anchorText);\n            }\n            if (this.stripPrefix.www) {\n                anchorText = this.stripWwwPrefix(anchorText);\n            }\n            if (this.stripTrailingSlash) {\n                anchorText = this.removeTrailingSlash(anchorText); // remove trailing slash, if there is one\n            }\n            if (this.decodePercentEncoding) {\n                anchorText = this.removePercentEncoding(anchorText);\n            }\n            return anchorText;\n        };\n        // ---------------------------------------\n        // Utility Functionality\n        /**\n         * Strips the scheme prefix (such as \"http-colon-slashslash \" or \"https-colon-slashslash \") from the given\n         * `url`.\n         *\n         * @private\n         * @param {String} url The text of the anchor that is being generated, for\n         *   which to strip off the url scheme.\n         * @return {String} The `url`, with the scheme stripped.\n         */\n        UrlMatch.prototype.stripSchemePrefix = function (url) {\n            return url.replace(this.schemePrefixRegex, '');\n        };\n        /**\n         * Strips the 'www' prefix from the given `url`.\n         *\n         * @private\n         * @param {String} url The text of the anchor that is being generated, for\n         *   which to strip off the 'www' if it exists.\n         * @return {String} The `url`, with the 'www' stripped.\n         */\n        UrlMatch.prototype.stripWwwPrefix = function (url) {\n            return url.replace(this.wwwPrefixRegex, '$1'); // leave any scheme ($1), it one exists\n        };\n        /**\n         * Strips any protocol-relative '//' from the anchor text.\n         *\n         * @private\n         * @param {String} text The text of the anchor that is being generated, for which to strip off the\n         *   protocol-relative prefix (such as stripping off \"//\")\n         * @return {String} The `anchorText`, with the protocol-relative prefix stripped.\n         */\n        UrlMatch.prototype.stripProtocolRelativePrefix = function (text) {\n            return text.replace(this.protocolRelativeRegex, '');\n        };\n        /**\n         * Removes any trailing slash from the given `anchorText`, in preparation for the text to be displayed.\n         *\n         * @private\n         * @param {String} anchorText The text of the anchor that is being generated, for which to remove any trailing\n         *   slash ('/') that may exist.\n         * @return {String} The `anchorText`, with the trailing slash removed.\n         */\n        UrlMatch.prototype.removeTrailingSlash = function (anchorText) {\n            if (anchorText.charAt(anchorText.length - 1) === '/') {\n                anchorText = anchorText.slice(0, -1);\n            }\n            return anchorText;\n        };\n        /**\n         * Decodes percent-encoded characters from the given `anchorText`, in\n         * preparation for the text to be displayed.\n         *\n         * @private\n         * @param {String} anchorText The text of the anchor that is being\n         *   generated, for which to decode any percent-encoded characters.\n         * @return {String} The `anchorText`, with the percent-encoded characters\n         *   decoded.\n         */\n        UrlMatch.prototype.removePercentEncoding = function (anchorText) {\n            // First, convert a few of the known % encodings to the corresponding\n            // HTML entities that could accidentally be interpretted as special\n            // HTML characters\n            var preProcessedEntityAnchorText = anchorText\n                .replace(/%22/gi, '&quot;') // \" char\n                .replace(/%26/gi, '&amp;') // & char\n                .replace(/%27/gi, '&#39;') // ' char\n                .replace(/%3C/gi, '&lt;') // < char\n                .replace(/%3E/gi, '&gt;'); // > char\n            try {\n                // Now attempt to decode the rest of the anchor text\n                return decodeURIComponent(preProcessedEntityAnchorText);\n            }\n            catch (e) { // Invalid % escape sequence in the anchor text\n                return preProcessedEntityAnchorText;\n            }\n        };\n        return UrlMatch;\n    }(Match));\n\n    /**\n     * @abstract\n     * @class Autolinker.matcher.Matcher\n     *\n     * An abstract class and interface for individual matchers to find matches in\n     * an input string with linkified versions of them.\n     *\n     * Note that Matchers do not take HTML into account - they must be fed the text\n     * nodes of any HTML string, which is handled by {@link Autolinker#parse}.\n     */\n    var Matcher = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Matcher\n         *   instance, specified in an Object (map).\n         */\n        function Matcher(cfg) {\n            /**\n             * @cfg {Autolinker.AnchorTagBuilder} tagBuilder (required)\n             *\n             * Reference to the AnchorTagBuilder instance to use to generate HTML tags\n             * for {@link Autolinker.match.Match Matches}.\n             */\n            this.__jsduckDummyDocProp = null; // property used just to get the above doc comment into the ES5 output and documentation generator\n            this.tagBuilder = cfg.tagBuilder;\n        }\n        return Matcher;\n    }());\n\n    /*\n     * This file builds and stores a library of the common regular expressions used\n     * by the Autolinker utility.\n     *\n     * Other regular expressions may exist ad-hoc, but these are generally the\n     * regular expressions that are shared between source files.\n     */\n    /**\n     * Regular expression to match upper and lowercase ASCII letters\n     */\n    var letterRe = /[A-Za-z]/;\n    /**\n     * Regular expression to match ASCII digits\n     */\n    var digitRe = /[0-9]/;\n    /**\n     * Regular expression to match whitespace\n     */\n    var whitespaceRe = /\\s/;\n    /**\n     * Regular expression to match quote characters\n     */\n    var quoteRe = /['\"]/;\n    /**\n     * Regular expression to match the range of ASCII control characters (0-31), and\n     * the backspace char (127)\n     */\n    var controlCharsRe = /[\\x00-\\x1F\\x7F]/;\n    /**\n     * The string form of a regular expression that would match all of the\n     * alphabetic (\"letter\") chars in the unicode character set when placed in a\n     * RegExp character class (`[]`). This includes all international alphabetic\n     * characters.\n     *\n     * These would be the characters matched by unicode regex engines `\\p{L}`\n     * escape (\"all letters\").\n     *\n     * Taken from the XRegExp library: http-colon-slashslash xregexp.com/ (thanks @https-colon-slashslash github.com/slevithan)\n     * Specifically: http-colon-slashslash xregexp.com/v/3.2.0/xregexp-all.js, the 'Letter'\n     *   regex's bmp\n     *\n     * VERY IMPORTANT: This set of characters is defined inside of a Regular\n     *   Expression literal rather than a string literal to prevent UglifyJS from\n     *   compressing the unicode escape sequences into their actual unicode\n     *   characters. If Uglify compresses these into the unicode characters\n     *   themselves, this results in the error \"Range out of order in character\n     *   class\" when these characters are used inside of a Regular Expression\n     *   character class (`[]`). See usages of this const. Alternatively, we can set\n     *   the UglifyJS option `ascii_only` to true for the build, but that doesn't\n     *   help others who are pulling in Autolinker into their own build and running\n     *   UglifyJS themselves.\n     */\n    var alphaCharsStr = /A-Za-z\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B4\\u08B6-\\u08BD\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0AF9\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58-\\u0C5A\\u0C60\\u0C61\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D54-\\u0D56\\u0D5F-\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16F1-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1C80-\\u1C88\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FD5\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7AE\\uA7B0-\\uA7B7\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA8FD\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB65\\uAB70-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC/\n        .source; // see note in above variable description\n    /**\n     * The string form of a regular expression that would match all emoji characters\n     * Source: https-colon-slashslash www.regextester.com/106421\n     */\n    var emojiStr = /\\u00a9\\u00ae\\u2000-\\u3300\\ud83c\\ud000-\\udfff\\ud83d\\ud000-\\udfff\\ud83e\\ud000-\\udfff/\n        .source;\n    /**\n     * The string form of a regular expression that would match all of the\n     * combining mark characters in the unicode character set when placed in a\n     * RegExp character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines `\\p{M}`\n     * escape (\"all marks\").\n     *\n     * Taken from the XRegExp library: http-colon-slashslash xregexp.com/ (thanks @https-colon-slashslash github.com/slevithan)\n     * Specifically: http-colon-slashslash xregexp.com/v/3.2.0/xregexp-all.js, the 'Mark'\n     *   regex's bmp\n     *\n     * VERY IMPORTANT: This set of characters is defined inside of a Regular\n     *   Expression literal rather than a string literal to prevent UglifyJS from\n     *   compressing the unicode escape sequences into their actual unicode\n     *   characters. If Uglify compresses these into the unicode characters\n     *   themselves, this results in the error \"Range out of order in character\n     *   class\" when these characters are used inside of a Regular Expression\n     *   character class (`[]`). See usages of this const. Alternatively, we can set\n     *   the UglifyJS option `ascii_only` to true for the build, but that doesn't\n     *   help others who are pulling in Autolinker into their own build and running\n     *   UglifyJS themselves.\n     */\n    var marksStr = /\\u0300-\\u036F\\u0483-\\u0489\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0859-\\u085B\\u08D4-\\u08E1\\u08E3-\\u0903\\u093A-\\u093C\\u093E-\\u094F\\u0951-\\u0957\\u0962\\u0963\\u0981-\\u0983\\u09BC\\u09BE-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CD\\u09D7\\u09E2\\u09E3\\u0A01-\\u0A03\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81-\\u0A83\\u0ABC\\u0ABE-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AE2\\u0AE3\\u0B01-\\u0B03\\u0B3C\\u0B3E-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B62\\u0B63\\u0B82\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD7\\u0C00-\\u0C03\\u0C3E-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0C81-\\u0C83\\u0CBC\\u0CBE-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CE2\\u0CE3\\u0D01-\\u0D03\\u0D3E-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4D\\u0D57\\u0D62\\u0D63\\u0D82\\u0D83\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DF2\\u0DF3\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EB9\\u0EBB\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F71-\\u0F84\\u0F86\\u0F87\\u0F8D-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u102B-\\u103E\\u1056-\\u1059\\u105E-\\u1060\\u1062-\\u1064\\u1067-\\u106D\\u1071-\\u1074\\u1082-\\u108D\\u108F\\u109A-\\u109D\\u135D-\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17B4-\\u17D3\\u17DD\\u180B-\\u180D\\u1885\\u1886\\u18A9\\u1920-\\u192B\\u1930-\\u193B\\u1A17-\\u1A1B\\u1A55-\\u1A5E\\u1A60-\\u1A7C\\u1A7F\\u1AB0-\\u1ABE\\u1B00-\\u1B04\\u1B34-\\u1B44\\u1B6B-\\u1B73\\u1B80-\\u1B82\\u1BA1-\\u1BAD\\u1BE6-\\u1BF3\\u1C24-\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE8\\u1CED\\u1CF2-\\u1CF4\\u1CF8\\u1CF9\\u1DC0-\\u1DF5\\u1DFB-\\u1DFF\\u20D0-\\u20F0\\u2CEF-\\u2CF1\\u2D7F\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3099\\u309A\\uA66F-\\uA672\\uA674-\\uA67D\\uA69E\\uA69F\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA823-\\uA827\\uA880\\uA881\\uA8B4-\\uA8C5\\uA8E0-\\uA8F1\\uA926-\\uA92D\\uA947-\\uA953\\uA980-\\uA983\\uA9B3-\\uA9C0\\uA9E5\\uAA29-\\uAA36\\uAA43\\uAA4C\\uAA4D\\uAA7B-\\uAA7D\\uAAB0\\uAAB2-\\uAAB4\\uAAB7\\uAAB8\\uAABE\\uAABF\\uAAC1\\uAAEB-\\uAAEF\\uAAF5\\uAAF6\\uABE3-\\uABEA\\uABEC\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE2F/\n        .source; // see note in above variable description\n    /**\n     * The string form of a regular expression that would match all of the\n     * alphabetic (\"letter\") chars, emoji, and combining marks in the unicode character set\n     * when placed in a RegExp character class (`[]`). This includes all\n     * international alphabetic characters.\n     *\n     * These would be the characters matched by unicode regex engines `\\p{L}\\p{M}`\n     * escapes and emoji characters.\n     */\n    var alphaCharsAndMarksStr = alphaCharsStr + emojiStr + marksStr;\n    /**\n     * The string form of a regular expression that would match all of the\n     * decimal number chars in the unicode character set when placed in a RegExp\n     * character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines `\\p{Nd}`\n     * escape (\"all decimal numbers\")\n     *\n     * Taken from the XRegExp library: http-colon-slashslash xregexp.com/ (thanks @https-colon-slashslash github.com/slevithan)\n     * Specifically: http-colon-slashslash xregexp.com/v/3.2.0/xregexp-all.js, the 'Decimal_Number'\n     *   regex's bmp\n     *\n     * VERY IMPORTANT: This set of characters is defined inside of a Regular\n     *   Expression literal rather than a string literal to prevent UglifyJS from\n     *   compressing the unicode escape sequences into their actual unicode\n     *   characters. If Uglify compresses these into the unicode characters\n     *   themselves, this results in the error \"Range out of order in character\n     *   class\" when these characters are used inside of a Regular Expression\n     *   character class (`[]`). See usages of this const. Alternatively, we can set\n     *   the UglifyJS option `ascii_only` to true for the build, but that doesn't\n     *   help others who are pulling in Autolinker into their own build and running\n     *   UglifyJS themselves.\n     */\n    var decimalNumbersStr = /0-9\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0BE6-\\u0BEF\\u0C66-\\u0C6F\\u0CE6-\\u0CEF\\u0D66-\\u0D6F\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F29\\u1040-\\u1049\\u1090-\\u1099\\u17E0-\\u17E9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19D9\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\uA620-\\uA629\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19/\n        .source; // see note in above variable description\n    /**\n     * The string form of a regular expression that would match all of the\n     * letters and decimal number chars in the unicode character set when placed in\n     * a RegExp character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines\n     * `[\\p{L}\\p{Nd}]` escape (\"all letters and decimal numbers\")\n     */\n    var alphaNumericCharsStr = alphaCharsAndMarksStr + decimalNumbersStr;\n    /**\n     * The string form of a regular expression that would match all of the\n     * letters, combining marks, and decimal number chars in the unicode character\n     * set when placed in a RegExp character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines\n     * `[\\p{L}\\p{M}\\p{Nd}]` escape (\"all letters, combining marks, and decimal\n     * numbers\")\n     */\n    var alphaNumericAndMarksCharsStr = alphaCharsAndMarksStr + decimalNumbersStr;\n    // Simplified IP regular expression\n    var ipStr = '(?:[' + decimalNumbersStr + ']{1,3}\\\\.){3}[' + decimalNumbersStr + ']{1,3}';\n    // Protected domain label which do not allow \"-\" character on the beginning and the end of a single label\n    var domainLabelStr = '[' + alphaNumericAndMarksCharsStr + '](?:[' + alphaNumericAndMarksCharsStr + '\\\\-]{0,61}[' + alphaNumericAndMarksCharsStr + '])?';\n    var getDomainLabelStr = function (group) {\n        return '(?=(' + domainLabelStr + '))\\\\' + group;\n    };\n    /**\n     * A function to match domain names of a URL or email address.\n     * Ex: 'google', 'yahoo', 'some-other-company', etc.\n     */\n    var getDomainNameStr = function (group) {\n        return '(?:' + getDomainLabelStr(group) + '(?:\\\\.' + getDomainLabelStr(group + 1) + '){0,126}|' + ipStr + ')';\n    };\n    /**\n     * A regular expression that is simply the character class of the characters\n     * that may be used in a domain name, minus the '-' or '.'\n     */\n    var domainNameCharRegex = new RegExp(\"[\" + alphaNumericAndMarksCharsStr + \"]\");\n\n    // NOTE: THIS IS A GENERATED FILE\n    // To update with the latest TLD list, run `npm run update-tld-regex` or `yarn update-tld-regex` (depending on which you have installed)\n    var tldRegex = /(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|vermgensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|vermgensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|spreadbetting|travelchannel|wolterskluwer|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|rightathome|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pbt977c|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b||accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nationwide|newholland|nextdirect|onyourside|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|telefonica|university|vistaprint|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|fujixerox|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|honeywell|institute|insurance|kuokgroup|ladbrokes|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--tckwe|xn--vhquv|yodobashi|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|chrysler|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|esurance|etisalat|everbank|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|movistar|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|symantec|training|uconnect|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama||abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|cartier|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|iselect|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lancome|lanxess|lasalle|latrobe|leclerc|liaison|limited|lincoln|markets|metlife|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|shriram|singles|staples|starhub|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|||||||||abarth|abbott|abbvie|active|africa|agency|airbus|airtel|alipay|alsace|alstom|anquan|aramco|author|bayern|beauty|berlin|bharti|blanco|bostik|boston|broker|camera|career|caseih|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|mobily|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|piaget|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|warman|webcam|xihuan|yachts|yandex|zappos|||||||||||||actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|dodge|drive|dubai|earth|edeka|email|epost|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|intel|irish|iveco|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|lupin|macys|mango|media|miami|money|mopar|movie|nadex|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|zippo|||||||||||||aarp|able|adac|aero|aigo|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|doha|duck|duns|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scor|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone||||||||||||||||||||||||||aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bnl|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceb|ceo|cfa|cfd|com|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jcp|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|srl|srt|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip||||||||||||||||||||||||||||||ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||)/;\n\n    // For debugging: search for other \"For debugging\" lines\n    // import CliTable from 'cli-table';\n    /**\n     * @class Autolinker.matcher.Email\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find email matches in an input string.\n     *\n     * See this class's superclass ({@link Autolinker.matcher.Matcher}) for more details.\n     */\n    var EmailMatcher = /** @class */ (function (_super) {\n        __extends(EmailMatcher, _super);\n        function EmailMatcher() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            /**\n             * Valid characters that can be used in the \"local\" part of an email address,\n             * i.e. the \"name\" part of \"name@site.com\"\n             */\n            _this.localPartCharRegex = new RegExp(\"[\" + alphaNumericAndMarksCharsStr + \"!#$%&'*+/=?^_`{|}~-]\");\n            /**\n             * Stricter TLD regex which adds a beginning and end check to ensure\n             * the string is a valid TLD\n             */\n            _this.strictTldRegex = new RegExp(\"^\" + tldRegex.source + \"$\");\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        EmailMatcher.prototype.parseMatches = function (text) {\n            var tagBuilder = this.tagBuilder, localPartCharRegex = this.localPartCharRegex, strictTldRegex = this.strictTldRegex, matches = [], len = text.length, noCurrentEmailMatch = new CurrentEmailMatch();\n            // for matching a 'mailto:' prefix\n            var mailtoTransitions = {\n                'm': 'a',\n                'a': 'i',\n                'i': 'l',\n                'l': 't',\n                't': 'o',\n                'o': ':',\n            };\n            var charIdx = 0, state = 0 /* NonEmailMatch */, currentEmailMatch = noCurrentEmailMatch;\n            // For debugging: search for other \"For debugging\" lines\n            // const table = new CliTable( {\n            // \thead: [ 'charIdx', 'char', 'state', 'charIdx', 'currentEmailAddress.idx', 'hasDomainDot' ]\n            // } );\n            while (charIdx < len) {\n                var char = text.charAt(charIdx);\n                // For debugging: search for other \"For debugging\" lines\n                // table.push(\n                // \t[ charIdx, char, State[ state ], charIdx, currentEmailAddress.idx, currentEmailAddress.hasDomainDot ]\n                // );\n                switch (state) {\n                    case 0 /* NonEmailMatch */:\n                        stateNonEmailAddress(char);\n                        break;\n                    case 1 /* Mailto */:\n                        stateMailTo(text.charAt(charIdx - 1), char);\n                        break;\n                    case 2 /* LocalPart */:\n                        stateLocalPart(char);\n                        break;\n                    case 3 /* LocalPartDot */:\n                        stateLocalPartDot(char);\n                        break;\n                    case 4 /* AtSign */:\n                        stateAtSign(char);\n                        break;\n                    case 5 /* DomainChar */:\n                        stateDomainChar(char);\n                        break;\n                    case 6 /* DomainHyphen */:\n                        stateDomainHyphen(char);\n                        break;\n                    case 7 /* DomainDot */:\n                        stateDomainDot(char);\n                        break;\n                    default:\n                        throwUnhandledCaseError(state);\n                }\n                // For debugging: search for other \"For debugging\" lines\n                // table.push(\n                // \t[ charIdx, char, State[ state ], charIdx, currentEmailAddress.idx, currentEmailAddress.hasDomainDot ]\n                // );\n                charIdx++;\n            }\n            // Capture any valid match at the end of the string\n            captureMatchIfValidAndReset();\n            // For debugging: search for other \"For debugging\" lines\n            //console.log( '\\n' + table.toString() );\n            return matches;\n            // Handles the state when we're not in an email address\n            function stateNonEmailAddress(char) {\n                if (char === 'm') {\n                    beginEmailMatch(1 /* Mailto */);\n                }\n                else if (localPartCharRegex.test(char)) {\n                    beginEmailMatch();\n                }\n            }\n            // Handles if we're reading a 'mailto:' prefix on the string\n            function stateMailTo(prevChar, char) {\n                if (prevChar === ':') {\n                    // We've reached the end of the 'mailto:' prefix\n                    if (localPartCharRegex.test(char)) {\n                        state = 2 /* LocalPart */;\n                        currentEmailMatch = new CurrentEmailMatch(__assign({}, currentEmailMatch, { hasMailtoPrefix: true }));\n                    }\n                    else {\n                        // we've matched 'mailto:' but didn't get anything meaningful\n                        // immediately afterwards (for example, we encountered a\n                        // space character, or an '@' character which formed 'mailto:@'\n                        resetToNonEmailMatchState();\n                    }\n                }\n                else if (mailtoTransitions[prevChar] === char) ;\n                else if (localPartCharRegex.test(char)) {\n                    // We we're reading a prefix of 'mailto:', but encountered a\n                    // different character that didn't continue the prefix\n                    state = 2 /* LocalPart */;\n                }\n                else if (char === '.') {\n                    // We we're reading a prefix of 'mailto:', but encountered a\n                    // dot character\n                    state = 3 /* LocalPartDot */;\n                }\n                else if (char === '@') {\n                    // We we're reading a prefix of 'mailto:', but encountered a\n                    // an @ character\n                    state = 4 /* AtSign */;\n                }\n                else {\n                    // not an email address character, return to \"NonEmailAddress\" state\n                    resetToNonEmailMatchState();\n                }\n            }\n            // Handles the state when we're currently in the \"local part\" of an\n            // email address (as opposed to the \"domain part\")\n            function stateLocalPart(char) {\n                if (char === '.') {\n                    state = 3 /* LocalPartDot */;\n                }\n                else if (char === '@') {\n                    state = 4 /* AtSign */;\n                }\n                else if (localPartCharRegex.test(char)) ;\n                else {\n                    // not an email address character, return to \"NonEmailAddress\" state\n                    resetToNonEmailMatchState();\n                }\n            }\n            // Handles the state where we've read\n            function stateLocalPartDot(char) {\n                if (char === '.') {\n                    // We read a second '.' in a row, not a valid email address\n                    // local part\n                    resetToNonEmailMatchState();\n                }\n                else if (char === '@') {\n                    // We read the '@' character immediately after a dot ('.'), not\n                    // an email address\n                    resetToNonEmailMatchState();\n                }\n                else if (localPartCharRegex.test(char)) {\n                    state = 2 /* LocalPart */;\n                }\n                else {\n                    // Anything else, not an email address\n                    resetToNonEmailMatchState();\n                }\n            }\n            function stateAtSign(char) {\n                if (domainNameCharRegex.test(char)) {\n                    state = 5 /* DomainChar */;\n                }\n                else {\n                    // Anything else, not an email address\n                    resetToNonEmailMatchState();\n                }\n            }\n            function stateDomainChar(char) {\n                if (char === '.') {\n                    state = 7 /* DomainDot */;\n                }\n                else if (char === '-') {\n                    state = 6 /* DomainHyphen */;\n                }\n                else if (domainNameCharRegex.test(char)) ;\n                else {\n                    // Anything else, we potentially matched if the criteria has\n                    // been met\n                    captureMatchIfValidAndReset();\n                }\n            }\n            function stateDomainHyphen(char) {\n                if (char === '-' || char === '.') {\n                    // Not valid to have two hyphens (\"--\") or hypen+dot (\"-.\")\n                    captureMatchIfValidAndReset();\n                }\n                else if (domainNameCharRegex.test(char)) {\n                    state = 5 /* DomainChar */;\n                }\n                else {\n                    // Anything else\n                    captureMatchIfValidAndReset();\n                }\n            }\n            function stateDomainDot(char) {\n                if (char === '.' || char === '-') {\n                    // not valid to have two dots (\"..\") or dot+hypen (\".-\")\n                    captureMatchIfValidAndReset();\n                }\n                else if (domainNameCharRegex.test(char)) {\n                    state = 5 /* DomainChar */;\n                    // After having read a '.' and then a valid domain character,\n                    // we now know that the domain part of the email is valid, and\n                    // we have found at least a partial EmailMatch (however, the\n                    // email address may have additional characters from this point)\n                    currentEmailMatch = new CurrentEmailMatch(__assign({}, currentEmailMatch, { hasDomainDot: true }));\n                }\n                else {\n                    // Anything else\n                    captureMatchIfValidAndReset();\n                }\n            }\n            function beginEmailMatch(newState) {\n                if (newState === void 0) { newState = 2 /* LocalPart */; }\n                state = newState;\n                currentEmailMatch = new CurrentEmailMatch({ idx: charIdx });\n            }\n            function resetToNonEmailMatchState() {\n                state = 0 /* NonEmailMatch */;\n                currentEmailMatch = noCurrentEmailMatch;\n            }\n            /*\n             * Captures the current email address as an EmailMatch if it's valid,\n             * and resets the state to read another email address.\n             */\n            function captureMatchIfValidAndReset() {\n                if (currentEmailMatch.hasDomainDot) { // we need at least one dot in the domain to be considered a valid email address\n                    var matchedText = text.slice(currentEmailMatch.idx, charIdx);\n                    // If we read a '.' or '-' char that ended the email address\n                    // (valid domain name characters, but only valid email address\n                    // characters if they are followed by something else), strip\n                    // it off now\n                    if (/[-.]$/.test(matchedText)) {\n                        matchedText = matchedText.slice(0, -1);\n                    }\n                    var emailAddress = currentEmailMatch.hasMailtoPrefix\n                        ? matchedText.slice('mailto:'.length)\n                        : matchedText;\n                    // if the email address has a valid TLD, add it to the list of matches\n                    if (doesEmailHaveValidTld(emailAddress)) {\n                        matches.push(new EmailMatch({\n                            tagBuilder: tagBuilder,\n                            matchedText: matchedText,\n                            offset: currentEmailMatch.idx,\n                            email: emailAddress\n                        }));\n                    }\n                }\n                resetToNonEmailMatchState();\n                /**\n                 * Determines if the given email address has a valid TLD or not\n                 * @param {string} emailAddress - email address\n                 * @return {Boolean} - true is email have valid TLD, false otherwise\n                 */\n                function doesEmailHaveValidTld(emailAddress) {\n                    var emailAddressTld = emailAddress.split('.').pop() || '';\n                    var emailAddressNormalized = emailAddressTld.toLowerCase();\n                    var isValidTld = strictTldRegex.test(emailAddressNormalized);\n                    return isValidTld;\n                }\n            }\n        };\n        return EmailMatcher;\n    }(Matcher));\n    var CurrentEmailMatch = /** @class */ (function () {\n        function CurrentEmailMatch(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            this.idx = cfg.idx !== undefined ? cfg.idx : -1;\n            this.hasMailtoPrefix = !!cfg.hasMailtoPrefix;\n            this.hasDomainDot = !!cfg.hasDomainDot;\n        }\n        return CurrentEmailMatch;\n    }());\n\n    /**\n     * @private\n     * @class Autolinker.matcher.UrlMatchValidator\n     * @singleton\n     *\n     * Used by Autolinker to filter out false URL positives from the\n     * {@link Autolinker.matcher.Url UrlMatcher}.\n     *\n     * Due to the limitations of regular expressions (including the missing feature\n     * of look-behinds in JS regular expressions), we cannot always determine the\n     * validity of a given match. This class applies a bit of additional logic to\n     * filter out any false positives that have been matched by the\n     * {@link Autolinker.matcher.Url UrlMatcher}.\n     */\n    var UrlMatchValidator = /** @class */ (function () {\n        function UrlMatchValidator() {\n        }\n        /**\n         * Determines if a given URL match found by the {@link Autolinker.matcher.Url UrlMatcher}\n         * is valid. Will return `false` for:\n         *\n         * 1) URL matches which do not have at least have one period ('.') in the\n         *    domain name (effectively skipping over matches like \"abc:def\").\n         *    However, URL matches with a protocol will be allowed (ex: 'http-colon-slashslash localhost')\n         * 2) URL matches which do not have at least one word character in the\n         *    domain name (effectively skipping over matches like \"git:1.0\").\n         * 3) A protocol-relative url match (a URL beginning with '//') whose\n         *    previous character is a word character (effectively skipping over\n         *    strings like \"abc//google.com\")\n         *\n         * Otherwise, returns `true`.\n         *\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} protocolUrlMatch The match URL string for a protocol\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to match something like\n         *   'http-colon-slashslash localhost', where we won't double check that the domain name\n         *   has at least one '.' in it.\n         * @return {Boolean} `true` if the match given is valid and should be\n         *   processed, or `false` if the match is invalid and/or should just not be\n         *   processed.\n         */\n        UrlMatchValidator.isValid = function (urlMatch, protocolUrlMatch) {\n            if ((protocolUrlMatch && !this.isValidUriScheme(protocolUrlMatch)) ||\n                this.urlMatchDoesNotHaveProtocolOrDot(urlMatch, protocolUrlMatch) || // At least one period ('.') must exist in the URL match for us to consider it an actual URL, *unless* it was a full protocol match (like 'http://localhost')\n                (this.urlMatchDoesNotHaveAtLeastOneWordChar(urlMatch, protocolUrlMatch) && // At least one letter character must exist in the domain name after a protocol match. Ex: skip over something like \"git:1.0\"\n                    !this.isValidIpAddress(urlMatch)) || // Except if it's an IP address\n                this.containsMultipleDots(urlMatch)) {\n                return false;\n            }\n            return true;\n        };\n        UrlMatchValidator.isValidIpAddress = function (uriSchemeMatch) {\n            var newRegex = new RegExp(this.hasFullProtocolRegex.source + this.ipRegex.source);\n            var uriScheme = uriSchemeMatch.match(newRegex);\n            return uriScheme !== null;\n        };\n        UrlMatchValidator.containsMultipleDots = function (urlMatch) {\n            var stringBeforeSlash = urlMatch;\n            if (this.hasFullProtocolRegex.test(urlMatch)) {\n                stringBeforeSlash = urlMatch.split('://')[1];\n            }\n            return stringBeforeSlash.split('/')[0].indexOf(\"..\") > -1;\n        };\n        /**\n         * Determines if the URI scheme is a valid scheme to be autolinked. Returns\n         * `false` if the scheme is 'javascript:' or 'vbscript:'\n         *\n         * @private\n         * @param {String} uriSchemeMatch The match URL string for a full URI scheme\n         *   match. Ex: 'http-colon-slashslash yahoo.com' or 'mailto:a@a.com'.\n         * @return {Boolean} `true` if the scheme is a valid one, `false` otherwise.\n         */\n        UrlMatchValidator.isValidUriScheme = function (uriSchemeMatch) {\n            var uriSchemeMatchArr = uriSchemeMatch.match(this.uriSchemeRegex), uriScheme = uriSchemeMatchArr && uriSchemeMatchArr[0].toLowerCase();\n            return (uriScheme !== 'javascript:' && uriScheme !== 'vbscript:');\n        };\n        /**\n         * Determines if a URL match does not have either:\n         *\n         * a) a full protocol (i.e. 'http-colon-slashslash '), or\n         * b) at least one dot ('.') in the domain name (for a non-full-protocol\n         *    match).\n         *\n         * Either situation is considered an invalid URL (ex: 'git:d' does not have\n         * either the '://' part, or at least one dot in the domain name. If the\n         * match was 'git:abc.com', we would consider this valid.)\n         *\n         * @private\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} protocolUrlMatch The match URL string for a protocol\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to match something like\n         *   'http-colon-slashslash localhost', where we won't double check that the domain name\n         *   has at least one '.' in it.\n         * @return {Boolean} `true` if the URL match does not have a full protocol,\n         *   or at least one dot ('.') in a non-full-protocol match.\n         */\n        UrlMatchValidator.urlMatchDoesNotHaveProtocolOrDot = function (urlMatch, protocolUrlMatch) {\n            return (!!urlMatch && (!protocolUrlMatch || !this.hasFullProtocolRegex.test(protocolUrlMatch)) && urlMatch.indexOf('.') === -1);\n        };\n        /**\n         * Determines if a URL match does not have at least one word character after\n         * the protocol (i.e. in the domain name).\n         *\n         * At least one letter character must exist in the domain name after a\n         * protocol match. Ex: skip over something like \"git:1.0\"\n         *\n         * @private\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} protocolUrlMatch The match URL string for a protocol\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to know whether or not we\n         *   have a protocol in the URL string, in order to check for a word\n         *   character after the protocol separator (':').\n         * @return {Boolean} `true` if the URL match does not have at least one word\n         *   character in it after the protocol, `false` otherwise.\n         */\n        UrlMatchValidator.urlMatchDoesNotHaveAtLeastOneWordChar = function (urlMatch, protocolUrlMatch) {\n            if (urlMatch && protocolUrlMatch) {\n                return !this.hasWordCharAfterProtocolRegex.test(urlMatch);\n            }\n            else {\n                return false;\n            }\n        };\n        /**\n         * Regex to test for a full protocol, with the two trailing slashes. Ex: 'http-colon-slashslash '\n         *\n         * @private\n         * @property {RegExp} hasFullProtocolRegex\n         */\n        UrlMatchValidator.hasFullProtocolRegex = /^[A-Za-z][-.+A-Za-z0-9]*:\\/\\//;\n        /**\n         * Regex to find the URI scheme, such as 'mailto:'.\n         *\n         * This is used to filter out 'javascript:' and 'vbscript:' schemes.\n         *\n         * @private\n         * @property {RegExp} uriSchemeRegex\n         */\n        UrlMatchValidator.uriSchemeRegex = /^[A-Za-z][-.+A-Za-z0-9]*:/;\n        /**\n         * Regex to determine if at least one word char exists after the protocol (i.e. after the ':')\n         *\n         * @private\n         * @property {RegExp} hasWordCharAfterProtocolRegex\n         */\n        UrlMatchValidator.hasWordCharAfterProtocolRegex = new RegExp(\":[^\\\\s]*?[\" + alphaCharsStr + \"]\");\n        /**\n         * Regex to determine if the string is a valid IP address\n         *\n         * @private\n         * @property {RegExp} ipRegex\n         */\n        UrlMatchValidator.ipRegex = /[0-9][0-9]?[0-9]?\\.[0-9][0-9]?[0-9]?\\.[0-9][0-9]?[0-9]?\\.[0-9][0-9]?[0-9]?(:[0-9]*)?\\/?$/;\n        return UrlMatchValidator;\n    }());\n\n    /**\n     * @class Autolinker.matcher.Url\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find URL matches in an input string.\n     *\n     * See this class's superclass ({@link Autolinker.matcher.Matcher}) for more details.\n     */\n    var UrlMatcher = /** @class */ (function (_super) {\n        __extends(UrlMatcher, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match instance,\n         *   specified in an Object (map).\n         */\n        function UrlMatcher(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {Object} stripPrefix (required)\n             *\n             * The Object form of {@link Autolinker#cfg-stripPrefix}.\n             */\n            _this.stripPrefix = { scheme: true, www: true }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} stripTrailingSlash (required)\n             * @inheritdoc Autolinker#stripTrailingSlash\n             */\n            _this.stripTrailingSlash = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} decodePercentEncoding (required)\n             * @inheritdoc Autolinker#decodePercentEncoding\n             */\n            _this.decodePercentEncoding = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @protected\n             * @property {RegExp} matcherRegex\n             *\n             * The regular expression to match URLs with an optional scheme, port\n             * number, path, query string, and hash anchor.\n             *\n             * Example matches:\n             *\n             *     http-colon-slashslash google.com\n             *     www.google.com\n             *     google.com/path/to/file?q1=1&q2=2#myAnchor\n             *\n             *\n             * This regular expression will have the following capturing groups:\n             *\n             * 1.  Group that matches a scheme-prefixed URL (i.e. 'http-colon-slashslash google.com').\n             *     This is used to match scheme URLs with just a single word, such as\n             *     'http-colon-slashslash localhost', where we won't double check that the domain name\n             *     has at least one dot ('.') in it.\n             * 2.  Group that matches a 'www.' prefixed URL. This is only matched if the\n             *     'www.' text was not prefixed by a scheme (i.e.: not prefixed by\n             *     'http-colon-slashslash ', 'ftp:', etc.)\n             * 3.  A protocol-relative ('//') match for the case of a 'www.' prefixed\n             *     URL. Will be an empty string if it is not a protocol-relative match.\n             *     We need to know the character before the '//' in order to determine\n             *     if it is a valid match or the // was in a string we don't want to\n             *     auto-link.\n             * 4.  Group that matches a known TLD (top level domain), when a scheme\n             *     or 'www.'-prefixed domain is not matched.\n             * 5.  A protocol-relative ('//') match for the case of a known TLD prefixed\n             *     URL. Will be an empty string if it is not a protocol-relative match.\n             *     See #3 for more info.\n             */\n            _this.matcherRegex = (function () {\n                var schemeRegex = /(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\\/\\/)(?!\\d+\\/?)(?:\\/\\/)?)/, // match protocol, allow in format \"http://\" or \"mailto:\". However, do not match the first part of something like 'link:http://www.google.com' (i.e. don't match \"link:\"). Also, make sure we don't interpret 'google.com:8000' as if 'google.com' was a protocol here (i.e. ignore a trailing port number in this regex)\n                wwwRegex = /(?:www\\.)/, // starting with 'www.'\n                // Allow optional path, query string, and hash anchor, not ending in the following characters: \"?!:,.;\"\n                // http://blog.codinghorror.com/the-problem-with-urls/\n                urlSuffixRegex = new RegExp('[/?#](?:[' + alphaNumericAndMarksCharsStr + '\\\\-+&@#/%=~_()|\\'$*\\\\[\\\\]?!:,.;\\u2713]*[' + alphaNumericAndMarksCharsStr + '\\\\-+&@#/%=~_()|\\'$*\\\\[\\\\]\\u2713])?');\n                return new RegExp([\n                    '(?:',\n                    '(',\n                    schemeRegex.source,\n                    getDomainNameStr(2),\n                    ')',\n                    '|',\n                    '(',\n                    '(//)?',\n                    wwwRegex.source,\n                    getDomainNameStr(6),\n                    ')',\n                    '|',\n                    '(',\n                    '(//)?',\n                    getDomainNameStr(10) + '\\\\.',\n                    tldRegex.source,\n                    '(?![-' + alphaNumericCharsStr + '])',\n                    ')',\n                    ')',\n                    '(?::[0-9]+)?',\n                    '(?:' + urlSuffixRegex.source + ')?' // match for path, query string, and/or hash anchor - optional\n                ].join(\"\"), 'gi');\n            })();\n            /**\n             * A regular expression to use to check the character before a protocol-relative\n             * URL match. We don't want to match a protocol-relative URL if it is part\n             * of another word.\n             *\n             * For example, we want to match something like \"Go to: //google.com\",\n             * but we don't want to match something like \"abc//google.com\"\n             *\n             * This regular expression is used to test the character before the '//'.\n             *\n             * @protected\n             * @type {RegExp} wordCharRegExp\n             */\n            _this.wordCharRegExp = new RegExp('[' + alphaNumericAndMarksCharsStr + ']');\n            _this.stripPrefix = cfg.stripPrefix;\n            _this.stripTrailingSlash = cfg.stripTrailingSlash;\n            _this.decodePercentEncoding = cfg.decodePercentEncoding;\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        UrlMatcher.prototype.parseMatches = function (text) {\n            var matcherRegex = this.matcherRegex, stripPrefix = this.stripPrefix, stripTrailingSlash = this.stripTrailingSlash, decodePercentEncoding = this.decodePercentEncoding, tagBuilder = this.tagBuilder, matches = [], match;\n            var _loop_1 = function () {\n                var matchStr = match[0], schemeUrlMatch = match[1], wwwUrlMatch = match[4], wwwProtocolRelativeMatch = match[5],\n                //tldUrlMatch = match[ 8 ],  -- not needed at the moment\n                tldProtocolRelativeMatch = match[9], offset = match.index, protocolRelativeMatch = wwwProtocolRelativeMatch || tldProtocolRelativeMatch, prevChar = text.charAt(offset - 1);\n                if (!UrlMatchValidator.isValid(matchStr, schemeUrlMatch)) {\n                    return \"continue\";\n                }\n                // If the match is preceded by an '@' character, then it is either\n                // an email address or a username. Skip these types of matches.\n                if (offset > 0 && prevChar === '@') {\n                    return \"continue\";\n                }\n                // If it's a protocol-relative '//' match, but the character before the '//'\n                // was a word character (i.e. a letter/number), then we found the '//' in the\n                // middle of another word (such as \"asdf//asdf.com\"). In this case, skip the\n                // match.\n                if (offset > 0 && protocolRelativeMatch && this_1.wordCharRegExp.test(prevChar)) {\n                    return \"continue\";\n                }\n                // If the URL ends with a question mark, don't include the question\n                // mark as part of the URL. We'll assume the question mark was the\n                // end of a sentence, such as: \"Going to google.com?\"\n                if (/\\?$/.test(matchStr)) {\n                    matchStr = matchStr.substr(0, matchStr.length - 1);\n                }\n                // Handle a closing parenthesis or square bracket at the end of the\n                // match, and exclude it if there is not a matching open parenthesis\n                // or square bracket in the match itself.\n                if (this_1.matchHasUnbalancedClosingParen(matchStr)) {\n                    matchStr = matchStr.substr(0, matchStr.length - 1); // remove the trailing \")\"\n                }\n                else {\n                    // Handle an invalid character after the TLD\n                    var pos = this_1.matchHasInvalidCharAfterTld(matchStr, schemeUrlMatch);\n                    if (pos > -1) {\n                        matchStr = matchStr.substr(0, pos); // remove the trailing invalid chars\n                    }\n                }\n                // The autolinker accepts many characters in a url's scheme (like `fake://test.com`).\n                // However, in cases where a URL is missing whitespace before an obvious link,\n                // (for example: `nowhitespacehttp://www.test.com`), we only want the match to start\n                // at the http:// part. We will check if the match contains a common scheme and then\n                // shift the match to start from there.\n                var foundCommonScheme = ['http://', 'https://'].find(function (commonScheme) { return !!schemeUrlMatch && schemeUrlMatch.indexOf(commonScheme) !== -1; });\n                if (foundCommonScheme) {\n                    // If we found an overmatched URL, we want to find the index\n                    // of where the match should start and shift the match to\n                    // start from the beginning of the common scheme\n                    var indexOfSchemeStart = matchStr.indexOf(foundCommonScheme);\n                    matchStr = matchStr.substr(indexOfSchemeStart);\n                    schemeUrlMatch = schemeUrlMatch.substr(indexOfSchemeStart);\n                    offset = offset + indexOfSchemeStart;\n                }\n                var urlMatchType = schemeUrlMatch ? 'scheme' : (wwwUrlMatch ? 'www' : 'tld'), protocolUrlMatch = !!schemeUrlMatch;\n                matches.push(new UrlMatch({\n                    tagBuilder: tagBuilder,\n                    matchedText: matchStr,\n                    offset: offset,\n                    urlMatchType: urlMatchType,\n                    url: matchStr,\n                    protocolUrlMatch: protocolUrlMatch,\n                    protocolRelativeMatch: !!protocolRelativeMatch,\n                    stripPrefix: stripPrefix,\n                    stripTrailingSlash: stripTrailingSlash,\n                    decodePercentEncoding: decodePercentEncoding,\n                }));\n            };\n            var this_1 = this;\n            while ((match = matcherRegex.exec(text)) !== null) {\n                _loop_1();\n            }\n            return matches;\n        };\n        /**\n         * Determines if a match found has an unmatched closing parenthesis or\n         * square bracket. If so, the parenthesis or square bracket will be removed\n         * from the match itself, and appended after the generated anchor tag.\n         *\n         * A match may have an extra closing parenthesis at the end of the match\n         * because the regular expression must include parenthesis for URLs such as\n         * \"wikipedia.com/something_(disambiguation)\", which should be auto-linked.\n         *\n         * However, an extra parenthesis *will* be included when the URL itself is\n         * wrapped in parenthesis, such as in the case of:\n         *     \"(wikipedia.com/something_(disambiguation))\"\n         * In this case, the last closing parenthesis should *not* be part of the\n         * URL itself, and this method will return `true`.\n         *\n         * For square brackets in URLs such as in PHP arrays, the same behavior as\n         * parenthesis discussed above should happen:\n         *     \"[http-colon-slashslash www.example.com/foo.php?bar[]=1&bar[]=2&bar[]=3]\"\n         * The closing square bracket should not be part of the URL itself, and this\n         * method will return `true`.\n         *\n         * @protected\n         * @param {String} matchStr The full match string from the {@link #matcherRegex}.\n         * @return {Boolean} `true` if there is an unbalanced closing parenthesis or\n         *   square bracket at the end of the `matchStr`, `false` otherwise.\n         */\n        UrlMatcher.prototype.matchHasUnbalancedClosingParen = function (matchStr) {\n            var endChar = matchStr.charAt(matchStr.length - 1);\n            var startChar;\n            if (endChar === ')') {\n                startChar = '(';\n            }\n            else if (endChar === ']') {\n                startChar = '[';\n            }\n            else {\n                return false; // not a close parenthesis or square bracket\n            }\n            // Find if there are the same number of open braces as close braces in\n            // the URL string, minus the last character (which we have already\n            // determined to be either ')' or ']'\n            var numOpenBraces = 0;\n            for (var i = 0, len = matchStr.length - 1; i < len; i++) {\n                var char = matchStr.charAt(i);\n                if (char === startChar) {\n                    numOpenBraces++;\n                }\n                else if (char === endChar) {\n                    numOpenBraces = Math.max(numOpenBraces - 1, 0);\n                }\n            }\n            // If the number of open braces matches the number of close braces in\n            // the URL minus the last character, then the match has *unbalanced*\n            // braces because of the last character. Example of unbalanced braces\n            // from the regex match:\n            //     \"http://example.com?a[]=1]\"\n            if (numOpenBraces === 0) {\n                return true;\n            }\n            return false;\n        };\n        /**\n         * Determine if there's an invalid character after the TLD in a URL. Valid\n         * characters after TLD are ':/?#'. Exclude scheme matched URLs from this\n         * check.\n         *\n         * @protected\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} schemeUrlMatch The match URL string for a scheme\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to match something like\n         *   'http-colon-slashslash localhost', where we won't double check that the domain name\n         *   has at least one '.' in it.\n         * @return {Number} the position where the invalid character was found. If\n         *   no such character was found, returns -1\n         */\n        UrlMatcher.prototype.matchHasInvalidCharAfterTld = function (urlMatch, schemeUrlMatch) {\n            if (!urlMatch) {\n                return -1;\n            }\n            var offset = 0;\n            if (schemeUrlMatch) {\n                offset = urlMatch.indexOf(':');\n                urlMatch = urlMatch.slice(offset);\n            }\n            var re = new RegExp(\"^((.?\\/\\/)?[-.\" + alphaNumericAndMarksCharsStr + \"]*[-\" + alphaNumericAndMarksCharsStr + \"]\\\\.[-\" + alphaNumericAndMarksCharsStr + \"]+)\");\n            var res = re.exec(urlMatch);\n            if (res === null) {\n                return -1;\n            }\n            offset += res[1].length;\n            urlMatch = urlMatch.slice(res[1].length);\n            if (/^[^-.A-Za-z0-9:\\/?#]/.test(urlMatch)) {\n                return offset;\n            }\n            return -1;\n        };\n        return UrlMatcher;\n    }(Matcher));\n\n    /**\n     * @class Autolinker.matcher.Hashtag\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find HashtagMatch matches in an input string.\n     */\n    var HashtagMatcher = /** @class */ (function (_super) {\n        __extends(HashtagMatcher, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match instance,\n         *   specified in an Object (map).\n         */\n        function HashtagMatcher(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} serviceName\n             *\n             * The service to point hashtag matches to. See {@link Autolinker#hashtag}\n             * for available values.\n             */\n            _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * The regular expression to match Hashtags. Example match:\n             *\n             *     #asdf\n             *\n             * @protected\n             * @property {RegExp} matcherRegex\n             */\n            _this.matcherRegex = new RegExp(\"#[_\" + alphaNumericAndMarksCharsStr + \"]{1,139}(?![_\" + alphaNumericAndMarksCharsStr + \"])\", 'g'); // lookahead used to make sure we don't match something above 139 characters\n            /**\n             * The regular expression to use to check the character before a username match to\n             * make sure we didn't accidentally match an email address.\n             *\n             * For example, the string \"asdf@asdf.com\" should not match \"@asdf\" as a username.\n             *\n             * @protected\n             * @property {RegExp} nonWordCharRegex\n             */\n            _this.nonWordCharRegex = new RegExp('[^' + alphaNumericAndMarksCharsStr + ']');\n            _this.serviceName = cfg.serviceName;\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        HashtagMatcher.prototype.parseMatches = function (text) {\n            var matcherRegex = this.matcherRegex, nonWordCharRegex = this.nonWordCharRegex, serviceName = this.serviceName, tagBuilder = this.tagBuilder, matches = [], match;\n            while ((match = matcherRegex.exec(text)) !== null) {\n                var offset = match.index, prevChar = text.charAt(offset - 1);\n                // If we found the match at the beginning of the string, or we found the match\n                // and there is a whitespace char in front of it (meaning it is not a '#' char\n                // in the middle of a word), then it is a hashtag match.\n                if (offset === 0 || nonWordCharRegex.test(prevChar)) {\n                    var matchedText = match[0], hashtag = match[0].slice(1); // strip off the '#' character at the beginning\n                    matches.push(new HashtagMatch({\n                        tagBuilder: tagBuilder,\n                        matchedText: matchedText,\n                        offset: offset,\n                        serviceName: serviceName,\n                        hashtag: hashtag\n                    }));\n                }\n            }\n            return matches;\n        };\n        return HashtagMatcher;\n    }(Matcher));\n\n    /**\n     * @class Autolinker.matcher.Phone\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find Phone number matches in an input string.\n     *\n     * See this class's superclass ({@link Autolinker.matcher.Matcher}) for more\n     * details.\n     */\n    var PhoneMatcher = /** @class */ (function (_super) {\n        __extends(PhoneMatcher, _super);\n        function PhoneMatcher() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            /**\n             * The regular expression to match Phone numbers. Example match:\n             *\n             *     (123) 456-7890\n             *\n             * This regular expression has the following capturing groups:\n             *\n             * 1 or 2. The prefixed '+' sign, if there is one.\n             *\n             * @protected\n             * @property {RegExp} matcherRegex\n             */\n            _this.matcherRegex = /(?:(?:(?:(\\+)?\\d{1,3}[-\\040.]?)?\\(?\\d{3}\\)?[-\\040.]?\\d{3}[-\\040.]?\\d{4})|(?:(\\+)(?:9[976]\\d|8[987530]\\d|6[987]\\d|5[90]\\d|42\\d|3[875]\\d|2[98654321]\\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\\040.]?(?:\\d[-\\040.]?){6,12}\\d+))([,;]+[0-9]+#?)*/g;\n            return _this;\n        }\n        // ex: (123) 456-7890, 123 456 7890, 123-456-7890, +18004441234,,;,10226420346#,\n        // +1 (800) 444 1234, 10226420346#, 1-800-444-1234,1022,64,20346#\n        /**\n         * @inheritdoc\n         */\n        PhoneMatcher.prototype.parseMatches = function (text) {\n            var matcherRegex = this.matcherRegex, tagBuilder = this.tagBuilder, matches = [], match;\n            while ((match = matcherRegex.exec(text)) !== null) {\n                // Remove non-numeric values from phone number string\n                var matchedText = match[0], cleanNumber = matchedText.replace(/[^0-9,;#]/g, ''), // strip out non-digit characters exclude comma semicolon and #\n                plusSign = !!(match[1] || match[2]), // match[ 1 ] or match[ 2 ] is the prefixed plus sign, if there is one\n                before = match.index == 0 ? '' : text.substr(match.index - 1, 1), after = text.substr(match.index + matchedText.length, 1), contextClear = !before.match(/\\d/) && !after.match(/\\d/);\n                if (this.testMatch(match[3]) && this.testMatch(matchedText) && contextClear) {\n                    matches.push(new PhoneMatch({\n                        tagBuilder: tagBuilder,\n                        matchedText: matchedText,\n                        offset: match.index,\n                        number: cleanNumber,\n                        plusSign: plusSign\n                    }));\n                }\n            }\n            return matches;\n        };\n        PhoneMatcher.prototype.testMatch = function (text) {\n            return /\\D/.test(text);\n        };\n        return PhoneMatcher;\n    }(Matcher));\n\n    /**\n     * @class Autolinker.matcher.Mention\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find/replace username matches in an input string.\n     */\n    var MentionMatcher = /** @class */ (function (_super) {\n        __extends(MentionMatcher, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match instance,\n         *   specified in an Object (map).\n         */\n        function MentionMatcher(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {'twitter'/'instagram'/'soundcloud'} protected\n             *\n             * The name of service to link @mentions to.\n             *\n             * Valid values are: 'twitter', 'instagram', or 'soundcloud'\n             */\n            _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * Hash of regular expression to match username handles. Example match:\n             *\n             *     @asdf\n             *\n             * @private\n             * @property {Object} matcherRegexes\n             */\n            _this.matcherRegexes = {\n                'twitter': new RegExp(\"@[_\" + alphaNumericAndMarksCharsStr + \"]{1,50}(?![_\" + alphaNumericAndMarksCharsStr + \"])\", 'g'),\n                'instagram': new RegExp(\"@[_.\" + alphaNumericAndMarksCharsStr + \"]{1,30}(?![_\" + alphaNumericAndMarksCharsStr + \"])\", 'g'),\n                'soundcloud': new RegExp(\"@[-_.\" + alphaNumericAndMarksCharsStr + \"]{1,50}(?![-_\" + alphaNumericAndMarksCharsStr + \"])\", 'g') // lookahead used to make sure we don't match something above 50 characters\n            };\n            /**\n             * The regular expression to use to check the character before a username match to\n             * make sure we didn't accidentally match an email address.\n             *\n             * For example, the string \"asdf@asdf.com\" should not match \"@asdf\" as a username.\n             *\n             * @private\n             * @property {RegExp} nonWordCharRegex\n             */\n            _this.nonWordCharRegex = new RegExp('[^' + alphaNumericAndMarksCharsStr + ']');\n            _this.serviceName = cfg.serviceName;\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        MentionMatcher.prototype.parseMatches = function (text) {\n            var serviceName = this.serviceName, matcherRegex = this.matcherRegexes[this.serviceName], nonWordCharRegex = this.nonWordCharRegex, tagBuilder = this.tagBuilder, matches = [], match;\n            if (!matcherRegex) {\n                return matches;\n            }\n            while ((match = matcherRegex.exec(text)) !== null) {\n                var offset = match.index, prevChar = text.charAt(offset - 1);\n                // If we found the match at the beginning of the string, or we found the match\n                // and there is a whitespace char in front of it (meaning it is not an email\n                // address), then it is a username match.\n                if (offset === 0 || nonWordCharRegex.test(prevChar)) {\n                    var matchedText = match[0].replace(/\\.+$/g, ''), // strip off trailing .\n                    mention = matchedText.slice(1); // strip off the '@' character at the beginning\n                    matches.push(new MentionMatch({\n                        tagBuilder: tagBuilder,\n                        matchedText: matchedText,\n                        offset: offset,\n                        serviceName: serviceName,\n                        mention: mention\n                    }));\n                }\n            }\n            return matches;\n        };\n        return MentionMatcher;\n    }(Matcher));\n\n    // For debugging: search for other \"For debugging\" lines\n    // import CliTable from 'cli-table';\n    /**\n     * Parses an HTML string, calling the callbacks to notify of tags and text.\n     *\n     * ## History\n     *\n     * This file previously used a regular expression to find html tags in the input\n     * text. Unfortunately, we ran into a bunch of catastrophic backtracking issues\n     * with certain input text, causing Autolinker to either hang or just take a\n     * really long time to parse the string.\n     *\n     * The current code is intended to be a O(n) algorithm that walks through\n     * the string in one pass, and tries to be as cheap as possible. We don't need\n     * to implement the full HTML spec, but rather simply determine where the string\n     * looks like an HTML tag, and where it looks like text (so that we can autolink\n     * that).\n     *\n     * This state machine parser is intended just to be a simple but performant\n     * parser of HTML for the subset of requirements we have. We simply need to:\n     *\n     * 1. Determine where HTML tags are\n     * 2. Determine the tag name (Autolinker specifically only cares about <a>,\n     *    <script>, and <style> tags, so as not to link any text within them)\n     *\n     * We don't need to:\n     *\n     * 1. Create a parse tree\n     * 2. Auto-close tags with invalid markup\n     * 3. etc.\n     *\n     * The other intention behind this is that we didn't want to add external\n     * dependencies on the Autolinker utility which would increase its size. For\n     * instance, adding htmlparser2 adds 125kb to the minified output file,\n     * increasing its final size from 47kb to 172kb (at the time of writing). It\n     * also doesn't work exactly correctly, treating the string \"<3 blah blah blah\"\n     * as an HTML tag.\n     *\n     * Reference for HTML spec:\n     *\n     *     https-colon-slashslash www.w3.org/TR/html51/syntax.html#sec-tokenization\n     *\n     * @param {String} html The HTML to parse\n     * @param {Object} callbacks\n     * @param {Function} callbacks.onOpenTag Callback function to call when an open\n     *   tag is parsed. Called with the tagName as its argument.\n     * @param {Function} callbacks.onCloseTag Callback function to call when a close\n     *   tag is parsed. Called with the tagName as its argument. If a self-closing\n     *   tag is found, `onCloseTag` is called immediately after `onOpenTag`.\n     * @param {Function} callbacks.onText Callback function to call when text (i.e\n     *   not an HTML tag) is parsed. Called with the text (string) as its first\n     *   argument, and offset (number) into the string as its second.\n     */\n    function parseHtml(html, _a) {\n        var onOpenTag = _a.onOpenTag, onCloseTag = _a.onCloseTag, onText = _a.onText, onComment = _a.onComment, onDoctype = _a.onDoctype;\n        var noCurrentTag = new CurrentTag();\n        var charIdx = 0, len = html.length, state = 0 /* Data */, currentDataIdx = 0, // where the current data start index is\n        currentTag = noCurrentTag; // describes the current tag that is being read\n        // For debugging: search for other \"For debugging\" lines\n        // const table = new CliTable( {\n        // \thead: [ 'charIdx', 'char', 'state', 'currentDataIdx', 'currentOpenTagIdx', 'tag.type' ]\n        // } );\n        while (charIdx < len) {\n            var char = html.charAt(charIdx);\n            // For debugging: search for other \"For debugging\" lines\n            // ALSO: Temporarily remove the 'const' keyword on the State enum\n            // table.push(\n            // \t[ charIdx, char, State[ state ], currentDataIdx, currentTag.idx, currentTag.idx === -1 ? '' : currentTag.type ]\n            // );\n            switch (state) {\n                case 0 /* Data */:\n                    stateData(char);\n                    break;\n                case 1 /* TagOpen */:\n                    stateTagOpen(char);\n                    break;\n                case 2 /* EndTagOpen */:\n                    stateEndTagOpen(char);\n                    break;\n                case 3 /* TagName */:\n                    stateTagName(char);\n                    break;\n                case 4 /* BeforeAttributeName */:\n                    stateBeforeAttributeName(char);\n                    break;\n                case 5 /* AttributeName */:\n                    stateAttributeName(char);\n                    break;\n                case 6 /* AfterAttributeName */:\n                    stateAfterAttributeName(char);\n                    break;\n                case 7 /* BeforeAttributeValue */:\n                    stateBeforeAttributeValue(char);\n                    break;\n                case 8 /* AttributeValueDoubleQuoted */:\n                    stateAttributeValueDoubleQuoted(char);\n                    break;\n                case 9 /* AttributeValueSingleQuoted */:\n                    stateAttributeValueSingleQuoted(char);\n                    break;\n                case 10 /* AttributeValueUnquoted */:\n                    stateAttributeValueUnquoted(char);\n                    break;\n                case 11 /* AfterAttributeValueQuoted */:\n                    stateAfterAttributeValueQuoted(char);\n                    break;\n                case 12 /* SelfClosingStartTag */:\n                    stateSelfClosingStartTag(char);\n                    break;\n                case 13 /* MarkupDeclarationOpenState */:\n                    stateMarkupDeclarationOpen(char);\n                    break;\n                case 14 /* CommentStart */:\n                    stateCommentStart(char);\n                    break;\n                case 15 /* CommentStartDash */:\n                    stateCommentStartDash(char);\n                    break;\n                case 16 /* Comment */:\n                    stateComment(char);\n                    break;\n                case 17 /* CommentEndDash */:\n                    stateCommentEndDash(char);\n                    break;\n                case 18 /* CommentEnd */:\n                    stateCommentEnd(char);\n                    break;\n                case 19 /* CommentEndBang */:\n                    stateCommentEndBang(char);\n                    break;\n                case 20 /* Doctype */:\n                    stateDoctype(char);\n                    break;\n                default:\n                    throwUnhandledCaseError(state);\n            }\n            // For debugging: search for other \"For debugging\" lines\n            // ALSO: Temporarily remove the 'const' keyword on the State enum\n            // table.push(\n            // \t[ charIdx, char, State[ state ], currentDataIdx, currentTag.idx, currentTag.idx === -1 ? '' : currentTag.type ]\n            // );\n            charIdx++;\n        }\n        if (currentDataIdx < charIdx) {\n            emitText();\n        }\n        // For debugging: search for other \"For debugging\" lines\n        // console.log( '\\n' + table.toString() );\n        // Called when non-tags are being read (i.e. the text around HTML ags)\n        // https://www.w3.org/TR/html51/syntax.html#data-state\n        function stateData(char) {\n            if (char === '<') {\n                startNewTag();\n            }\n        }\n        // Called after a '<' is read from the Data state\n        // https://www.w3.org/TR/html51/syntax.html#tag-open-state\n        function stateTagOpen(char) {\n            if (char === '!') {\n                state = 13 /* MarkupDeclarationOpenState */;\n            }\n            else if (char === '/') {\n                state = 2 /* EndTagOpen */;\n                currentTag = new CurrentTag(__assign({}, currentTag, { isClosing: true }));\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (letterRe.test(char)) {\n                // tag name start (and no '/' read)\n                state = 3 /* TagName */;\n                currentTag = new CurrentTag(__assign({}, currentTag, { isOpening: true }));\n            }\n            else {\n                // Any other\n                state = 0 /* Data */;\n                currentTag = noCurrentTag;\n            }\n        }\n        // After a '<x', '</x' sequence is read (where 'x' is a letter character),\n        // this is to continue reading the tag name\n        // https://www.w3.org/TR/html51/syntax.html#tag-name-state\n        function stateTagName(char) {\n            if (whitespaceRe.test(char)) {\n                currentTag = new CurrentTag(__assign({}, currentTag, { name: captureTagName() }));\n                state = 4 /* BeforeAttributeName */;\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (char === '/') {\n                currentTag = new CurrentTag(__assign({}, currentTag, { name: captureTagName() }));\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '>') {\n                currentTag = new CurrentTag(__assign({}, currentTag, { name: captureTagName() }));\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else if (!letterRe.test(char) && !digitRe.test(char) && char !== ':') {\n                // Anything else that does not form an html tag. Note: the colon\n                // character is accepted for XML namespaced tags\n                resetToDataState();\n            }\n        }\n        // Called after the '/' is read from a '</' sequence\n        // https://www.w3.org/TR/html51/syntax.html#end-tag-open-state\n        function stateEndTagOpen(char) {\n            if (char === '>') { // parse error. Encountered \"</>\". Skip it without treating as a tag\n                resetToDataState();\n            }\n            else if (letterRe.test(char)) {\n                state = 3 /* TagName */;\n            }\n            else {\n                // some other non-tag-like character, don't treat this as a tag\n                resetToDataState();\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#before-attribute-name-state\n        function stateBeforeAttributeName(char) {\n            if (whitespaceRe.test(char)) ;\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (char === \"=\" || quoteRe.test(char) || controlCharsRe.test(char)) {\n                // \"Parse error\" characters that, according to the spec, should be\n                // appended to the attribute name, but we'll treat these characters\n                // as not forming a real HTML tag\n                resetToDataState();\n            }\n            else {\n                // Any other char, start of a new attribute name\n                state = 5 /* AttributeName */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-name-state\n        function stateAttributeName(char) {\n            if (whitespaceRe.test(char)) {\n                state = 6 /* AfterAttributeName */;\n            }\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '=') {\n                state = 7 /* BeforeAttributeValue */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (quoteRe.test(char)) {\n                // \"Parse error\" characters that, according to the spec, should be\n                // appended to the attribute name, but we'll treat these characters\n                // as not forming a real HTML tag\n                resetToDataState();\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#after-attribute-name-state\n        function stateAfterAttributeName(char) {\n            if (whitespaceRe.test(char)) ;\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '=') {\n                state = 7 /* BeforeAttributeValue */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (quoteRe.test(char)) {\n                // \"Parse error\" characters that, according to the spec, should be\n                // appended to the attribute name, but we'll treat these characters\n                // as not forming a real HTML tag\n                resetToDataState();\n            }\n            else {\n                // Any other character, start a new attribute in the current tag\n                state = 5 /* AttributeName */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#before-attribute-value-state\n        function stateBeforeAttributeValue(char) {\n            if (whitespaceRe.test(char)) ;\n            else if (char === \"\\\"\") {\n                state = 8 /* AttributeValueDoubleQuoted */;\n            }\n            else if (char === \"'\") {\n                state = 9 /* AttributeValueSingleQuoted */;\n            }\n            else if (/[>=`]/.test(char)) {\n                // Invalid chars after an '=' for an attribute value, don't count\n                // the current tag as an HTML tag\n                resetToDataState();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else {\n                // Any other character, consider it an unquoted attribute value\n                state = 10 /* AttributeValueUnquoted */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-value-double-quoted-state\n        function stateAttributeValueDoubleQuoted(char) {\n            if (char === \"\\\"\") { // end the current double-quoted attribute\n                state = 11 /* AfterAttributeValueQuoted */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-value-single-quoted-state\n        function stateAttributeValueSingleQuoted(char) {\n            if (char === \"'\") { // end the current single-quoted attribute\n                state = 11 /* AfterAttributeValueQuoted */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-value-unquoted-state\n        function stateAttributeValueUnquoted(char) {\n            if (whitespaceRe.test(char)) {\n                state = 4 /* BeforeAttributeName */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#after-attribute-value-quoted-state\n        function stateAfterAttributeValueQuoted(char) {\n            if (whitespaceRe.test(char)) {\n                state = 4 /* BeforeAttributeName */;\n            }\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else {\n                // Any other character, \"parse error\". Spec says to switch to the\n                // BeforeAttributeState and re-consume the character, as it may be\n                // the start of a new attribute name\n                state = 4 /* BeforeAttributeName */;\n                reconsumeCurrentCharacter();\n            }\n        }\n        // A '/' has just been read in the current tag (presumably for '/>'), and\n        // this handles the next character\n        // https://www.w3.org/TR/html51/syntax.html#self-closing-start-tag-state\n        function stateSelfClosingStartTag(char) {\n            if (char === '>') {\n                currentTag = new CurrentTag(__assign({}, currentTag, { isClosing: true }));\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else {\n                state = 4 /* BeforeAttributeName */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#markup-declaration-open-state\n        // (HTML Comments or !DOCTYPE)\n        function stateMarkupDeclarationOpen(char) {\n            if (html.substr(charIdx, 2) === '--') { // html comment\n                charIdx += 2; // \"consume\" characters\n                currentTag = new CurrentTag(__assign({}, currentTag, { type: 'comment' }));\n                state = 14 /* CommentStart */;\n            }\n            else if (html.substr(charIdx, 7).toUpperCase() === 'DOCTYPE') {\n                charIdx += 7; // \"consume\" characters\n                currentTag = new CurrentTag(__assign({}, currentTag, { type: 'doctype' }));\n                state = 20 /* Doctype */;\n            }\n            else {\n                // At this point, the spec specifies that the state machine should\n                // enter the \"bogus comment\" state, in which case any character(s)\n                // after the '<!' that were read should become an HTML comment up\n                // until the first '>' that is read (or EOF). Instead, we'll assume\n                // that a user just typed '<!' as part of text data\n                resetToDataState();\n            }\n        }\n        // Handles after the sequence '<!--' has been read\n        // https://www.w3.org/TR/html51/syntax.html#comment-start-state\n        function stateCommentStart(char) {\n            if (char === '-') {\n                // We've read the sequence '<!---' at this point (3 dashes)\n                state = 15 /* CommentStartDash */;\n            }\n            else if (char === '>') {\n                // At this point, we'll assume the comment wasn't a real comment\n                // so we'll just emit it as data. We basically read the sequence\n                // '<!-->'\n                resetToDataState();\n            }\n            else {\n                // Any other char, take it as part of the comment\n                state = 16 /* Comment */;\n            }\n        }\n        // We've read the sequence '<!---' at this point (3 dashes)\n        // https://www.w3.org/TR/html51/syntax.html#comment-start-dash-state\n        function stateCommentStartDash(char) {\n            if (char === '-') {\n                // We've read '<!----' (4 dashes) at this point\n                state = 18 /* CommentEnd */;\n            }\n            else if (char === '>') {\n                // At this point, we'll assume the comment wasn't a real comment\n                // so we'll just emit it as data. We basically read the sequence\n                // '<!--->'\n                resetToDataState();\n            }\n            else {\n                // Anything else, take it as a valid comment\n                state = 16 /* Comment */;\n            }\n        }\n        // Currently reading the comment's text (data)\n        // https://www.w3.org/TR/html51/syntax.html#comment-state\n        function stateComment(char) {\n            if (char === '-') {\n                state = 17 /* CommentEndDash */;\n            }\n        }\n        // When we we've read the first dash inside a comment, it may signal the\n        // end of the comment if we read another dash\n        // https://www.w3.org/TR/html51/syntax.html#comment-end-dash-state\n        function stateCommentEndDash(char) {\n            if (char === '-') {\n                state = 18 /* CommentEnd */;\n            }\n            else {\n                // Wasn't a dash, must still be part of the comment\n                state = 16 /* Comment */;\n            }\n        }\n        // After we've read two dashes inside a comment, it may signal the end of\n        // the comment if we then read a '>' char\n        // https://www.w3.org/TR/html51/syntax.html#comment-end-state\n        function stateCommentEnd(char) {\n            if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '!') {\n                state = 19 /* CommentEndBang */;\n            }\n            else if (char === '-') ;\n            else {\n                // Anything else, switch back to the comment state since we didn't\n                // read the full \"end comment\" sequence (i.e. '-->')\n                state = 16 /* Comment */;\n            }\n        }\n        // We've read the sequence '--!' inside of a comment\n        // https://www.w3.org/TR/html51/syntax.html#comment-end-bang-state\n        function stateCommentEndBang(char) {\n            if (char === '-') {\n                // We read the sequence '--!-' inside of a comment. The last dash\n                // could signify that the comment is going to close\n                state = 17 /* CommentEndDash */;\n            }\n            else if (char === '>') {\n                // End of comment with the sequence '--!>'\n                emitTagAndPreviousTextNode();\n            }\n            else {\n                // The '--!' was not followed by a '>', continue reading the\n                // comment's text\n                state = 16 /* Comment */;\n            }\n        }\n        /**\n         * For DOCTYPES in particular, we don't care about the attributes. Just\n         * advance to the '>' character and emit the tag, unless we find a '<'\n         * character in which case we'll start a new tag.\n         *\n         * Example doctype tag:\n         *    <!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http-colon-slashslash www.w3.org/TR/html4/strict.dtd\">\n         *\n         * Actual spec: https-colon-slashslash www.w3.org/TR/html51/syntax.html#doctype-state\n         */\n        function stateDoctype(char) {\n            if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                startNewTag();\n            }\n        }\n        /**\n         * Resets the state back to the Data state, and removes the current tag.\n         *\n         * We'll generally run this function whenever a \"parse error\" is\n         * encountered, where the current tag that is being read no longer looks\n         * like a real HTML tag.\n         */\n        function resetToDataState() {\n            state = 0 /* Data */;\n            currentTag = noCurrentTag;\n        }\n        /**\n         * Starts a new HTML tag at the current index, ignoring any previous HTML\n         * tag that was being read.\n         *\n         * We'll generally run this function whenever we read a new '<' character,\n         * including when we read a '<' character inside of an HTML tag that we were\n         * previously reading.\n         */\n        function startNewTag() {\n            state = 1 /* TagOpen */;\n            currentTag = new CurrentTag({ idx: charIdx });\n        }\n        /**\n         * Once we've decided to emit an open tag, that means we can also emit the\n         * text node before it.\n         */\n        function emitTagAndPreviousTextNode() {\n            var textBeforeTag = html.slice(currentDataIdx, currentTag.idx);\n            if (textBeforeTag) {\n                // the html tag was the first element in the html string, or two\n                // tags next to each other, in which case we should not emit a text\n                // node\n                onText(textBeforeTag, currentDataIdx);\n            }\n            if (currentTag.type === 'comment') {\n                onComment(currentTag.idx);\n            }\n            else if (currentTag.type === 'doctype') {\n                onDoctype(currentTag.idx);\n            }\n            else {\n                if (currentTag.isOpening) {\n                    onOpenTag(currentTag.name, currentTag.idx);\n                }\n                if (currentTag.isClosing) { // note: self-closing tags will emit both opening and closing\n                    onCloseTag(currentTag.name, currentTag.idx);\n                }\n            }\n            // Since we just emitted a tag, reset to the data state for the next char\n            resetToDataState();\n            currentDataIdx = charIdx + 1;\n        }\n        function emitText() {\n            var text = html.slice(currentDataIdx, charIdx);\n            onText(text, currentDataIdx);\n            currentDataIdx = charIdx + 1;\n        }\n        /**\n         * Captures the tag name from the start of the tag to the current character\n         * index, and converts it to lower case\n         */\n        function captureTagName() {\n            var startIdx = currentTag.idx + (currentTag.isClosing ? 2 : 1);\n            return html.slice(startIdx, charIdx).toLowerCase();\n        }\n        /**\n         * Causes the main loop to re-consume the current character, such as after\n         * encountering a \"parse error\" that changed state and needs to reconsume\n         * the same character in that new state.\n         */\n        function reconsumeCurrentCharacter() {\n            charIdx--;\n        }\n    }\n    var CurrentTag = /** @class */ (function () {\n        function CurrentTag(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            this.idx = cfg.idx !== undefined ? cfg.idx : -1;\n            this.type = cfg.type || 'tag';\n            this.name = cfg.name || '';\n            this.isOpening = !!cfg.isOpening;\n            this.isClosing = !!cfg.isClosing;\n        }\n        return CurrentTag;\n    }());\n\n    /**\n     * @class Autolinker\n     * @extends Object\n     *\n     * Utility class used to process a given string of text, and wrap the matches in\n     * the appropriate anchor (&lt;a&gt;) tags to turn them into links.\n     *\n     * Any of the configuration options may be provided in an Object provided\n     * to the Autolinker constructor, which will configure how the {@link #link link()}\n     * method will process the links.\n     *\n     * For example:\n     *\n     *     var autolinker = new Autolinker( {\n     *         newWindow : false,\n     *         truncate  : 30\n     *     } );\n     *\n     *     var html = autolinker.link( \"Joe went to www.yahoo.com\" );\n     *     // produces: 'Joe went to <a href=\"http-colon-slashslash www.yahoo.com\">yahoo.com</a>'\n     *\n     *\n     * The {@link #static-link static link()} method may also be used to inline\n     * options into a single call, which may be more convenient for one-off uses.\n     * For example:\n     *\n     *     var html = Autolinker.link( \"Joe went to www.yahoo.com\", {\n     *         newWindow : false,\n     *         truncate  : 30\n     *     } );\n     *     // produces: 'Joe went to <a href=\"http-colon-slashslash www.yahoo.com\">yahoo.com</a>'\n     *\n     *\n     * ## Custom Replacements of Links\n     *\n     * If the configuration options do not provide enough flexibility, a {@link #replaceFn}\n     * may be provided to fully customize the output of Autolinker. This function is\n     * called once for each URL/Email/Phone#/Hashtag/Mention (Twitter, Instagram, Soundcloud)\n     * match that is encountered.\n     *\n     * For example:\n     *\n     *     var input = \"...\";  // string with URLs, Email Addresses, Phone #s, Hashtags, and Mentions (Twitter, Instagram, Soundcloud)\n     *\n     *     var linkedText = Autolinker.link( input, {\n     *         replaceFn : function( match ) {\n     *             console.log( \"href = \", match.getAnchorHref() );\n     *             console.log( \"text = \", match.getAnchorText() );\n     *\n     *             switch( match.getType() ) {\n     *                 case 'url' :\n     *                     console.log( \"url: \", match.getUrl() );\n     *\n     *                     if( match.getUrl().indexOf( 'mysite.com' ) === -1 ) {\n     *                         var tag = match.buildTag();  // returns an `Autolinker.HtmlTag` instance, which provides mutator methods for easy changes\n     *                         tag.setAttr( 'rel', 'nofollow' );\n     *                         tag.addClass( 'external-link' );\n     *\n     *                         return tag;\n     *\n     *                     } else {\n     *                         return true;  // let Autolinker perform its normal anchor tag replacement\n     *                     }\n     *\n     *                 case 'email' :\n     *                     var email = match.getEmail();\n     *                     console.log( \"email: \", email );\n     *\n     *                     if( email === \"my@own.address\" ) {\n     *                         return false;  // don't auto-link this particular email address; leave as-is\n     *                     } else {\n     *                         return;  // no return value will have Autolinker perform its normal anchor tag replacement (same as returning `true`)\n     *                     }\n     *\n     *                 case 'phone' :\n     *                     var phoneNumber = match.getPhoneNumber();\n     *                     console.log( phoneNumber );\n     *\n     *                     return '<a href=\"http-colon-slashslash newplace.to.link.phone.numbers.to/\">' + phoneNumber + '</a>';\n     *\n     *                 case 'hashtag' :\n     *                     var hashtag = match.getHashtag();\n     *                     console.log( hashtag );\n     *\n     *                     return '<a href=\"http-colon-slashslash newplace.to.link.hashtag.handles.to/\">' + hashtag + '</a>';\n     *\n     *                 case 'mention' :\n     *                     var mention = match.getMention();\n     *                     console.log( mention );\n     *\n     *                     return '<a href=\"http-colon-slashslash newplace.to.link.mention.to/\">' + mention + '</a>';\n     *             }\n     *         }\n     *     } );\n     *\n     *\n     * The function may return the following values:\n     *\n     * - `true` (Boolean): Allow Autolinker to replace the match as it normally\n     *   would.\n     * - `false` (Boolean): Do not replace the current match at all - leave as-is.\n     * - Any String: If a string is returned from the function, the string will be\n     *   used directly as the replacement HTML for the match.\n     * - An {@link Autolinker.HtmlTag} instance, which can be used to build/modify\n     *   an HTML tag before writing out its HTML text.\n     */\n    var Autolinker = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} [cfg] The configuration options for the Autolinker instance,\n         *   specified in an Object (map).\n         */\n        function Autolinker(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            /**\n             * The Autolinker version number exposed on the instance itself.\n             *\n             * Ex: 0.25.1\n             */\n            this.version = Autolinker.version;\n            /**\n             * @cfg {Boolean/Object} [urls]\n             *\n             * `true` if URLs should be automatically linked, `false` if they should not\n             * be. Defaults to `true`.\n             *\n             * Examples:\n             *\n             *     urls: true\n             *\n             *     // or\n             *\n             *     urls: {\n             *         schemeMatches : true,\n             *         wwwMatches    : true,\n             *         tldMatches    : true\n             *     }\n             *\n             * As shown above, this option also accepts an Object form with 3 properties\n             * to allow for more customization of what exactly gets linked. All default\n             * to `true`:\n             *\n             * @cfg {Boolean} [urls.schemeMatches] `true` to match URLs found prefixed\n             *   with a scheme, i.e. `http-colon-slashslash google.com`, or `other+scheme://google.com`,\n             *   `false` to prevent these types of matches.\n             * @cfg {Boolean} [urls.wwwMatches] `true` to match urls found prefixed with\n             *   `'www.'`, i.e. `www.google.com`. `false` to prevent these types of\n             *   matches. Note that if the URL had a prefixed scheme, and\n             *   `schemeMatches` is true, it will still be linked.\n             * @cfg {Boolean} [urls.tldMatches] `true` to match URLs with known top\n             *   level domains (.com, .net, etc.) that are not prefixed with a scheme or\n             *   `'www.'`. This option attempts to match anything that looks like a URL\n             *   in the given text. Ex: `google.com`, `asdf.org/?page=1`, etc. `false`\n             *   to prevent these types of matches.\n             */\n            this.urls = {}; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [email=true]\n             *\n             * `true` if email addresses should be automatically linked, `false` if they\n             * should not be.\n             */\n            this.email = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [phone=true]\n             *\n             * `true` if Phone numbers (\"(555)555-5555\") should be automatically linked,\n             * `false` if they should not be.\n             */\n            this.phone = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean/String} [hashtag=false]\n             *\n             * A string for the service name to have hashtags (ex: \"#myHashtag\")\n             * auto-linked to. The currently-supported values are:\n             *\n             * - 'twitter'\n             * - 'facebook'\n             * - 'instagram'\n             *\n             * Pass `false` to skip auto-linking of hashtags.\n             */\n            this.hashtag = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String/Boolean} [mention=false]\n             *\n             * A string for the service name to have mentions (ex: \"@myuser\")\n             * auto-linked to. The currently supported values are:\n             *\n             * - 'twitter'\n             * - 'instagram'\n             * - 'soundcloud'\n             *\n             * Defaults to `false` to skip auto-linking of mentions.\n             */\n            this.mention = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [newWindow=true]\n             *\n             * `true` if the links should open in a new window, `false` otherwise.\n             */\n            this.newWindow = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean/Object} [stripPrefix=true]\n             *\n             * `true` if 'http-colon-slashslash ' (or 'https-colon-slashslash ') and/or the 'www.' should be stripped\n             * from the beginning of URL links' text, `false` otherwise. Defaults to\n             * `true`.\n             *\n             * Examples:\n             *\n             *     stripPrefix: true\n             *\n             *     // or\n             *\n             *     stripPrefix: {\n             *         scheme : true,\n             *         www    : true\n             *     }\n             *\n             * As shown above, this option also accepts an Object form with 2 properties\n             * to allow for more customization of what exactly is prevented from being\n             * displayed. Both default to `true`:\n             *\n             * @cfg {Boolean} [stripPrefix.scheme] `true` to prevent the scheme part of\n             *   a URL match from being displayed to the user. Example:\n             *   `'http-colon-slashslash google.com'` will be displayed as `'google.com'`. `false` to\n             *   not strip the scheme. NOTE: Only an `'http-colon-slashslash '` or `'https-colon-slashslash '` scheme\n             *   will be removed, so as not to remove a potentially dangerous scheme\n             *   (such as `'file://'` or `'javascript:'`)\n             * @cfg {Boolean} [stripPrefix.www] www (Boolean): `true` to prevent the\n             *   `'www.'` part of a URL match from being displayed to the user. Ex:\n             *   `'www.google.com'` will be displayed as `'google.com'`. `false` to not\n             *   strip the `'www'`.\n             */\n            this.stripPrefix = { scheme: true, www: true }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [stripTrailingSlash=true]\n             *\n             * `true` to remove the trailing slash from URL matches, `false` to keep\n             *  the trailing slash.\n             *\n             *  Example when `true`: `http-colon-slashslash google.com/` will be displayed as\n             *  `http-colon-slashslash google.com`.\n             */\n            this.stripTrailingSlash = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [decodePercentEncoding=true]\n             *\n             * `true` to decode percent-encoded characters in URL matches, `false` to keep\n             *  the percent-encoded characters.\n             *\n             *  Example when `true`: `https-colon-slashslash en.wikipedia.org/wiki/San_Jos%C3%A9` will\n             *  be displayed as `https-colon-slashslash en.wikipedia.org/wiki/San_Jos`.\n             */\n            this.decodePercentEncoding = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Number/Object} [truncate=0]\n             *\n             * ## Number Form\n             *\n             * A number for how many characters matched text should be truncated to\n             * inside the text of a link. If the matched text is over this number of\n             * characters, it will be truncated to this length by adding a two period\n             * ellipsis ('..') to the end of the string.\n             *\n             * For example: A url like 'http-colon-slashslash www.yahoo.com/some/long/path/to/a/file'\n             * truncated to 25 characters might look something like this:\n             * 'yahoo.com/some/long/pat..'\n             *\n             * Example Usage:\n             *\n             *     truncate: 25\n             *\n             *\n             *  Defaults to `0` for \"no truncation.\"\n             *\n             *\n             * ## Object Form\n             *\n             * An Object may also be provided with two properties: `length` (Number) and\n             * `location` (String). `location` may be one of the following: 'end'\n             * (default), 'middle', or 'smart'.\n             *\n             * Example Usage:\n             *\n             *     truncate: { length: 25, location: 'middle' }\n             *\n             * @cfg {Number} [truncate.length=0] How many characters to allow before\n             *   truncation will occur. Defaults to `0` for \"no truncation.\"\n             * @cfg {\"end\"/\"middle\"/\"smart\"} [truncate.location=\"end\"]\n             *\n             * - 'end' (default): will truncate up to the number of characters, and then\n             *   add an ellipsis at the end. Ex: 'yahoo.com/some/long/pat..'\n             * - 'middle': will truncate and add the ellipsis in the middle. Ex:\n             *   'yahoo.com/s..th/to/a/file'\n             * - 'smart': for URLs where the algorithm attempts to strip out unnecessary\n             *   parts first (such as the 'www.', then URL scheme, hash, etc.),\n             *   attempting to make the URL human-readable before looking for a good\n             *   point to insert the ellipsis if it is still too long. Ex:\n             *   'yahoo.com/some..to/a/file'. For more details, see\n             *   {@link Autolinker.truncate.TruncateSmart}.\n             */\n            this.truncate = { length: 0, location: 'end' }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} className\n             *\n             * A CSS class name to add to the generated links. This class will be added\n             * to all links, as well as this class plus match suffixes for styling\n             * url/email/phone/hashtag/mention links differently.\n             *\n             * For example, if this config is provided as \"myLink\", then:\n             *\n             * - URL links will have the CSS classes: \"myLink myLink-url\"\n             * - Email links will have the CSS classes: \"myLink myLink-email\", and\n             * - Phone links will have the CSS classes: \"myLink myLink-phone\"\n             * - Hashtag links will have the CSS classes: \"myLink myLink-hashtag\"\n             * - Mention links will have the CSS classes: \"myLink myLink-mention myLink-[type]\"\n             *   where [type] is either \"instagram\", \"twitter\" or \"soundcloud\"\n             */\n            this.className = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Function} replaceFn\n             *\n             * A function to individually process each match found in the input string.\n             *\n             * See the class's description for usage.\n             *\n             * The `replaceFn` can be called with a different context object (`this`\n             * reference) using the {@link #context} cfg.\n             *\n             * This function is called with the following parameter:\n             *\n             * @cfg {Autolinker.match.Match} replaceFn.match The Match instance which\n             *   can be used to retrieve information about the match that the `replaceFn`\n             *   is currently processing. See {@link Autolinker.match.Match} subclasses\n             *   for details.\n             */\n            this.replaceFn = null; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object} context\n             *\n             * The context object (`this` reference) to call the `replaceFn` with.\n             *\n             * Defaults to this Autolinker instance.\n             */\n            this.context = undefined; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @private\n             * @property {Autolinker.matcher.Matcher[]} matchers\n             *\n             * The {@link Autolinker.matcher.Matcher} instances for this Autolinker\n             * instance.\n             *\n             * This is lazily created in {@link #getMatchers}.\n             */\n            this.matchers = null;\n            /**\n             * @private\n             * @property {Autolinker.AnchorTagBuilder} tagBuilder\n             *\n             * The AnchorTagBuilder instance used to build match replacement anchor tags.\n             * Note: this is lazily instantiated in the {@link #getTagBuilder} method.\n             */\n            this.tagBuilder = null;\n            // Note: when `this.something` is used in the rhs of these assignments,\n            //       it refers to the default values set above the constructor\n            this.urls = this.normalizeUrlsCfg(cfg.urls);\n            this.email = typeof cfg.email === 'boolean' ? cfg.email : this.email;\n            this.phone = typeof cfg.phone === 'boolean' ? cfg.phone : this.phone;\n            this.hashtag = cfg.hashtag || this.hashtag;\n            this.mention = cfg.mention || this.mention;\n            this.newWindow = typeof cfg.newWindow === 'boolean' ? cfg.newWindow : this.newWindow;\n            this.stripPrefix = this.normalizeStripPrefixCfg(cfg.stripPrefix);\n            this.stripTrailingSlash = typeof cfg.stripTrailingSlash === 'boolean' ? cfg.stripTrailingSlash : this.stripTrailingSlash;\n            this.decodePercentEncoding = typeof cfg.decodePercentEncoding === 'boolean' ? cfg.decodePercentEncoding : this.decodePercentEncoding;\n            // Validate the value of the `mention` cfg\n            var mention = this.mention;\n            if (mention !== false && mention !== 'twitter' && mention !== 'instagram' && mention !== 'soundcloud') {\n                throw new Error(\"invalid `mention` cfg - see docs\");\n            }\n            // Validate the value of the `hashtag` cfg\n            var hashtag = this.hashtag;\n            if (hashtag !== false && hashtag !== 'twitter' && hashtag !== 'facebook' && hashtag !== 'instagram') {\n                throw new Error(\"invalid `hashtag` cfg - see docs\");\n            }\n            this.truncate = this.normalizeTruncateCfg(cfg.truncate);\n            this.className = cfg.className || this.className;\n            this.replaceFn = cfg.replaceFn || this.replaceFn;\n            this.context = cfg.context || this;\n        }\n        /**\n         * Automatically links URLs, Email addresses, Phone Numbers, Twitter handles,\n         * Hashtags, and Mentions found in the given chunk of HTML. Does not link URLs\n         * found within HTML tags.\n         *\n         * For instance, if given the text: `You should go to http-colon-slashslash www.yahoo.com`,\n         * then the result will be `You should go to &lt;a href=\"http-colon-slashslash www.yahoo.com\"&gt;http-colon-slashslash www.yahoo.com&lt;/a&gt;`\n         *\n         * Example:\n         *\n         *     var linkedText = Autolinker.link( \"Go to google.com\", { newWindow: false } );\n         *     // Produces: \"Go to <a href=\"http-colon-slashslash google.com\">google.com</a>\"\n         *\n         * @static\n         * @param {String} textOrHtml The HTML or text to find matches within (depending\n         *   on if the {@link #urls}, {@link #email}, {@link #phone}, {@link #mention},\n         *   {@link #hashtag}, and {@link #mention} options are enabled).\n         * @param {Object} [options] Any of the configuration options for the Autolinker\n         *   class, specified in an Object (map). See the class description for an\n         *   example call.\n         * @return {String} The HTML text, with matches automatically linked.\n         */\n        Autolinker.link = function (textOrHtml, options) {\n            var autolinker = new Autolinker(options);\n            return autolinker.link(textOrHtml);\n        };\n        /**\n         * Parses the input `textOrHtml` looking for URLs, email addresses, phone\n         * numbers, username handles, and hashtags (depending on the configuration\n         * of the Autolinker instance), and returns an array of {@link Autolinker.match.Match}\n         * objects describing those matches (without making any replacements).\n         *\n         * Note that if parsing multiple pieces of text, it is slightly more efficient\n         * to create an Autolinker instance, and use the instance-level {@link #parse}\n         * method.\n         *\n         * Example:\n         *\n         *     var matches = Autolinker.parse( \"Hello google.com, I am asdf@asdf.com\", {\n         *         urls: true,\n         *         email: true\n         *     } );\n         *\n         *     console.log( matches.length );           // 2\n         *     console.log( matches[ 0 ].getType() );   // 'url'\n         *     console.log( matches[ 0 ].getUrl() );    // 'google.com'\n         *     console.log( matches[ 1 ].getType() );   // 'email'\n         *     console.log( matches[ 1 ].getEmail() );  // 'asdf@asdf.com'\n         *\n         * @static\n         * @param {String} textOrHtml The HTML or text to find matches within\n         *   (depending on if the {@link #urls}, {@link #email}, {@link #phone},\n         *   {@link #hashtag}, and {@link #mention} options are enabled).\n         * @param {Object} [options] Any of the configuration options for the Autolinker\n         *   class, specified in an Object (map). See the class description for an\n         *   example call.\n         * @return {Autolinker.match.Match[]} The array of Matches found in the\n         *   given input `textOrHtml`.\n         */\n        Autolinker.parse = function (textOrHtml, options) {\n            var autolinker = new Autolinker(options);\n            return autolinker.parse(textOrHtml);\n        };\n        /**\n         * Normalizes the {@link #urls} config into an Object with 3 properties:\n         * `schemeMatches`, `wwwMatches`, and `tldMatches`, all Booleans.\n         *\n         * See {@link #urls} config for details.\n         *\n         * @private\n         * @param {Boolean/Object} urls\n         * @return {Object}\n         */\n        Autolinker.prototype.normalizeUrlsCfg = function (urls) {\n            if (urls == null)\n                urls = true; // default to `true`\n            if (typeof urls === 'boolean') {\n                return { schemeMatches: urls, wwwMatches: urls, tldMatches: urls };\n            }\n            else { // object form\n                return {\n                    schemeMatches: typeof urls.schemeMatches === 'boolean' ? urls.schemeMatches : true,\n                    wwwMatches: typeof urls.wwwMatches === 'boolean' ? urls.wwwMatches : true,\n                    tldMatches: typeof urls.tldMatches === 'boolean' ? urls.tldMatches : true\n                };\n            }\n        };\n        /**\n         * Normalizes the {@link #stripPrefix} config into an Object with 2\n         * properties: `scheme`, and `www` - both Booleans.\n         *\n         * See {@link #stripPrefix} config for details.\n         *\n         * @private\n         * @param {Boolean/Object} stripPrefix\n         * @return {Object}\n         */\n        Autolinker.prototype.normalizeStripPrefixCfg = function (stripPrefix) {\n            if (stripPrefix == null)\n                stripPrefix = true; // default to `true`\n            if (typeof stripPrefix === 'boolean') {\n                return { scheme: stripPrefix, www: stripPrefix };\n            }\n            else { // object form\n                return {\n                    scheme: typeof stripPrefix.scheme === 'boolean' ? stripPrefix.scheme : true,\n                    www: typeof stripPrefix.www === 'boolean' ? stripPrefix.www : true\n                };\n            }\n        };\n        /**\n         * Normalizes the {@link #truncate} config into an Object with 2 properties:\n         * `length` (Number), and `location` (String).\n         *\n         * See {@link #truncate} config for details.\n         *\n         * @private\n         * @param {Number/Object} truncate\n         * @return {Object}\n         */\n        Autolinker.prototype.normalizeTruncateCfg = function (truncate) {\n            if (typeof truncate === 'number') {\n                return { length: truncate, location: 'end' };\n            }\n            else { // object, or undefined/null\n                return defaults(truncate || {}, {\n                    length: Number.POSITIVE_INFINITY,\n                    location: 'end'\n                });\n            }\n        };\n        /**\n         * Parses the input `textOrHtml` looking for URLs, email addresses, phone\n         * numbers, username handles, and hashtags (depending on the configuration\n         * of the Autolinker instance), and returns an array of {@link Autolinker.match.Match}\n         * objects describing those matches (without making any replacements).\n         *\n         * This method is used by the {@link #link} method, but can also be used to\n         * simply do parsing of the input in order to discover what kinds of links\n         * there are and how many.\n         *\n         * Example usage:\n         *\n         *     var autolinker = new Autolinker( {\n         *         urls: true,\n         *         email: true\n         *     } );\n         *\n         *     var matches = autolinker.parse( \"Hello google.com, I am asdf@asdf.com\" );\n         *\n         *     console.log( matches.length );           // 2\n         *     console.log( matches[ 0 ].getType() );   // 'url'\n         *     console.log( matches[ 0 ].getUrl() );    // 'google.com'\n         *     console.log( matches[ 1 ].getType() );   // 'email'\n         *     console.log( matches[ 1 ].getEmail() );  // 'asdf@asdf.com'\n         *\n         * @param {String} textOrHtml The HTML or text to find matches within\n         *   (depending on if the {@link #urls}, {@link #email}, {@link #phone},\n         *   {@link #hashtag}, and {@link #mention} options are enabled).\n         * @return {Autolinker.match.Match[]} The array of Matches found in the\n         *   given input `textOrHtml`.\n         */\n        Autolinker.prototype.parse = function (textOrHtml) {\n            var _this = this;\n            var skipTagNames = ['a', 'style', 'script'], skipTagsStackCount = 0, // used to only Autolink text outside of anchor/script/style tags. We don't want to autolink something that is already linked inside of an <a> tag, for instance\n            matches = [];\n            // Find all matches within the `textOrHtml` (but not matches that are\n            // already nested within <a>, <style> and <script> tags)\n            parseHtml(textOrHtml, {\n                onOpenTag: function (tagName) {\n                    if (skipTagNames.indexOf(tagName) >= 0) {\n                        skipTagsStackCount++;\n                    }\n                },\n                onText: function (text, offset) {\n                    // Only process text nodes that are not within an <a>, <style> or <script> tag\n                    if (skipTagsStackCount === 0) {\n                        // \"Walk around\" common HTML entities. An '&nbsp;' (for example)\n                        // could be at the end of a URL, but we don't want to\n                        // include the trailing '&' in the URL. See issue #76\n                        // TODO: Handle HTML entities separately in parseHtml() and\n                        // don't emit them as \"text\" except for &amp; entities\n                        var htmlCharacterEntitiesRegex = /(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi;\n                        var textSplit = splitAndCapture(text, htmlCharacterEntitiesRegex);\n                        var currentOffset_1 = offset;\n                        textSplit.forEach(function (splitText, i) {\n                            // even number matches are text, odd numbers are html entities\n                            if (i % 2 === 0) {\n                                var textNodeMatches = _this.parseText(splitText, currentOffset_1);\n                                matches.push.apply(matches, textNodeMatches);\n                            }\n                            currentOffset_1 += splitText.length;\n                        });\n                    }\n                },\n                onCloseTag: function (tagName) {\n                    if (skipTagNames.indexOf(tagName) >= 0) {\n                        skipTagsStackCount = Math.max(skipTagsStackCount - 1, 0); // attempt to handle extraneous </a> tags by making sure the stack count never goes below 0\n                    }\n                },\n                onComment: function (offset) { },\n                onDoctype: function (offset) { },\n            });\n            // After we have found all matches, remove subsequent matches that\n            // overlap with a previous match. This can happen for instance with URLs,\n            // where the url 'google.com/#link' would match '#link' as a hashtag.\n            matches = this.compactMatches(matches);\n            // And finally, remove matches for match types that have been turned\n            // off. We needed to have all match types turned on initially so that\n            // things like hashtags could be filtered out if they were really just\n            // part of a URL match (for instance, as a named anchor).\n            matches = this.removeUnwantedMatches(matches);\n            return matches;\n        };\n        /**\n         * After we have found all matches, we need to remove matches that overlap\n         * with a previous match. This can happen for instance with URLs, where the\n         * url 'google.com/#link' would match '#link' as a hashtag. Because the\n         * '#link' part is contained in a larger match that comes before the HashTag\n         * match, we'll remove the HashTag match.\n         *\n         * @private\n         * @param {Autolinker.match.Match[]} matches\n         * @return {Autolinker.match.Match[]}\n         */\n        Autolinker.prototype.compactMatches = function (matches) {\n            // First, the matches need to be sorted in order of offset\n            matches.sort(function (a, b) { return a.getOffset() - b.getOffset(); });\n            for (var i = 0; i < matches.length - 1; i++) {\n                var match = matches[i], offset = match.getOffset(), matchedTextLength = match.getMatchedText().length, endIdx = offset + matchedTextLength;\n                if (i + 1 < matches.length) {\n                    // Remove subsequent matches that equal offset with current match\n                    if (matches[i + 1].getOffset() === offset) {\n                        var removeIdx = matches[i + 1].getMatchedText().length > matchedTextLength ? i : i + 1;\n                        matches.splice(removeIdx, 1);\n                        continue;\n                    }\n                    // Remove subsequent matches that overlap with the current match\n                    if (matches[i + 1].getOffset() < endIdx) {\n                        matches.splice(i + 1, 1);\n                    }\n                }\n            }\n            return matches;\n        };\n        /**\n         * Removes matches for matchers that were turned off in the options. For\n         * example, if {@link #hashtag hashtags} were not to be matched, we'll\n         * remove them from the `matches` array here.\n         *\n         * Note: we *must* use all Matchers on the input string, and then filter\n         * them out later. For example, if the options were `{ url: false, hashtag: true }`,\n         * we wouldn't want to match the text '#link' as a HashTag inside of the text\n         * 'google.com/#link'. The way the algorithm works is that we match the full\n         * URL first (which prevents the accidental HashTag match), and then we'll\n         * simply throw away the URL match.\n         *\n         * @private\n         * @param {Autolinker.match.Match[]} matches The array of matches to remove\n         *   the unwanted matches from. Note: this array is mutated for the\n         *   removals.\n         * @return {Autolinker.match.Match[]} The mutated input `matches` array.\n         */\n        Autolinker.prototype.removeUnwantedMatches = function (matches) {\n            if (!this.hashtag)\n                remove(matches, function (match) { return match.getType() === 'hashtag'; });\n            if (!this.email)\n                remove(matches, function (match) { return match.getType() === 'email'; });\n            if (!this.phone)\n                remove(matches, function (match) { return match.getType() === 'phone'; });\n            if (!this.mention)\n                remove(matches, function (match) { return match.getType() === 'mention'; });\n            if (!this.urls.schemeMatches) {\n                remove(matches, function (m) { return m.getType() === 'url' && m.getUrlMatchType() === 'scheme'; });\n            }\n            if (!this.urls.wwwMatches) {\n                remove(matches, function (m) { return m.getType() === 'url' && m.getUrlMatchType() === 'www'; });\n            }\n            if (!this.urls.tldMatches) {\n                remove(matches, function (m) { return m.getType() === 'url' && m.getUrlMatchType() === 'tld'; });\n            }\n            return matches;\n        };\n        /**\n         * Parses the input `text` looking for URLs, email addresses, phone\n         * numbers, username handles, and hashtags (depending on the configuration\n         * of the Autolinker instance), and returns an array of {@link Autolinker.match.Match}\n         * objects describing those matches.\n         *\n         * This method processes a **non-HTML string**, and is used to parse and\n         * match within the text nodes of an HTML string. This method is used\n         * internally by {@link #parse}.\n         *\n         * @private\n         * @param {String} text The text to find matches within (depending on if the\n         *   {@link #urls}, {@link #email}, {@link #phone},\n         *   {@link #hashtag}, and {@link #mention} options are enabled). This must be a non-HTML string.\n         * @param {Number} [offset=0] The offset of the text node within the\n         *   original string. This is used when parsing with the {@link #parse}\n         *   method to generate correct offsets within the {@link Autolinker.match.Match}\n         *   instances, but may be omitted if calling this method publicly.\n         * @return {Autolinker.match.Match[]} The array of Matches found in the\n         *   given input `text`.\n         */\n        Autolinker.prototype.parseText = function (text, offset) {\n            if (offset === void 0) { offset = 0; }\n            offset = offset || 0;\n            var matchers = this.getMatchers(), matches = [];\n            for (var i = 0, numMatchers = matchers.length; i < numMatchers; i++) {\n                var textMatches = matchers[i].parseMatches(text);\n                // Correct the offset of each of the matches. They are originally\n                // the offset of the match within the provided text node, but we\n                // need to correct them to be relative to the original HTML input\n                // string (i.e. the one provided to #parse).\n                for (var j = 0, numTextMatches = textMatches.length; j < numTextMatches; j++) {\n                    textMatches[j].setOffset(offset + textMatches[j].getOffset());\n                }\n                matches.push.apply(matches, textMatches);\n            }\n            return matches;\n        };\n        /**\n         * Automatically links URLs, Email addresses, Phone numbers, Hashtags,\n         * and Mentions (Twitter, Instagram, Soundcloud) found in the given chunk of HTML. Does not link\n         * URLs found within HTML tags.\n         *\n         * For instance, if given the text: `You should go to http-colon-slashslash www.yahoo.com`,\n         * then the result will be `You should go to\n         * &lt;a href=\"http-colon-slashslash www.yahoo.com\"&gt;http-colon-slashslash www.yahoo.com&lt;/a&gt;`\n         *\n         * This method finds the text around any HTML elements in the input\n         * `textOrHtml`, which will be the text that is processed. Any original HTML\n         * elements will be left as-is, as well as the text that is already wrapped\n         * in anchor (&lt;a&gt;) tags.\n         *\n         * @param {String} textOrHtml The HTML or text to autolink matches within\n         *   (depending on if the {@link #urls}, {@link #email}, {@link #phone}, {@link #hashtag}, and {@link #mention} options are enabled).\n         * @return {String} The HTML, with matches automatically linked.\n         */\n        Autolinker.prototype.link = function (textOrHtml) {\n            if (!textOrHtml) {\n                return \"\";\n            } // handle `null` and `undefined`\n            var matches = this.parse(textOrHtml), newHtml = [], lastIndex = 0;\n            for (var i = 0, len = matches.length; i < len; i++) {\n                var match = matches[i];\n                newHtml.push(textOrHtml.substring(lastIndex, match.getOffset()));\n                newHtml.push(this.createMatchReturnVal(match));\n                lastIndex = match.getOffset() + match.getMatchedText().length;\n            }\n            newHtml.push(textOrHtml.substring(lastIndex)); // handle the text after the last match\n            return newHtml.join('');\n        };\n        /**\n         * Creates the return string value for a given match in the input string.\n         *\n         * This method handles the {@link #replaceFn}, if one was provided.\n         *\n         * @private\n         * @param {Autolinker.match.Match} match The Match object that represents\n         *   the match.\n         * @return {String} The string that the `match` should be replaced with.\n         *   This is usually the anchor tag string, but may be the `matchStr` itself\n         *   if the match is not to be replaced.\n         */\n        Autolinker.prototype.createMatchReturnVal = function (match) {\n            // Handle a custom `replaceFn` being provided\n            var replaceFnResult;\n            if (this.replaceFn) {\n                replaceFnResult = this.replaceFn.call(this.context, match); // Autolinker instance is the context\n            }\n            if (typeof replaceFnResult === 'string') {\n                return replaceFnResult; // `replaceFn` returned a string, use that\n            }\n            else if (replaceFnResult === false) {\n                return match.getMatchedText(); // no replacement for the match\n            }\n            else if (replaceFnResult instanceof HtmlTag) {\n                return replaceFnResult.toAnchorString();\n            }\n            else { // replaceFnResult === true, or no/unknown return value from function\n                // Perform Autolinker's default anchor tag generation\n                var anchorTag = match.buildTag(); // returns an Autolinker.HtmlTag instance\n                return anchorTag.toAnchorString();\n            }\n        };\n        /**\n         * Lazily instantiates and returns the {@link Autolinker.matcher.Matcher}\n         * instances for this Autolinker instance.\n         *\n         * @private\n         * @return {Autolinker.matcher.Matcher[]}\n         */\n        Autolinker.prototype.getMatchers = function () {\n            if (!this.matchers) {\n                var tagBuilder = this.getTagBuilder();\n                var matchers = [\n                    new HashtagMatcher({ tagBuilder: tagBuilder, serviceName: this.hashtag }),\n                    new EmailMatcher({ tagBuilder: tagBuilder }),\n                    new PhoneMatcher({ tagBuilder: tagBuilder }),\n                    new MentionMatcher({ tagBuilder: tagBuilder, serviceName: this.mention }),\n                    new UrlMatcher({ tagBuilder: tagBuilder, stripPrefix: this.stripPrefix, stripTrailingSlash: this.stripTrailingSlash, decodePercentEncoding: this.decodePercentEncoding })\n                ];\n                return (this.matchers = matchers);\n            }\n            else {\n                return this.matchers;\n            }\n        };\n        /**\n         * Returns the {@link #tagBuilder} instance for this Autolinker instance,\n         * lazily instantiating it if it does not yet exist.\n         *\n         * @private\n         * @return {Autolinker.AnchorTagBuilder}\n         */\n        Autolinker.prototype.getTagBuilder = function () {\n            var tagBuilder = this.tagBuilder;\n            if (!tagBuilder) {\n                tagBuilder = this.tagBuilder = new AnchorTagBuilder({\n                    newWindow: this.newWindow,\n                    truncate: this.truncate,\n                    className: this.className\n                });\n            }\n            return tagBuilder;\n        };\n        /**\n         * @static\n         * @property {String} version\n         *\n         * The Autolinker version number in the form major.minor.patch\n         *\n         * Ex: 0.25.1\n         */\n        Autolinker.version = '3.11.0';\n        /**\n         * For backwards compatibility with Autolinker 1.x, the AnchorTagBuilder\n         * class is provided as a static on the Autolinker class.\n         */\n        Autolinker.AnchorTagBuilder = AnchorTagBuilder;\n        /**\n         * For backwards compatibility with Autolinker 1.x, the HtmlTag class is\n         * provided as a static on the Autolinker class.\n         */\n        Autolinker.HtmlTag = HtmlTag;\n        /**\n         * For backwards compatibility with Autolinker 1.x, the Matcher classes are\n         * provided as statics on the Autolinker class.\n         */\n        Autolinker.matcher = {\n            Email: EmailMatcher,\n            Hashtag: HashtagMatcher,\n            Matcher: Matcher,\n            Mention: MentionMatcher,\n            Phone: PhoneMatcher,\n            Url: UrlMatcher\n        };\n        /**\n         * For backwards compatibility with Autolinker 1.x, the Match classes are\n         * provided as statics on the Autolinker class.\n         */\n        Autolinker.match = {\n            Email: EmailMatch,\n            Hashtag: HashtagMatch,\n            Match: Match,\n            Mention: MentionMatch,\n            Phone: PhoneMatch,\n            Url: UrlMatch\n        };\n        return Autolinker;\n    }());\n\n    return Autolinker;\n\n}));\n\n\n//# sourceMappingURL=Autolinker.js.map\n\nexport default tmp.Autolinker;\n","/**\n * Representation of <Camera> from KML\n * @alias KmlCamera\n * @constructor\n *\n * @param {Cartesian3} position camera position\n * @param {HeadingPitchRoll} headingPitchRoll camera orientation\n */\nfunction KmlCamera(position, headingPitchRoll) {\n  this.position = position;\n  this.headingPitchRoll = headingPitchRoll;\n}\nexport default KmlCamera;\n","/**\n * @alias KmlLookAt\n * @constructor\n *\n * @param {Cartesian3} position camera position\n * @param {HeadingPitchRange} headingPitchRange camera orientation\n */\nfunction KmlLookAt(position, headingPitchRange) {\n  this.position = position;\n  this.headingPitchRange = headingPitchRange;\n}\nexport default KmlLookAt;\n","import defined from \"../Core/defined.js\";\nimport Event from \"../Core/Event.js\";\n/**\n * @alias KmlTour\n * @constructor\n *\n * @param {String} name name parsed from KML\n * @param {String} id id parsed from KML\n * @param {Array} playlist array with KMLTourFlyTos, KMLTourWaits and KMLTourSoundCues\n */\nfunction KmlTour(name, id) {\n  /**\n   * Id of kml gx:Tour entry\n   * @type String\n   */\n  this.id = id;\n  /**\n   * Tour name\n   * @type String\n   */\n  this.name = name;\n  /**\n   * Index of current entry from playlist\n   * @type Number\n   */\n  this.playlistIndex = 0;\n  /**\n   * Array of playlist entries\n   * @type Array\n   */\n  this.playlist = [];\n  /**\n   * Event will be called when tour starts to play,\n   * before any playlist entry starts to play.\n   * @type Event\n   */\n  this.tourStart = new Event();\n  /**\n   * Event will be called when all playlist entries are\n   * played, or tour playback being canceled.\n   *\n   * If tour playback was terminated, event callback will\n   * be called with terminated=true parameter.\n   * @type Event\n   */\n  this.tourEnd = new Event();\n  /**\n   * Event will be called when entry from playlist starts to play.\n   *\n   * Event callback will be called with curent entry as first parameter.\n   * @type Event\n   */\n  this.entryStart = new Event();\n  /**\n   * Event will be called when entry from playlist ends to play.\n   *\n   * Event callback will be called with following parameters:\n   * 1. entry - entry\n   * 2. terminated - true if playback was terminated by calling {@link KmlTour#stop}\n   * @type Event\n   */\n  this.entryEnd = new Event();\n\n  this._activeEntries = [];\n}\n\n/**\n * Add entry to this tour playlist.\n *\n * @param {KmlTourFlyTo|KmlTourWait} entry an entry to add to the playlist.\n */\nKmlTour.prototype.addPlaylistEntry = function (entry) {\n  this.playlist.push(entry);\n};\n\n/**\n * Play this tour.\n *\n * @param {Viewer} viewer viewer widget.\n * @param {Object} [cameraOptions] these options will be merged with {@link Camera#flyTo}\n * options for FlyTo playlist entries.\n */\nKmlTour.prototype.play = function (viewer, cameraOptions) {\n  this.tourStart.raiseEvent();\n\n  var tour = this;\n  playEntry.call(this, viewer, cameraOptions, function (terminated) {\n    tour.playlistIndex = 0;\n    // Stop nonblocking entries\n    if (!terminated) {\n      cancelAllEntries(tour._activeEntries);\n    }\n    tour.tourEnd.raiseEvent(terminated);\n  });\n};\n\n/**\n * Stop curently playing tour.\n */\nKmlTour.prototype.stop = function () {\n  cancelAllEntries(this._activeEntries);\n};\n\n// Stop all activeEntries.\nfunction cancelAllEntries(activeEntries) {\n  for (\n    var entry = activeEntries.pop();\n    entry !== undefined;\n    entry = activeEntries.pop()\n  ) {\n    entry.stop();\n  }\n}\n\n// Play playlist entry.\n// This function is called recursevly with playNext and iterates over all entries from playlist.\nfunction playEntry(viewer, cameraOptions, allDone) {\n  var entry = this.playlist[this.playlistIndex];\n  if (entry) {\n    var _playNext = playNext.bind(this, viewer, cameraOptions, allDone);\n    this._activeEntries.push(entry);\n    this.entryStart.raiseEvent(entry);\n    if (entry.blocking) {\n      entry.play(_playNext, viewer.scene.camera, cameraOptions);\n    } else {\n      var tour = this;\n      entry.play(function () {\n        tour.entryEnd.raiseEvent(entry);\n        var indx = tour._activeEntries.indexOf(entry);\n        if (indx >= 0) {\n          tour._activeEntries.splice(indx, 1);\n        }\n      });\n      _playNext(viewer, cameraOptions, allDone);\n    }\n  } else if (defined(allDone)) {\n    allDone(false);\n  }\n}\n\n// Increment playlistIndex and call playEntry if terminated isn't true.\nfunction playNext(viewer, cameraOptions, allDone, terminated) {\n  var entry = this.playlist[this.playlistIndex];\n  this.entryEnd.raiseEvent(entry, terminated);\n\n  if (terminated) {\n    allDone(terminated);\n  } else {\n    var indx = this._activeEntries.indexOf(entry);\n    if (indx >= 0) {\n      this._activeEntries.splice(indx, 1);\n    }\n    this.playlistIndex++;\n    playEntry.call(this, viewer, cameraOptions, allDone);\n  }\n}\nexport default KmlTour;\n","import BoundingSphere from \"../Core/BoundingSphere.js\";\nimport combine from \"../Core/combine.js\";\nimport defined from \"../Core/defined.js\";\nimport EasingFunction from \"../Core/EasingFunction.js\";\n/**\n * @alias KmlTourFlyTo\n * @constructor\n *\n * @param {Number} duration entry duration\n * @param {String} flyToMode KML fly to mode: bounce, smooth, etc\n * @param {KmlCamera|KmlLookAt} view KmlCamera or KmlLookAt\n */\nfunction KmlTourFlyTo(duration, flyToMode, view) {\n  this.type = \"KmlTourFlyTo\";\n  this.blocking = true;\n  this.activeCamera = null;\n  this.activeCallback = null;\n\n  this.duration = duration;\n  this.view = view;\n  this.flyToMode = flyToMode;\n}\n\n/**\n * Play this playlist entry\n *\n * @param {KmlTourFlyTo.DoneCallback} done function which will be called when playback ends\n * @param {Camera} camera Cesium camera\n * @param {Object} [cameraOptions] which will be merged with camera flyTo options. See {@link Camera#flyTo}\n */\nKmlTourFlyTo.prototype.play = function (done, camera, cameraOptions) {\n  this.activeCamera = camera;\n  if (defined(done) && done !== null) {\n    var self = this;\n    this.activeCallback = function (terminated) {\n      delete self.activeCallback;\n      delete self.activeCamera;\n      done(defined(terminated) ? false : terminated);\n    };\n  }\n\n  var options = this.getCameraOptions(cameraOptions);\n  if (this.view.headingPitchRoll) {\n    camera.flyTo(options);\n  } else if (this.view.headingPitchRange) {\n    var target = new BoundingSphere(this.view.position);\n    camera.flyToBoundingSphere(target, options);\n  }\n};\n\n/**\n * Stop execution of curent entry. Cancel camera flyTo\n */\nKmlTourFlyTo.prototype.stop = function () {\n  if (defined(this.activeCamera)) {\n    this.activeCamera.cancelFlight();\n  }\n  if (defined(this.activeCallback)) {\n    this.activeCallback(true);\n  }\n};\n\n/**\n * Returns options for {@link Camera#flyTo} or {@link Camera#flyToBoundingSphere}\n * depends on this.view type.\n *\n * @param {Object} cameraOptions options to merge with generated. See {@link Camera#flyTo}\n * @returns {Object} {@link Camera#flyTo} or {@link Camera#flyToBoundingSphere} options\n */\nKmlTourFlyTo.prototype.getCameraOptions = function (cameraOptions) {\n  var options = {\n    duration: this.duration,\n  };\n\n  if (defined(this.activeCallback)) {\n    options.complete = this.activeCallback;\n  }\n\n  if (this.flyToMode === \"smooth\") {\n    options.easingFunction = EasingFunction.LINEAR_NONE;\n  }\n\n  if (this.view.headingPitchRoll) {\n    options.destination = this.view.position;\n    options.orientation = this.view.headingPitchRoll;\n  } else if (this.view.headingPitchRange) {\n    options.offset = this.view.headingPitchRange;\n  }\n\n  if (defined(cameraOptions)) {\n    options = combine(options, cameraOptions);\n  }\n  return options;\n};\n\n/**\n * A function that will be executed when the flight completes.\n * @callback KmlTourFlyTo.DoneCallback\n *\n * @param {Boolean} terminated true if {@link KmlTourFlyTo#stop} was\n * called before entry done playback.\n */\nexport default KmlTourFlyTo;\n","import defined from \"../Core/defined.js\";\n/**\n * @alias KmlTourWait\n * @constructor\n *\n * @param {Number} duration entry duration\n */\nfunction KmlTourWait(duration) {\n  this.type = \"KmlTourWait\";\n  this.blocking = true;\n  this.duration = duration;\n\n  this.timeout = null;\n}\n\n/**\n * Play this playlist entry\n *\n * @param {KmlTourWait.DoneCallback} done function which will be called when playback ends\n */\nKmlTourWait.prototype.play = function (done) {\n  var self = this;\n  this.activeCallback = done;\n  this.timeout = setTimeout(function () {\n    delete self.activeCallback;\n    done(false);\n  }, this.duration * 1000);\n};\n\n/**\n * Stop execution of curent entry, cancel curent timeout\n */\nKmlTourWait.prototype.stop = function () {\n  clearTimeout(this.timeout);\n  if (defined(this.activeCallback)) {\n    this.activeCallback(true);\n  }\n};\n\n/**\n * A function which will be called when playback ends.\n *\n * @callback KmlTourWait.DoneCallback\n * @param {Boolean} terminated true if {@link KmlTourWait#stop} was\n * called before entry done playback.\n */\nexport default KmlTourWait;\n","import ArcType from \"../Core/ArcType.js\";\nimport AssociativeArray from \"../Core/AssociativeArray.js\";\nimport BoundingRectangle from \"../Core/BoundingRectangle.js\";\nimport Cartesian2 from \"../Core/Cartesian2.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Cartographic from \"../Core/Cartographic.js\";\nimport ClockRange from \"../Core/ClockRange.js\";\nimport ClockStep from \"../Core/ClockStep.js\";\nimport clone from \"../Core/clone.js\";\nimport Color from \"../Core/Color.js\";\nimport createGuid from \"../Core/createGuid.js\";\nimport Credit from \"../Core/Credit.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Ellipsoid from \"../Core/Ellipsoid.js\";\nimport Event from \"../Core/Event.js\";\nimport getExtensionFromUri from \"../Core/getExtensionFromUri.js\";\nimport getFilenameFromUri from \"../Core/getFilenameFromUri.js\";\nimport getTimestamp from \"../Core/getTimestamp.js\";\nimport HeadingPitchRange from \"../Core/HeadingPitchRange.js\";\nimport HeadingPitchRoll from \"../Core/HeadingPitchRoll.js\";\nimport Iso8601 from \"../Core/Iso8601.js\";\nimport JulianDate from \"../Core/JulianDate.js\";\nimport CesiumMath from \"../Core/Math.js\";\nimport NearFarScalar from \"../Core/NearFarScalar.js\";\nimport objectToQuery from \"../Core/objectToQuery.js\";\nimport oneTimeWarning from \"../Core/oneTimeWarning.js\";\nimport PinBuilder from \"../Core/PinBuilder.js\";\nimport PolygonHierarchy from \"../Core/PolygonHierarchy.js\";\nimport queryToObject from \"../Core/queryToObject.js\";\nimport Rectangle from \"../Core/Rectangle.js\";\nimport Resource from \"../Core/Resource.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport TimeInterval from \"../Core/TimeInterval.js\";\nimport TimeIntervalCollection from \"../Core/TimeIntervalCollection.js\";\nimport HeightReference from \"../Scene/HeightReference.js\";\nimport HorizontalOrigin from \"../Scene/HorizontalOrigin.js\";\nimport LabelStyle from \"../Scene/LabelStyle.js\";\nimport SceneMode from \"../Scene/SceneMode.js\";\nimport Autolinker from \"../ThirdParty/Autolinker.js\";\nimport Uri from \"../ThirdParty/Uri.js\";\nimport when from \"../ThirdParty/when.js\";\nimport zip from \"../ThirdParty/zip.js\";\nimport BillboardGraphics from \"./BillboardGraphics.js\";\nimport CompositePositionProperty from \"./CompositePositionProperty.js\";\nimport DataSource from \"./DataSource.js\";\nimport DataSourceClock from \"./DataSourceClock.js\";\nimport Entity from \"./Entity.js\";\nimport EntityCluster from \"./EntityCluster.js\";\nimport EntityCollection from \"./EntityCollection.js\";\nimport KmlCamera from \"./KmlCamera.js\";\nimport KmlLookAt from \"./KmlLookAt.js\";\nimport KmlTour from \"./KmlTour.js\";\nimport KmlTourFlyTo from \"./KmlTourFlyTo.js\";\nimport KmlTourWait from \"./KmlTourWait.js\";\nimport LabelGraphics from \"./LabelGraphics.js\";\nimport PathGraphics from \"./PathGraphics.js\";\nimport PolygonGraphics from \"./PolygonGraphics.js\";\nimport PolylineGraphics from \"./PolylineGraphics.js\";\nimport PositionPropertyArray from \"./PositionPropertyArray.js\";\nimport RectangleGraphics from \"./RectangleGraphics.js\";\nimport ReferenceProperty from \"./ReferenceProperty.js\";\nimport SampledPositionProperty from \"./SampledPositionProperty.js\";\nimport ScaledPositionProperty from \"./ScaledPositionProperty.js\";\nimport TimeIntervalCollectionProperty from \"./TimeIntervalCollectionProperty.js\";\nimport WallGraphics from \"./WallGraphics.js\";\n\n//This is by no means an exhaustive list of MIME types.\n//The purpose of this list is to be able to accurately identify content embedded\n//in KMZ files. Eventually, we can make this configurable by the end user so they can add\n//there own content types if they have KMZ files that require it.\nvar MimeTypes = {\n  avi: \"video/x-msvideo\",\n  bmp: \"image/bmp\",\n  bz2: \"application/x-bzip2\",\n  chm: \"application/vnd.ms-htmlhelp\",\n  css: \"text/css\",\n  csv: \"text/csv\",\n  doc: \"application/msword\",\n  dvi: \"application/x-dvi\",\n  eps: \"application/postscript\",\n  flv: \"video/x-flv\",\n  gif: \"image/gif\",\n  gz: \"application/x-gzip\",\n  htm: \"text/html\",\n  html: \"text/html\",\n  ico: \"image/vnd.microsoft.icon\",\n  jnlp: \"application/x-java-jnlp-file\",\n  jpeg: \"image/jpeg\",\n  jpg: \"image/jpeg\",\n  m3u: \"audio/x-mpegurl\",\n  m4v: \"video/mp4\",\n  mathml: \"application/mathml+xml\",\n  mid: \"audio/midi\",\n  midi: \"audio/midi\",\n  mov: \"video/quicktime\",\n  mp3: \"audio/mpeg\",\n  mp4: \"video/mp4\",\n  mp4v: \"video/mp4\",\n  mpeg: \"video/mpeg\",\n  mpg: \"video/mpeg\",\n  odp: \"application/vnd.oasis.opendocument.presentation\",\n  ods: \"application/vnd.oasis.opendocument.spreadsheet\",\n  odt: \"application/vnd.oasis.opendocument.text\",\n  ogg: \"application/ogg\",\n  pdf: \"application/pdf\",\n  png: \"image/png\",\n  pps: \"application/vnd.ms-powerpoint\",\n  ppt: \"application/vnd.ms-powerpoint\",\n  ps: \"application/postscript\",\n  qt: \"video/quicktime\",\n  rdf: \"application/rdf+xml\",\n  rss: \"application/rss+xml\",\n  rtf: \"application/rtf\",\n  svg: \"image/svg+xml\",\n  swf: \"application/x-shockwave-flash\",\n  text: \"text/plain\",\n  tif: \"image/tiff\",\n  tiff: \"image/tiff\",\n  txt: \"text/plain\",\n  wav: \"audio/x-wav\",\n  wma: \"audio/x-ms-wma\",\n  wmv: \"video/x-ms-wmv\",\n  xml: \"application/xml\",\n  zip: \"application/zip\",\n\n  detectFromFilename: function (filename) {\n    var ext = filename.toLowerCase();\n    ext = getExtensionFromUri(ext);\n    return MimeTypes[ext];\n  },\n};\n\nvar parser;\nif (typeof DOMParser !== \"undefined\") {\n  parser = new DOMParser();\n}\n\nvar autolinker = new Autolinker({\n  stripPrefix: false,\n  email: false,\n  replaceFn: function (match) {\n    if (!match.protocolUrlMatch) {\n      //Prevent matching of non-explicit urls.\n      //i.e. foo.id won't match but http://foo.id will\n      return false;\n    }\n  },\n});\n\nvar BILLBOARD_SIZE = 32;\n\nvar BILLBOARD_NEAR_DISTANCE = 2414016;\nvar BILLBOARD_NEAR_RATIO = 1.0;\nvar BILLBOARD_FAR_DISTANCE = 1.6093e7;\nvar BILLBOARD_FAR_RATIO = 0.1;\n\nvar kmlNamespaces = [\n  null,\n  undefined,\n  \"http://www.opengis.net/kml/2.2\",\n  \"http://earth.google.com/kml/2.2\",\n  \"http://earth.google.com/kml/2.1\",\n  \"http://earth.google.com/kml/2.0\",\n];\nvar gxNamespaces = [\"http://www.google.com/kml/ext/2.2\"];\nvar atomNamespaces = [\"http://www.w3.org/2005/Atom\"];\nvar namespaces = {\n  kml: kmlNamespaces,\n  gx: gxNamespaces,\n  atom: atomNamespaces,\n  kmlgx: kmlNamespaces.concat(gxNamespaces),\n};\n\n// Ensure Specs/Data/KML/unsupported.kml is kept up to date with these supported types\nvar featureTypes = {\n  Document: processDocument,\n  Folder: processFolder,\n  Placemark: processPlacemark,\n  NetworkLink: processNetworkLink,\n  GroundOverlay: processGroundOverlay,\n  PhotoOverlay: processUnsupportedFeature,\n  ScreenOverlay: processUnsupportedFeature,\n  Tour: processTour,\n};\n\nfunction DeferredLoading(dataSource) {\n  this._dataSource = dataSource;\n  this._deferred = when.defer();\n  this._stack = [];\n  this._promises = [];\n  this._timeoutSet = false;\n  this._used = false;\n\n  this._started = 0;\n  this._timeThreshold = 1000; // Initial load is 1 second\n}\n\nObject.defineProperties(DeferredLoading.prototype, {\n  dataSource: {\n    get: function () {\n      return this._dataSource;\n    },\n  },\n});\n\nDeferredLoading.prototype.addNodes = function (nodes, processingData) {\n  this._stack.push({\n    nodes: nodes,\n    index: 0,\n    processingData: processingData,\n  });\n  this._used = true;\n};\n\nDeferredLoading.prototype.addPromise = function (promise) {\n  this._promises.push(promise);\n};\n\nDeferredLoading.prototype.wait = function () {\n  // Case where we had a non-document/folder as the root\n  var deferred = this._deferred;\n  if (!this._used) {\n    deferred.resolve();\n  }\n\n  return when.join(deferred.promise, when.all(this._promises));\n};\n\nDeferredLoading.prototype.process = function () {\n  var isFirstCall = this._stack.length === 1;\n  if (isFirstCall) {\n    this._started = KmlDataSource._getTimestamp();\n  }\n\n  return this._process(isFirstCall);\n};\n\nDeferredLoading.prototype._giveUpTime = function () {\n  if (this._timeoutSet) {\n    // Timeout was already set so just return\n    return;\n  }\n\n  this._timeoutSet = true;\n  this._timeThreshold = 50; // After the first load lower threshold to 0.5 seconds\n  var that = this;\n  setTimeout(function () {\n    that._timeoutSet = false;\n    that._started = KmlDataSource._getTimestamp();\n    that._process(true);\n  }, 0);\n};\n\nDeferredLoading.prototype._nextNode = function () {\n  var stack = this._stack;\n  var top = stack[stack.length - 1];\n  var index = top.index;\n  var nodes = top.nodes;\n  if (index === nodes.length) {\n    return;\n  }\n  ++top.index;\n\n  return nodes[index];\n};\n\nDeferredLoading.prototype._pop = function () {\n  var stack = this._stack;\n  stack.pop();\n\n  // Return false if we are done\n  if (stack.length === 0) {\n    this._deferred.resolve();\n    return false;\n  }\n\n  return true;\n};\n\nDeferredLoading.prototype._process = function (isFirstCall) {\n  var dataSource = this.dataSource;\n  var processingData = this._stack[this._stack.length - 1].processingData;\n\n  var child = this._nextNode();\n  while (defined(child)) {\n    var featureProcessor = featureTypes[child.localName];\n    if (\n      defined(featureProcessor) &&\n      (namespaces.kml.indexOf(child.namespaceURI) !== -1 ||\n        namespaces.gx.indexOf(child.namespaceURI) !== -1)\n    ) {\n      featureProcessor(dataSource, child, processingData, this);\n\n      // Give up time and continue loading later\n      if (\n        this._timeoutSet ||\n        KmlDataSource._getTimestamp() > this._started + this._timeThreshold\n      ) {\n        this._giveUpTime();\n        return;\n      }\n    }\n\n    child = this._nextNode();\n  }\n\n  // If we are a recursive call from a subfolder, just return so the parent folder can continue processing\n  // If we aren't then make another call to processNodes because there is stuff still left in the queue\n  if (this._pop() && isFirstCall) {\n    this._process(true);\n  }\n};\n\nfunction isZipFile(blob) {\n  var magicBlob = blob.slice(0, Math.min(4, blob.size));\n  var deferred = when.defer();\n  var reader = new FileReader();\n  reader.addEventListener(\"load\", function () {\n    deferred.resolve(\n      new DataView(reader.result).getUint32(0, false) === 0x504b0304\n    );\n  });\n  reader.addEventListener(\"error\", function () {\n    deferred.reject(reader.error);\n  });\n  reader.readAsArrayBuffer(magicBlob);\n  return deferred.promise;\n}\n\nfunction readBlobAsText(blob) {\n  var deferred = when.defer();\n  var reader = new FileReader();\n  reader.addEventListener(\"load\", function () {\n    deferred.resolve(reader.result);\n  });\n  reader.addEventListener(\"error\", function () {\n    deferred.reject(reader.error);\n  });\n  reader.readAsText(blob);\n  return deferred.promise;\n}\n\nfunction insertNamespaces(text) {\n  var namespaceMap = {\n    xsi: \"http://www.w3.org/2001/XMLSchema-instance\",\n  };\n  var firstPart, lastPart, reg, declaration;\n\n  for (var key in namespaceMap) {\n    if (namespaceMap.hasOwnProperty(key)) {\n      reg = RegExp(\"[< ]\" + key + \":\");\n      declaration = \"xmlns:\" + key + \"=\";\n      if (reg.test(text) && text.indexOf(declaration) === -1) {\n        if (!defined(firstPart)) {\n          firstPart = text.substr(0, text.indexOf(\"<kml\") + 4);\n          lastPart = text.substr(firstPart.length);\n        }\n        firstPart += \" \" + declaration + '\"' + namespaceMap[key] + '\"';\n      }\n    }\n  }\n\n  if (defined(firstPart)) {\n    text = firstPart + lastPart;\n  }\n\n  return text;\n}\n\nfunction removeDuplicateNamespaces(text) {\n  var index = text.indexOf(\"xmlns:\");\n  var endDeclaration = text.indexOf(\">\", index);\n  var namespace, startIndex, endIndex;\n\n  while (index !== -1 && index < endDeclaration) {\n    namespace = text.slice(index, text.indexOf('\"', index));\n    startIndex = index;\n    index = text.indexOf(namespace, index + 1);\n    if (index !== -1) {\n      endIndex = text.indexOf('\"', text.indexOf('\"', index) + 1);\n      text = text.slice(0, index - 1) + text.slice(endIndex + 1, text.length);\n      index = text.indexOf(\"xmlns:\", startIndex - 1);\n    } else {\n      index = text.indexOf(\"xmlns:\", startIndex + 1);\n    }\n  }\n\n  return text;\n}\n\nfunction loadXmlFromZip(entry, uriResolver, deferred) {\n  entry.getData(new zip.TextWriter(), function (text) {\n    text = insertNamespaces(text);\n    text = removeDuplicateNamespaces(text);\n    uriResolver.kml = parser.parseFromString(text, \"application/xml\");\n    deferred.resolve();\n  });\n}\n\nfunction loadDataUriFromZip(entry, uriResolver, deferred) {\n  var mimeType = defaultValue(\n    MimeTypes.detectFromFilename(entry.filename),\n    \"application/octet-stream\"\n  );\n  entry.getData(new zip.Data64URIWriter(mimeType), function (dataUri) {\n    uriResolver[entry.filename] = dataUri;\n    deferred.resolve();\n  });\n}\n\nfunction embedDataUris(div, elementType, attributeName, uriResolver) {\n  var keys = uriResolver.keys;\n  var baseUri = new Uri(\".\");\n  var elements = div.querySelectorAll(elementType);\n  for (var i = 0; i < elements.length; i++) {\n    var element = elements[i];\n    var value = element.getAttribute(attributeName);\n    var uri = new Uri(value).resolve(baseUri).toString();\n    var index = keys.indexOf(uri);\n    if (index !== -1) {\n      var key = keys[index];\n      element.setAttribute(attributeName, uriResolver[key]);\n      if (elementType === \"a\" && element.getAttribute(\"download\") === null) {\n        element.setAttribute(\"download\", key);\n      }\n    }\n  }\n}\n\nfunction applyBasePath(div, elementType, attributeName, sourceResource) {\n  var elements = div.querySelectorAll(elementType);\n  for (var i = 0; i < elements.length; i++) {\n    var element = elements[i];\n    var value = element.getAttribute(attributeName);\n    var resource = resolveHref(value, sourceResource);\n    element.setAttribute(attributeName, resource.url);\n  }\n}\n\n// an optional context is passed to allow for some malformed kmls (those with multiple geometries with same ids) to still parse\n// correctly, as they do in Google Earth.\nfunction createEntity(node, entityCollection, context) {\n  var id = queryStringAttribute(node, \"id\");\n  id = defined(id) && id.length !== 0 ? id : createGuid();\n  if (defined(context)) {\n    id = context + id;\n  }\n\n  // If we have a duplicate ID just generate one.\n  // This isn't valid KML but Google Earth handles this case.\n  var entity = entityCollection.getById(id);\n  if (defined(entity)) {\n    id = createGuid();\n    if (defined(context)) {\n      id = context + id;\n    }\n  }\n\n  entity = entityCollection.add(new Entity({ id: id }));\n  if (!defined(entity.kml)) {\n    entity.addProperty(\"kml\");\n    entity.kml = new KmlFeatureData();\n  }\n  return entity;\n}\n\nfunction isExtrudable(altitudeMode, gxAltitudeMode) {\n  return (\n    altitudeMode === \"absolute\" ||\n    altitudeMode === \"relativeToGround\" ||\n    gxAltitudeMode === \"relativeToSeaFloor\"\n  );\n}\n\nfunction readCoordinate(value, ellipsoid) {\n  //Google Earth treats empty or missing coordinates as 0.\n  if (!defined(value)) {\n    return Cartesian3.fromDegrees(0, 0, 0, ellipsoid);\n  }\n\n  var digits = value.match(/[^\\s,\\n]+/g);\n  if (!defined(digits)) {\n    return Cartesian3.fromDegrees(0, 0, 0, ellipsoid);\n  }\n\n  var longitude = parseFloat(digits[0]);\n  var latitude = parseFloat(digits[1]);\n  var height = parseFloat(digits[2]);\n\n  longitude = isNaN(longitude) ? 0.0 : longitude;\n  latitude = isNaN(latitude) ? 0.0 : latitude;\n  height = isNaN(height) ? 0.0 : height;\n\n  return Cartesian3.fromDegrees(longitude, latitude, height, ellipsoid);\n}\n\nfunction readCoordinates(element, ellipsoid) {\n  if (!defined(element)) {\n    return undefined;\n  }\n\n  var tuples = element.textContent.match(/[^\\s\\n]+/g);\n  if (!defined(tuples)) {\n    return undefined;\n  }\n\n  var length = tuples.length;\n  var result = new Array(length);\n  var resultIndex = 0;\n  for (var i = 0; i < length; i++) {\n    result[resultIndex++] = readCoordinate(tuples[i], ellipsoid);\n  }\n  return result;\n}\n\nfunction queryNumericAttribute(node, attributeName) {\n  if (!defined(node)) {\n    return undefined;\n  }\n\n  var value = node.getAttribute(attributeName);\n  if (value !== null) {\n    var result = parseFloat(value);\n    return !isNaN(result) ? result : undefined;\n  }\n  return undefined;\n}\n\nfunction queryStringAttribute(node, attributeName) {\n  if (!defined(node)) {\n    return undefined;\n  }\n  var value = node.getAttribute(attributeName);\n  return value !== null ? value : undefined;\n}\n\nfunction queryFirstNode(node, tagName, namespace) {\n  if (!defined(node)) {\n    return undefined;\n  }\n  var childNodes = node.childNodes;\n  var length = childNodes.length;\n  for (var q = 0; q < length; q++) {\n    var child = childNodes[q];\n    if (\n      child.localName === tagName &&\n      namespace.indexOf(child.namespaceURI) !== -1\n    ) {\n      return child;\n    }\n  }\n  return undefined;\n}\n\nfunction queryNodes(node, tagName, namespace) {\n  if (!defined(node)) {\n    return undefined;\n  }\n  var result = [];\n  var childNodes = node.getElementsByTagNameNS(\"*\", tagName);\n  var length = childNodes.length;\n  for (var q = 0; q < length; q++) {\n    var child = childNodes[q];\n    if (\n      child.localName === tagName &&\n      namespace.indexOf(child.namespaceURI) !== -1\n    ) {\n      result.push(child);\n    }\n  }\n  return result;\n}\n\nfunction queryChildNodes(node, tagName, namespace) {\n  if (!defined(node)) {\n    return [];\n  }\n  var result = [];\n  var childNodes = node.childNodes;\n  var length = childNodes.length;\n  for (var q = 0; q < length; q++) {\n    var child = childNodes[q];\n    if (\n      child.localName === tagName &&\n      namespace.indexOf(child.namespaceURI) !== -1\n    ) {\n      result.push(child);\n    }\n  }\n  return result;\n}\n\nfunction queryNumericValue(node, tagName, namespace) {\n  var resultNode = queryFirstNode(node, tagName, namespace);\n  if (defined(resultNode)) {\n    var result = parseFloat(resultNode.textContent);\n    return !isNaN(result) ? result : undefined;\n  }\n  return undefined;\n}\n\nfunction queryStringValue(node, tagName, namespace) {\n  var result = queryFirstNode(node, tagName, namespace);\n  if (defined(result)) {\n    return result.textContent.trim();\n  }\n  return undefined;\n}\n\nfunction queryBooleanValue(node, tagName, namespace) {\n  var result = queryFirstNode(node, tagName, namespace);\n  if (defined(result)) {\n    var value = result.textContent.trim();\n    return value === \"1\" || /^true$/i.test(value);\n  }\n  return undefined;\n}\n\nfunction resolveHref(href, sourceResource, uriResolver) {\n  if (!defined(href)) {\n    return undefined;\n  }\n\n  var resource;\n  if (defined(uriResolver)) {\n    // To resolve issues with KML sources defined in Windows style paths.\n    href = href.replace(/\\\\/g, \"/\");\n    var blob = uriResolver[href];\n    if (defined(blob)) {\n      resource = new Resource({\n        url: blob,\n      });\n    } else {\n      // Needed for multiple levels of KML files in a KMZ\n      var baseUri = new Uri(sourceResource.getUrlComponent());\n      var uri = new Uri(href);\n      blob = uriResolver[uri.resolve(baseUri)];\n      if (defined(blob)) {\n        resource = new Resource({\n          url: blob,\n        });\n      }\n    }\n  }\n\n  if (!defined(resource)) {\n    resource = sourceResource.getDerivedResource({\n      url: href,\n    });\n  }\n\n  return resource;\n}\n\nvar colorOptions = {\n  maximumRed: undefined,\n  red: undefined,\n  maximumGreen: undefined,\n  green: undefined,\n  maximumBlue: undefined,\n  blue: undefined,\n};\n\nfunction parseColorString(value, isRandom) {\n  if (!defined(value) || /^\\s*$/gm.test(value)) {\n    return undefined;\n  }\n\n  if (value[0] === \"#\") {\n    value = value.substring(1);\n  }\n\n  var alpha = parseInt(value.substring(0, 2), 16) / 255.0;\n  var blue = parseInt(value.substring(2, 4), 16) / 255.0;\n  var green = parseInt(value.substring(4, 6), 16) / 255.0;\n  var red = parseInt(value.substring(6, 8), 16) / 255.0;\n\n  if (!isRandom) {\n    return new Color(red, green, blue, alpha);\n  }\n\n  if (red > 0) {\n    colorOptions.maximumRed = red;\n    colorOptions.red = undefined;\n  } else {\n    colorOptions.maximumRed = undefined;\n    colorOptions.red = 0;\n  }\n  if (green > 0) {\n    colorOptions.maximumGreen = green;\n    colorOptions.green = undefined;\n  } else {\n    colorOptions.maximumGreen = undefined;\n    colorOptions.green = 0;\n  }\n  if (blue > 0) {\n    colorOptions.maximumBlue = blue;\n    colorOptions.blue = undefined;\n  } else {\n    colorOptions.maximumBlue = undefined;\n    colorOptions.blue = 0;\n  }\n  colorOptions.alpha = alpha;\n  return Color.fromRandom(colorOptions);\n}\n\nfunction queryColorValue(node, tagName, namespace) {\n  var value = queryStringValue(node, tagName, namespace);\n  if (!defined(value)) {\n    return undefined;\n  }\n  return parseColorString(\n    value,\n    queryStringValue(node, \"colorMode\", namespace) === \"random\"\n  );\n}\n\nfunction processTimeStamp(featureNode) {\n  var node = queryFirstNode(featureNode, \"TimeStamp\", namespaces.kmlgx);\n  var whenString = queryStringValue(node, \"when\", namespaces.kmlgx);\n\n  if (!defined(node) || !defined(whenString) || whenString.length === 0) {\n    return undefined;\n  }\n\n  //According to the KML spec, a TimeStamp represents a \"single moment in time\"\n  //However, since Cesium animates much differently than Google Earth, that doesn't\n  //Make much sense here.  Instead, we use the TimeStamp as the moment the feature\n  //comes into existence.  This works much better and gives a similar feel to\n  //GE's experience.\n  var when = JulianDate.fromIso8601(whenString);\n  var result = new TimeIntervalCollection();\n  result.addInterval(\n    new TimeInterval({\n      start: when,\n      stop: Iso8601.MAXIMUM_VALUE,\n    })\n  );\n  return result;\n}\n\nfunction processTimeSpan(featureNode) {\n  var node = queryFirstNode(featureNode, \"TimeSpan\", namespaces.kmlgx);\n  if (!defined(node)) {\n    return undefined;\n  }\n  var result;\n\n  var beginNode = queryFirstNode(node, \"begin\", namespaces.kmlgx);\n  var beginDate = defined(beginNode)\n    ? JulianDate.fromIso8601(beginNode.textContent)\n    : undefined;\n\n  var endNode = queryFirstNode(node, \"end\", namespaces.kmlgx);\n  var endDate = defined(endNode)\n    ? JulianDate.fromIso8601(endNode.textContent)\n    : undefined;\n\n  if (defined(beginDate) && defined(endDate)) {\n    if (JulianDate.lessThan(endDate, beginDate)) {\n      var tmp = beginDate;\n      beginDate = endDate;\n      endDate = tmp;\n    }\n    result = new TimeIntervalCollection();\n    result.addInterval(\n      new TimeInterval({\n        start: beginDate,\n        stop: endDate,\n      })\n    );\n  } else if (defined(beginDate)) {\n    result = new TimeIntervalCollection();\n    result.addInterval(\n      new TimeInterval({\n        start: beginDate,\n        stop: Iso8601.MAXIMUM_VALUE,\n      })\n    );\n  } else if (defined(endDate)) {\n    result = new TimeIntervalCollection();\n    result.addInterval(\n      new TimeInterval({\n        start: Iso8601.MINIMUM_VALUE,\n        stop: endDate,\n      })\n    );\n  }\n\n  return result;\n}\n\nfunction createDefaultBillboard() {\n  var billboard = new BillboardGraphics();\n  billboard.width = BILLBOARD_SIZE;\n  billboard.height = BILLBOARD_SIZE;\n  billboard.scaleByDistance = new NearFarScalar(\n    BILLBOARD_NEAR_DISTANCE,\n    BILLBOARD_NEAR_RATIO,\n    BILLBOARD_FAR_DISTANCE,\n    BILLBOARD_FAR_RATIO\n  );\n  billboard.pixelOffsetScaleByDistance = new NearFarScalar(\n    BILLBOARD_NEAR_DISTANCE,\n    BILLBOARD_NEAR_RATIO,\n    BILLBOARD_FAR_DISTANCE,\n    BILLBOARD_FAR_RATIO\n  );\n  return billboard;\n}\n\nfunction createDefaultPolygon() {\n  var polygon = new PolygonGraphics();\n  polygon.outline = true;\n  polygon.outlineColor = Color.WHITE;\n  return polygon;\n}\n\nfunction createDefaultLabel() {\n  var label = new LabelGraphics();\n  label.translucencyByDistance = new NearFarScalar(3000000, 1.0, 5000000, 0.0);\n  label.pixelOffset = new Cartesian2(17, 0);\n  label.horizontalOrigin = HorizontalOrigin.LEFT;\n  label.font = \"16px sans-serif\";\n  label.style = LabelStyle.FILL_AND_OUTLINE;\n  return label;\n}\n\nfunction getIconHref(\n  iconNode,\n  dataSource,\n  sourceResource,\n  uriResolver,\n  canRefresh\n) {\n  var href = queryStringValue(iconNode, \"href\", namespaces.kml);\n  if (!defined(href) || href.length === 0) {\n    return undefined;\n  }\n\n  if (href.indexOf(\"root://icons/palette-\") === 0) {\n    var palette = href.charAt(21);\n\n    // Get the icon number\n    var x = defaultValue(queryNumericValue(iconNode, \"x\", namespaces.gx), 0);\n    var y = defaultValue(queryNumericValue(iconNode, \"y\", namespaces.gx), 0);\n    x = Math.min(x / 32, 7);\n    y = 7 - Math.min(y / 32, 7);\n    var iconNum = 8 * y + x;\n\n    href =\n      \"https://maps.google.com/mapfiles/kml/pal\" +\n      palette +\n      \"/icon\" +\n      iconNum +\n      \".png\";\n  }\n\n  var hrefResource = resolveHref(href, sourceResource, uriResolver);\n\n  if (canRefresh) {\n    var refreshMode = queryStringValue(iconNode, \"refreshMode\", namespaces.kml);\n    var viewRefreshMode = queryStringValue(\n      iconNode,\n      \"viewRefreshMode\",\n      namespaces.kml\n    );\n    if (refreshMode === \"onInterval\" || refreshMode === \"onExpire\") {\n      oneTimeWarning(\n        \"kml-refreshMode-\" + refreshMode,\n        \"KML - Unsupported Icon refreshMode: \" + refreshMode\n      );\n    } else if (viewRefreshMode === \"onStop\" || viewRefreshMode === \"onRegion\") {\n      oneTimeWarning(\n        \"kml-refreshMode-\" + viewRefreshMode,\n        \"KML - Unsupported Icon viewRefreshMode: \" + viewRefreshMode\n      );\n    }\n\n    var viewBoundScale = defaultValue(\n      queryStringValue(iconNode, \"viewBoundScale\", namespaces.kml),\n      1.0\n    );\n    var defaultViewFormat =\n      viewRefreshMode === \"onStop\"\n        ? \"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]\"\n        : \"\";\n    var viewFormat = defaultValue(\n      queryStringValue(iconNode, \"viewFormat\", namespaces.kml),\n      defaultViewFormat\n    );\n    var httpQuery = queryStringValue(iconNode, \"httpQuery\", namespaces.kml);\n    if (defined(viewFormat)) {\n      hrefResource.setQueryParameters(queryToObject(cleanupString(viewFormat)));\n    }\n    if (defined(httpQuery)) {\n      hrefResource.setQueryParameters(queryToObject(cleanupString(httpQuery)));\n    }\n\n    var ellipsoid = dataSource._ellipsoid;\n    processNetworkLinkQueryString(\n      hrefResource,\n      dataSource._camera,\n      dataSource._canvas,\n      viewBoundScale,\n      dataSource._lastCameraView.bbox,\n      ellipsoid\n    );\n\n    return hrefResource;\n  }\n\n  return hrefResource;\n}\n\nfunction processBillboardIcon(\n  dataSource,\n  node,\n  targetEntity,\n  sourceResource,\n  uriResolver\n) {\n  var scale = queryNumericValue(node, \"scale\", namespaces.kml);\n  var heading = queryNumericValue(node, \"heading\", namespaces.kml);\n  var color = queryColorValue(node, \"color\", namespaces.kml);\n\n  var iconNode = queryFirstNode(node, \"Icon\", namespaces.kml);\n  var icon = getIconHref(\n    iconNode,\n    dataSource,\n    sourceResource,\n    uriResolver,\n    false\n  );\n\n  // If icon tags are present but blank, we do not want to show an icon\n  if (defined(iconNode) && !defined(icon)) {\n    icon = false;\n  }\n\n  var x = queryNumericValue(iconNode, \"x\", namespaces.gx);\n  var y = queryNumericValue(iconNode, \"y\", namespaces.gx);\n  var w = queryNumericValue(iconNode, \"w\", namespaces.gx);\n  var h = queryNumericValue(iconNode, \"h\", namespaces.gx);\n\n  var hotSpotNode = queryFirstNode(node, \"hotSpot\", namespaces.kml);\n  var hotSpotX = queryNumericAttribute(hotSpotNode, \"x\");\n  var hotSpotY = queryNumericAttribute(hotSpotNode, \"y\");\n  var hotSpotXUnit = queryStringAttribute(hotSpotNode, \"xunits\");\n  var hotSpotYUnit = queryStringAttribute(hotSpotNode, \"yunits\");\n\n  var billboard = targetEntity.billboard;\n  if (!defined(billboard)) {\n    billboard = createDefaultBillboard();\n    targetEntity.billboard = billboard;\n  }\n\n  billboard.image = icon;\n  billboard.scale = scale;\n  billboard.color = color;\n\n  if (defined(x) || defined(y) || defined(w) || defined(h)) {\n    billboard.imageSubRegion = new BoundingRectangle(x, y, w, h);\n  }\n\n  //GE treats a heading of zero as no heading\n  //You can still point north using a 360 degree angle (or any multiple of 360)\n  if (defined(heading) && heading !== 0) {\n    billboard.rotation = CesiumMath.toRadians(-heading);\n    billboard.alignedAxis = Cartesian3.UNIT_Z;\n  }\n\n  //Hotpot is the KML equivalent of pixel offset\n  //The hotspot origin is the lower left, but we leave\n  //our billboard origin at the center and simply\n  //modify the pixel offset to take this into account\n  scale = defaultValue(scale, 1.0);\n\n  var xOffset;\n  var yOffset;\n  if (defined(hotSpotX)) {\n    if (hotSpotXUnit === \"pixels\") {\n      xOffset = -hotSpotX * scale;\n    } else if (hotSpotXUnit === \"insetPixels\") {\n      xOffset = (hotSpotX - BILLBOARD_SIZE) * scale;\n    } else if (hotSpotXUnit === \"fraction\") {\n      xOffset = -hotSpotX * BILLBOARD_SIZE * scale;\n    }\n    xOffset += BILLBOARD_SIZE * 0.5 * scale;\n  }\n\n  if (defined(hotSpotY)) {\n    if (hotSpotYUnit === \"pixels\") {\n      yOffset = hotSpotY * scale;\n    } else if (hotSpotYUnit === \"insetPixels\") {\n      yOffset = (-hotSpotY + BILLBOARD_SIZE) * scale;\n    } else if (hotSpotYUnit === \"fraction\") {\n      yOffset = hotSpotY * BILLBOARD_SIZE * scale;\n    }\n\n    yOffset -= BILLBOARD_SIZE * 0.5 * scale;\n  }\n\n  if (defined(xOffset) || defined(yOffset)) {\n    billboard.pixelOffset = new Cartesian2(xOffset, yOffset);\n  }\n}\n\nfunction applyStyle(\n  dataSource,\n  styleNode,\n  targetEntity,\n  sourceResource,\n  uriResolver\n) {\n  for (var i = 0, len = styleNode.childNodes.length; i < len; i++) {\n    var node = styleNode.childNodes.item(i);\n    if (node.localName === \"IconStyle\") {\n      processBillboardIcon(\n        dataSource,\n        node,\n        targetEntity,\n        sourceResource,\n        uriResolver\n      );\n    } else if (node.localName === \"LabelStyle\") {\n      var label = targetEntity.label;\n      if (!defined(label)) {\n        label = createDefaultLabel();\n        targetEntity.label = label;\n      }\n      label.scale = defaultValue(\n        queryNumericValue(node, \"scale\", namespaces.kml),\n        label.scale\n      );\n      label.fillColor = defaultValue(\n        queryColorValue(node, \"color\", namespaces.kml),\n        label.fillColor\n      );\n      label.text = targetEntity.name;\n    } else if (node.localName === \"LineStyle\") {\n      var polyline = targetEntity.polyline;\n      if (!defined(polyline)) {\n        polyline = new PolylineGraphics();\n        targetEntity.polyline = polyline;\n      }\n      polyline.width = queryNumericValue(node, \"width\", namespaces.kml);\n      polyline.material = queryColorValue(node, \"color\", namespaces.kml);\n      if (defined(queryColorValue(node, \"outerColor\", namespaces.gx))) {\n        oneTimeWarning(\n          \"kml-gx:outerColor\",\n          \"KML - gx:outerColor is not supported in a LineStyle\"\n        );\n      }\n      if (defined(queryNumericValue(node, \"outerWidth\", namespaces.gx))) {\n        oneTimeWarning(\n          \"kml-gx:outerWidth\",\n          \"KML - gx:outerWidth is not supported in a LineStyle\"\n        );\n      }\n      if (defined(queryNumericValue(node, \"physicalWidth\", namespaces.gx))) {\n        oneTimeWarning(\n          \"kml-gx:physicalWidth\",\n          \"KML - gx:physicalWidth is not supported in a LineStyle\"\n        );\n      }\n      if (defined(queryBooleanValue(node, \"labelVisibility\", namespaces.gx))) {\n        oneTimeWarning(\n          \"kml-gx:labelVisibility\",\n          \"KML - gx:labelVisibility is not supported in a LineStyle\"\n        );\n      }\n    } else if (node.localName === \"PolyStyle\") {\n      var polygon = targetEntity.polygon;\n      if (!defined(polygon)) {\n        polygon = createDefaultPolygon();\n        targetEntity.polygon = polygon;\n      }\n      polygon.material = defaultValue(\n        queryColorValue(node, \"color\", namespaces.kml),\n        polygon.material\n      );\n      polygon.fill = defaultValue(\n        queryBooleanValue(node, \"fill\", namespaces.kml),\n        polygon.fill\n      );\n      polygon.outline = defaultValue(\n        queryBooleanValue(node, \"outline\", namespaces.kml),\n        polygon.outline\n      );\n    } else if (node.localName === \"BalloonStyle\") {\n      var bgColor = defaultValue(\n        parseColorString(queryStringValue(node, \"bgColor\", namespaces.kml)),\n        Color.WHITE\n      );\n      var textColor = defaultValue(\n        parseColorString(queryStringValue(node, \"textColor\", namespaces.kml)),\n        Color.BLACK\n      );\n      var text = queryStringValue(node, \"text\", namespaces.kml);\n\n      //This is purely an internal property used in style processing,\n      //it never ends up on the final entity.\n      targetEntity.addProperty(\"balloonStyle\");\n      targetEntity.balloonStyle = {\n        bgColor: bgColor,\n        textColor: textColor,\n        text: text,\n      };\n    } else if (node.localName === \"ListStyle\") {\n      var listItemType = queryStringValue(node, \"listItemType\", namespaces.kml);\n      if (listItemType === \"radioFolder\" || listItemType === \"checkOffOnly\") {\n        oneTimeWarning(\n          \"kml-listStyle-\" + listItemType,\n          \"KML - Unsupported ListStyle with listItemType: \" + listItemType\n        );\n      }\n    }\n  }\n}\n\n//Processes and merges any inline styles for the provided node into the provided entity.\nfunction computeFinalStyle(\n  dataSource,\n  placeMark,\n  styleCollection,\n  sourceResource,\n  uriResolver\n) {\n  var result = new Entity();\n  var styleEntity;\n\n  //Google earth seems to always use the last inline Style/StyleMap only\n  var styleIndex = -1;\n  var childNodes = placeMark.childNodes;\n  var length = childNodes.length;\n  for (var q = 0; q < length; q++) {\n    var child = childNodes[q];\n    if (child.localName === \"Style\" || child.localName === \"StyleMap\") {\n      styleIndex = q;\n    }\n  }\n\n  if (styleIndex !== -1) {\n    var inlineStyleNode = childNodes[styleIndex];\n    if (inlineStyleNode.localName === \"Style\") {\n      applyStyle(\n        dataSource,\n        inlineStyleNode,\n        result,\n        sourceResource,\n        uriResolver\n      );\n    } else {\n      // StyleMap\n      var pairs = queryChildNodes(inlineStyleNode, \"Pair\", namespaces.kml);\n      for (var p = 0; p < pairs.length; p++) {\n        var pair = pairs[p];\n        var key = queryStringValue(pair, \"key\", namespaces.kml);\n        if (key === \"normal\") {\n          var styleUrl = queryStringValue(pair, \"styleUrl\", namespaces.kml);\n          if (defined(styleUrl)) {\n            styleEntity = styleCollection.getById(styleUrl);\n            if (!defined(styleEntity)) {\n              styleEntity = styleCollection.getById(\"#\" + styleUrl);\n            }\n            if (defined(styleEntity)) {\n              result.merge(styleEntity);\n            }\n          } else {\n            var node = queryFirstNode(pair, \"Style\", namespaces.kml);\n            applyStyle(dataSource, node, result, sourceResource, uriResolver);\n          }\n        } else {\n          oneTimeWarning(\n            \"kml-styleMap-\" + key,\n            \"KML - Unsupported StyleMap key: \" + key\n          );\n        }\n      }\n    }\n  }\n\n  //Google earth seems to always use the first external style only.\n  var externalStyle = queryStringValue(placeMark, \"styleUrl\", namespaces.kml);\n  if (defined(externalStyle)) {\n    var id = externalStyle;\n    if (externalStyle[0] !== \"#\" && externalStyle.indexOf(\"#\") !== -1) {\n      var tokens = externalStyle.split(\"#\");\n      var uri = tokens[0];\n      var resource = sourceResource.getDerivedResource({\n        url: uri,\n      });\n\n      id = resource.getUrlComponent() + \"#\" + tokens[1];\n    }\n\n    styleEntity = styleCollection.getById(id);\n    if (!defined(styleEntity)) {\n      styleEntity = styleCollection.getById(\"#\" + id);\n    }\n    if (defined(styleEntity)) {\n      result.merge(styleEntity);\n    }\n  }\n\n  return result;\n}\n\n//Asynchronously processes an external style file.\nfunction processExternalStyles(dataSource, resource, styleCollection) {\n  return resource.fetchXML().then(function (styleKml) {\n    return processStyles(dataSource, styleKml, styleCollection, resource, true);\n  });\n}\n\n//Processes all shared and external styles and stores\n//their id into the provided styleCollection.\n//Returns an array of promises that will resolve when\n//each style is loaded.\nfunction processStyles(\n  dataSource,\n  kml,\n  styleCollection,\n  sourceResource,\n  isExternal,\n  uriResolver\n) {\n  var i;\n  var id;\n  var styleEntity;\n\n  var node;\n  var styleNodes = queryNodes(kml, \"Style\", namespaces.kml);\n  if (defined(styleNodes)) {\n    var styleNodesLength = styleNodes.length;\n    for (i = 0; i < styleNodesLength; i++) {\n      node = styleNodes[i];\n      id = queryStringAttribute(node, \"id\");\n      if (defined(id)) {\n        id = \"#\" + id;\n        if (isExternal && defined(sourceResource)) {\n          id = sourceResource.getUrlComponent() + id;\n        }\n        if (!defined(styleCollection.getById(id))) {\n          styleEntity = new Entity({\n            id: id,\n          });\n          styleCollection.add(styleEntity);\n          applyStyle(\n            dataSource,\n            node,\n            styleEntity,\n            sourceResource,\n            uriResolver\n          );\n        }\n      }\n    }\n  }\n\n  var styleMaps = queryNodes(kml, \"StyleMap\", namespaces.kml);\n  if (defined(styleMaps)) {\n    var styleMapsLength = styleMaps.length;\n    for (i = 0; i < styleMapsLength; i++) {\n      var styleMap = styleMaps[i];\n      id = queryStringAttribute(styleMap, \"id\");\n      if (defined(id)) {\n        var pairs = queryChildNodes(styleMap, \"Pair\", namespaces.kml);\n        for (var p = 0; p < pairs.length; p++) {\n          var pair = pairs[p];\n          var key = queryStringValue(pair, \"key\", namespaces.kml);\n          if (key === \"normal\") {\n            id = \"#\" + id;\n            if (isExternal && defined(sourceResource)) {\n              id = sourceResource.getUrlComponent() + id;\n            }\n            if (!defined(styleCollection.getById(id))) {\n              styleEntity = styleCollection.getOrCreateEntity(id);\n\n              var styleUrl = queryStringValue(pair, \"styleUrl\", namespaces.kml);\n              if (defined(styleUrl)) {\n                if (styleUrl[0] !== \"#\") {\n                  styleUrl = \"#\" + styleUrl;\n                }\n\n                if (isExternal && defined(sourceResource)) {\n                  styleUrl = sourceResource.getUrlComponent() + styleUrl;\n                }\n                var base = styleCollection.getById(styleUrl);\n\n                if (defined(base)) {\n                  styleEntity.merge(base);\n                }\n              } else {\n                node = queryFirstNode(pair, \"Style\", namespaces.kml);\n                applyStyle(\n                  dataSource,\n                  node,\n                  styleEntity,\n                  sourceResource,\n                  uriResolver\n                );\n              }\n            }\n          } else {\n            oneTimeWarning(\n              \"kml-styleMap-\" + key,\n              \"KML - Unsupported StyleMap key: \" + key\n            );\n          }\n        }\n      }\n    }\n  }\n\n  var promises = [];\n  var styleUrlNodes = kml.getElementsByTagName(\"styleUrl\");\n  var styleUrlNodesLength = styleUrlNodes.length;\n  for (i = 0; i < styleUrlNodesLength; i++) {\n    var styleReference = styleUrlNodes[i].textContent;\n    if (styleReference[0] !== \"#\") {\n      //According to the spec, all local styles should start with a #\n      //and everything else is an external style that has a # seperating\n      //the URL of the document and the style.  However, Google Earth\n      //also accepts styleUrls without a # as meaning a local style.\n      var tokens = styleReference.split(\"#\");\n      if (tokens.length === 2) {\n        var uri = tokens[0];\n        var resource = sourceResource.getDerivedResource({\n          url: uri,\n        });\n\n        promises.push(\n          processExternalStyles(dataSource, resource, styleCollection)\n        );\n      }\n    }\n  }\n\n  return promises;\n}\n\nfunction createDropLine(entityCollection, entity, styleEntity) {\n  var entityPosition = new ReferenceProperty(entityCollection, entity.id, [\n    \"position\",\n  ]);\n  var surfacePosition = new ScaledPositionProperty(entity.position);\n  entity.polyline = defined(styleEntity.polyline)\n    ? styleEntity.polyline.clone()\n    : new PolylineGraphics();\n  entity.polyline.positions = new PositionPropertyArray([\n    entityPosition,\n    surfacePosition,\n  ]);\n}\n\nfunction heightReferenceFromAltitudeMode(altitudeMode, gxAltitudeMode) {\n  if (\n    (!defined(altitudeMode) && !defined(gxAltitudeMode)) ||\n    altitudeMode === \"clampToGround\"\n  ) {\n    return HeightReference.CLAMP_TO_GROUND;\n  }\n\n  if (altitudeMode === \"relativeToGround\") {\n    return HeightReference.RELATIVE_TO_GROUND;\n  }\n\n  if (altitudeMode === \"absolute\") {\n    return HeightReference.NONE;\n  }\n\n  if (gxAltitudeMode === \"clampToSeaFloor\") {\n    oneTimeWarning(\n      \"kml-gx:altitudeMode-clampToSeaFloor\",\n      \"KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround.\"\n    );\n    return HeightReference.CLAMP_TO_GROUND;\n  }\n\n  if (gxAltitudeMode === \"relativeToSeaFloor\") {\n    oneTimeWarning(\n      \"kml-gx:altitudeMode-relativeToSeaFloor\",\n      \"KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround.\"\n    );\n    return HeightReference.RELATIVE_TO_GROUND;\n  }\n\n  if (defined(altitudeMode)) {\n    oneTimeWarning(\n      \"kml-altitudeMode-unknown\",\n      \"KML - Unknown <kml:altitudeMode>:\" +\n        altitudeMode +\n        \", using <kml:altitudeMode>:CLAMP_TO_GROUND.\"\n    );\n  } else {\n    oneTimeWarning(\n      \"kml-gx:altitudeMode-unknown\",\n      \"KML - Unknown <gx:altitudeMode>:\" +\n        gxAltitudeMode +\n        \", using <kml:altitudeMode>:CLAMP_TO_GROUND.\"\n    );\n  }\n\n  // Clamp to ground is the default\n  return HeightReference.CLAMP_TO_GROUND;\n}\n\nfunction createPositionPropertyFromAltitudeMode(\n  property,\n  altitudeMode,\n  gxAltitudeMode\n) {\n  if (\n    gxAltitudeMode === \"relativeToSeaFloor\" ||\n    altitudeMode === \"absolute\" ||\n    altitudeMode === \"relativeToGround\"\n  ) {\n    //Just return the ellipsoid referenced property until we support MSL\n    return property;\n  }\n\n  if (\n    (defined(altitudeMode) && altitudeMode !== \"clampToGround\") || //\n    (defined(gxAltitudeMode) && gxAltitudeMode !== \"clampToSeaFloor\")\n  ) {\n    oneTimeWarning(\n      \"kml-altitudeMode-unknown\",\n      \"KML - Unknown altitudeMode: \" +\n        defaultValue(altitudeMode, gxAltitudeMode)\n    );\n  }\n\n  // Clamp to ground is the default\n  return new ScaledPositionProperty(property);\n}\n\nfunction createPositionPropertyArrayFromAltitudeMode(\n  properties,\n  altitudeMode,\n  gxAltitudeMode,\n  ellipsoid\n) {\n  if (!defined(properties)) {\n    return undefined;\n  }\n\n  if (\n    gxAltitudeMode === \"relativeToSeaFloor\" ||\n    altitudeMode === \"absolute\" ||\n    altitudeMode === \"relativeToGround\"\n  ) {\n    //Just return the ellipsoid referenced property until we support MSL\n    return properties;\n  }\n\n  if (\n    (defined(altitudeMode) && altitudeMode !== \"clampToGround\") || //\n    (defined(gxAltitudeMode) && gxAltitudeMode !== \"clampToSeaFloor\")\n  ) {\n    oneTimeWarning(\n      \"kml-altitudeMode-unknown\",\n      \"KML - Unknown altitudeMode: \" +\n        defaultValue(altitudeMode, gxAltitudeMode)\n    );\n  }\n\n  // Clamp to ground is the default\n  var propertiesLength = properties.length;\n  for (var i = 0; i < propertiesLength; i++) {\n    var property = properties[i];\n    ellipsoid.scaleToGeodeticSurface(property, property);\n  }\n  return properties;\n}\n\nfunction processPositionGraphics(\n  dataSource,\n  entity,\n  styleEntity,\n  heightReference\n) {\n  var label = entity.label;\n  if (!defined(label)) {\n    label = defined(styleEntity.label)\n      ? styleEntity.label.clone()\n      : createDefaultLabel();\n    entity.label = label;\n  }\n  label.text = entity.name;\n\n  var billboard = entity.billboard;\n  if (!defined(billboard)) {\n    billboard = defined(styleEntity.billboard)\n      ? styleEntity.billboard.clone()\n      : createDefaultBillboard();\n    entity.billboard = billboard;\n  }\n\n  if (!defined(billboard.image)) {\n    billboard.image = dataSource._pinBuilder.fromColor(Color.YELLOW, 64);\n\n    // If there were empty <Icon> tags in the KML, then billboard.image was set to false above\n    // However, in this case, the false value would have been converted to a property afterwards\n    // Thus, we check if billboard.image is defined with value of false\n  } else if (!billboard.image.getValue()) {\n    billboard.image = undefined;\n  }\n\n  var scale = 1.0;\n  if (defined(billboard.scale)) {\n    scale = billboard.scale.getValue();\n    if (scale !== 0) {\n      label.pixelOffset = new Cartesian2(scale * 16 + 1, 0);\n    } else {\n      //Minor tweaks to better match Google Earth.\n      label.pixelOffset = undefined;\n      label.horizontalOrigin = undefined;\n    }\n  }\n\n  if (defined(heightReference) && dataSource._clampToGround) {\n    billboard.heightReference = heightReference;\n    label.heightReference = heightReference;\n  }\n}\n\nfunction processPathGraphics(entity, styleEntity) {\n  var path = entity.path;\n  if (!defined(path)) {\n    path = new PathGraphics();\n    path.leadTime = 0;\n    entity.path = path;\n  }\n\n  var polyline = styleEntity.polyline;\n  if (defined(polyline)) {\n    path.material = polyline.material;\n    path.width = polyline.width;\n  }\n}\n\nfunction processPoint(\n  dataSource,\n  entityCollection,\n  geometryNode,\n  entity,\n  styleEntity\n) {\n  var coordinatesString = queryStringValue(\n    geometryNode,\n    \"coordinates\",\n    namespaces.kml\n  );\n  var altitudeMode = queryStringValue(\n    geometryNode,\n    \"altitudeMode\",\n    namespaces.kml\n  );\n  var gxAltitudeMode = queryStringValue(\n    geometryNode,\n    \"altitudeMode\",\n    namespaces.gx\n  );\n  var extrude = queryBooleanValue(geometryNode, \"extrude\", namespaces.kml);\n  var ellipsoid = dataSource._ellipsoid;\n  var position = readCoordinate(coordinatesString, ellipsoid);\n\n  entity.position = position;\n  processPositionGraphics(\n    dataSource,\n    entity,\n    styleEntity,\n    heightReferenceFromAltitudeMode(altitudeMode, gxAltitudeMode)\n  );\n\n  if (extrude && isExtrudable(altitudeMode, gxAltitudeMode)) {\n    createDropLine(entityCollection, entity, styleEntity);\n  }\n\n  return true;\n}\n\nfunction processLineStringOrLinearRing(\n  dataSource,\n  entityCollection,\n  geometryNode,\n  entity,\n  styleEntity\n) {\n  var coordinatesNode = queryFirstNode(\n    geometryNode,\n    \"coordinates\",\n    namespaces.kml\n  );\n  var altitudeMode = queryStringValue(\n    geometryNode,\n    \"altitudeMode\",\n    namespaces.kml\n  );\n  var gxAltitudeMode = queryStringValue(\n    geometryNode,\n    \"altitudeMode\",\n    namespaces.gx\n  );\n  var extrude = queryBooleanValue(geometryNode, \"extrude\", namespaces.kml);\n  var tessellate = queryBooleanValue(\n    geometryNode,\n    \"tessellate\",\n    namespaces.kml\n  );\n  var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n  var zIndex = queryNumericValue(geometryNode, \"drawOrder\", namespaces.gx);\n\n  var ellipsoid = dataSource._ellipsoid;\n  var coordinates = readCoordinates(coordinatesNode, ellipsoid);\n  var polyline = styleEntity.polyline;\n  if (canExtrude && extrude) {\n    var wall = new WallGraphics();\n    entity.wall = wall;\n    wall.positions = coordinates;\n    var polygon = styleEntity.polygon;\n\n    if (defined(polygon)) {\n      wall.fill = polygon.fill;\n      wall.material = polygon.material;\n    }\n\n    //Always outline walls so they show up in 2D.\n    wall.outline = true;\n    if (defined(polyline)) {\n      wall.outlineColor = defined(polyline.material)\n        ? polyline.material.color\n        : Color.WHITE;\n      wall.outlineWidth = polyline.width;\n    } else if (defined(polygon)) {\n      wall.outlineColor = defined(polygon.material)\n        ? polygon.material.color\n        : Color.WHITE;\n    }\n  } else if (dataSource._clampToGround && !canExtrude && tessellate) {\n    var polylineGraphics = new PolylineGraphics();\n    polylineGraphics.clampToGround = true;\n    entity.polyline = polylineGraphics;\n    polylineGraphics.positions = coordinates;\n    if (defined(polyline)) {\n      polylineGraphics.material = defined(polyline.material)\n        ? polyline.material.color.getValue(Iso8601.MINIMUM_VALUE)\n        : Color.WHITE;\n      polylineGraphics.width = defaultValue(polyline.width, 1.0);\n    } else {\n      polylineGraphics.material = Color.WHITE;\n      polylineGraphics.width = 1.0;\n    }\n    polylineGraphics.zIndex = zIndex;\n  } else {\n    if (defined(zIndex)) {\n      oneTimeWarning(\n        \"kml-gx:drawOrder\",\n        \"KML - gx:drawOrder is not supported in LineStrings when clampToGround is false\"\n      );\n    }\n    if (dataSource._clampToGround && !tessellate) {\n      oneTimeWarning(\n        \"kml-line-tesselate\",\n        \"Ignoring clampToGround for KML lines without the tessellate flag.\"\n      );\n    }\n\n    polyline = defined(polyline) ? polyline.clone() : new PolylineGraphics();\n    entity.polyline = polyline;\n    polyline.positions = createPositionPropertyArrayFromAltitudeMode(\n      coordinates,\n      altitudeMode,\n      gxAltitudeMode,\n      ellipsoid\n    );\n    if (!tessellate || canExtrude) {\n      polyline.arcType = ArcType.NONE;\n    }\n  }\n\n  return true;\n}\n\nfunction processPolygon(\n  dataSource,\n  entityCollection,\n  geometryNode,\n  entity,\n  styleEntity\n) {\n  var outerBoundaryIsNode = queryFirstNode(\n    geometryNode,\n    \"outerBoundaryIs\",\n    namespaces.kml\n  );\n  var linearRingNode = queryFirstNode(\n    outerBoundaryIsNode,\n    \"LinearRing\",\n    namespaces.kml\n  );\n  var coordinatesNode = queryFirstNode(\n    linearRingNode,\n    \"coordinates\",\n    namespaces.kml\n  );\n  var ellipsoid = dataSource._ellipsoid;\n  var coordinates = readCoordinates(coordinatesNode, ellipsoid);\n  var extrude = queryBooleanValue(geometryNode, \"extrude\", namespaces.kml);\n  var altitudeMode = queryStringValue(\n    geometryNode,\n    \"altitudeMode\",\n    namespaces.kml\n  );\n  var gxAltitudeMode = queryStringValue(\n    geometryNode,\n    \"altitudeMode\",\n    namespaces.gx\n  );\n  var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n\n  var polygon = defined(styleEntity.polygon)\n    ? styleEntity.polygon.clone()\n    : createDefaultPolygon();\n\n  var polyline = styleEntity.polyline;\n  if (defined(polyline)) {\n    polygon.outlineColor = defined(polyline.material)\n      ? polyline.material.color\n      : Color.WHITE;\n    polygon.outlineWidth = polyline.width;\n  }\n  entity.polygon = polygon;\n\n  if (canExtrude) {\n    polygon.perPositionHeight = true;\n    polygon.extrudedHeight = extrude ? 0 : undefined;\n  } else if (!dataSource._clampToGround) {\n    polygon.height = 0;\n  }\n\n  if (defined(coordinates)) {\n    var hierarchy = new PolygonHierarchy(coordinates);\n    var innerBoundaryIsNodes = queryChildNodes(\n      geometryNode,\n      \"innerBoundaryIs\",\n      namespaces.kml\n    );\n    for (var j = 0; j < innerBoundaryIsNodes.length; j++) {\n      linearRingNode = queryChildNodes(\n        innerBoundaryIsNodes[j],\n        \"LinearRing\",\n        namespaces.kml\n      );\n      for (var k = 0; k < linearRingNode.length; k++) {\n        coordinatesNode = queryFirstNode(\n          linearRingNode[k],\n          \"coordinates\",\n          namespaces.kml\n        );\n        coordinates = readCoordinates(coordinatesNode, ellipsoid);\n        if (defined(coordinates)) {\n          hierarchy.holes.push(new PolygonHierarchy(coordinates));\n        }\n      }\n    }\n    polygon.hierarchy = hierarchy;\n  }\n\n  return true;\n}\n\nfunction processTrack(\n  dataSource,\n  entityCollection,\n  geometryNode,\n  entity,\n  styleEntity\n) {\n  var altitudeMode = queryStringValue(\n    geometryNode,\n    \"altitudeMode\",\n    namespaces.kml\n  );\n  var gxAltitudeMode = queryStringValue(\n    geometryNode,\n    \"altitudeMode\",\n    namespaces.gx\n  );\n  var coordNodes = queryChildNodes(geometryNode, \"coord\", namespaces.gx);\n  var angleNodes = queryChildNodes(geometryNode, \"angles\", namespaces.gx);\n  var timeNodes = queryChildNodes(geometryNode, \"when\", namespaces.kml);\n  var extrude = queryBooleanValue(geometryNode, \"extrude\", namespaces.kml);\n  var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n  var ellipsoid = dataSource._ellipsoid;\n\n  if (angleNodes.length > 0) {\n    oneTimeWarning(\n      \"kml-gx:angles\",\n      \"KML - gx:angles are not supported in gx:Tracks\"\n    );\n  }\n\n  var length = Math.min(coordNodes.length, timeNodes.length);\n  var coordinates = [];\n  var times = [];\n  for (var i = 0; i < length; i++) {\n    var position = readCoordinate(coordNodes[i].textContent, ellipsoid);\n    coordinates.push(position);\n    times.push(JulianDate.fromIso8601(timeNodes[i].textContent));\n  }\n  var property = new SampledPositionProperty();\n  property.addSamples(times, coordinates);\n  entity.position = property;\n  processPositionGraphics(\n    dataSource,\n    entity,\n    styleEntity,\n    heightReferenceFromAltitudeMode(altitudeMode, gxAltitudeMode)\n  );\n  processPathGraphics(entity, styleEntity);\n\n  entity.availability = new TimeIntervalCollection();\n\n  if (timeNodes.length > 0) {\n    entity.availability.addInterval(\n      new TimeInterval({\n        start: times[0],\n        stop: times[times.length - 1],\n      })\n    );\n  }\n\n  if (canExtrude && extrude) {\n    createDropLine(entityCollection, entity, styleEntity);\n  }\n\n  return true;\n}\n\nfunction addToMultiTrack(\n  times,\n  positions,\n  composite,\n  availability,\n  dropShowProperty,\n  extrude,\n  altitudeMode,\n  gxAltitudeMode,\n  includeEndPoints\n) {\n  var start = times[0];\n  var stop = times[times.length - 1];\n\n  var data = new SampledPositionProperty();\n  data.addSamples(times, positions);\n\n  composite.intervals.addInterval(\n    new TimeInterval({\n      start: start,\n      stop: stop,\n      isStartIncluded: includeEndPoints,\n      isStopIncluded: includeEndPoints,\n      data: createPositionPropertyFromAltitudeMode(\n        data,\n        altitudeMode,\n        gxAltitudeMode\n      ),\n    })\n  );\n  availability.addInterval(\n    new TimeInterval({\n      start: start,\n      stop: stop,\n      isStartIncluded: includeEndPoints,\n      isStopIncluded: includeEndPoints,\n    })\n  );\n  dropShowProperty.intervals.addInterval(\n    new TimeInterval({\n      start: start,\n      stop: stop,\n      isStartIncluded: includeEndPoints,\n      isStopIncluded: includeEndPoints,\n      data: extrude,\n    })\n  );\n}\n\nfunction processMultiTrack(\n  dataSource,\n  entityCollection,\n  geometryNode,\n  entity,\n  styleEntity\n) {\n  // Multitrack options do not work in GE as detailed in the spec,\n  // rather than altitudeMode being at the MultiTrack level,\n  // GE just defers all settings to the underlying track.\n\n  var interpolate = queryBooleanValue(\n    geometryNode,\n    \"interpolate\",\n    namespaces.gx\n  );\n  var trackNodes = queryChildNodes(geometryNode, \"Track\", namespaces.gx);\n\n  var times;\n  var lastStop;\n  var lastStopPosition;\n  var needDropLine = false;\n  var dropShowProperty = new TimeIntervalCollectionProperty();\n  var availability = new TimeIntervalCollection();\n  var composite = new CompositePositionProperty();\n  var ellipsoid = dataSource._ellipsoid;\n  for (var i = 0, len = trackNodes.length; i < len; i++) {\n    var trackNode = trackNodes[i];\n    var timeNodes = queryChildNodes(trackNode, \"when\", namespaces.kml);\n    var coordNodes = queryChildNodes(trackNode, \"coord\", namespaces.gx);\n    var altitudeMode = queryStringValue(\n      trackNode,\n      \"altitudeMode\",\n      namespaces.kml\n    );\n    var gxAltitudeMode = queryStringValue(\n      trackNode,\n      \"altitudeMode\",\n      namespaces.gx\n    );\n    var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n    var extrude = queryBooleanValue(trackNode, \"extrude\", namespaces.kml);\n\n    var length = Math.min(coordNodes.length, timeNodes.length);\n\n    var positions = [];\n    times = [];\n    for (var x = 0; x < length; x++) {\n      var position = readCoordinate(coordNodes[x].textContent, ellipsoid);\n      positions.push(position);\n      times.push(JulianDate.fromIso8601(timeNodes[x].textContent));\n    }\n\n    if (interpolate) {\n      //If we are interpolating, then we need to fill in the end of\n      //the last track and the beginning of this one with a sampled\n      //property.  From testing in Google Earth, this property\n      //is never extruded and always absolute.\n      if (defined(lastStop)) {\n        addToMultiTrack(\n          [lastStop, times[0]],\n          [lastStopPosition, positions[0]],\n          composite,\n          availability,\n          dropShowProperty,\n          false,\n          \"absolute\",\n          undefined,\n          false\n        );\n      }\n      lastStop = times[length - 1];\n      lastStopPosition = positions[positions.length - 1];\n    }\n\n    addToMultiTrack(\n      times,\n      positions,\n      composite,\n      availability,\n      dropShowProperty,\n      canExtrude && extrude,\n      altitudeMode,\n      gxAltitudeMode,\n      true\n    );\n    needDropLine = needDropLine || (canExtrude && extrude);\n  }\n\n  entity.availability = availability;\n  entity.position = composite;\n  processPositionGraphics(dataSource, entity, styleEntity);\n  processPathGraphics(entity, styleEntity);\n  if (needDropLine) {\n    createDropLine(entityCollection, entity, styleEntity);\n    entity.polyline.show = dropShowProperty;\n  }\n\n  return true;\n}\n\nvar geometryTypes = {\n  Point: processPoint,\n  LineString: processLineStringOrLinearRing,\n  LinearRing: processLineStringOrLinearRing,\n  Polygon: processPolygon,\n  Track: processTrack,\n  MultiTrack: processMultiTrack,\n  MultiGeometry: processMultiGeometry,\n  Model: processUnsupportedGeometry,\n};\n\nfunction processMultiGeometry(\n  dataSource,\n  entityCollection,\n  geometryNode,\n  entity,\n  styleEntity,\n  context\n) {\n  var childNodes = geometryNode.childNodes;\n  var hasGeometry = false;\n  for (var i = 0, len = childNodes.length; i < len; i++) {\n    var childNode = childNodes.item(i);\n    var geometryProcessor = geometryTypes[childNode.localName];\n    if (defined(geometryProcessor)) {\n      var childEntity = createEntity(childNode, entityCollection, context);\n      childEntity.parent = entity;\n      childEntity.name = entity.name;\n      childEntity.availability = entity.availability;\n      childEntity.description = entity.description;\n      childEntity.kml = entity.kml;\n      if (\n        geometryProcessor(\n          dataSource,\n          entityCollection,\n          childNode,\n          childEntity,\n          styleEntity\n        )\n      ) {\n        hasGeometry = true;\n      }\n    }\n  }\n\n  return hasGeometry;\n}\n\nfunction processUnsupportedGeometry(\n  dataSource,\n  entityCollection,\n  geometryNode,\n  entity,\n  styleEntity\n) {\n  oneTimeWarning(\n    \"kml-unsupportedGeometry\",\n    \"KML - Unsupported geometry: \" + geometryNode.localName\n  );\n  return false;\n}\n\nfunction processExtendedData(node, entity) {\n  var extendedDataNode = queryFirstNode(node, \"ExtendedData\", namespaces.kml);\n\n  if (!defined(extendedDataNode)) {\n    return undefined;\n  }\n\n  if (defined(queryFirstNode(extendedDataNode, \"SchemaData\", namespaces.kml))) {\n    oneTimeWarning(\"kml-schemaData\", \"KML - SchemaData is unsupported\");\n  }\n  if (defined(queryStringAttribute(extendedDataNode, \"xmlns:prefix\"))) {\n    oneTimeWarning(\n      \"kml-extendedData\",\n      \"KML - ExtendedData with xmlns:prefix is unsupported\"\n    );\n  }\n\n  var result = {};\n  var dataNodes = queryChildNodes(extendedDataNode, \"Data\", namespaces.kml);\n  if (defined(dataNodes)) {\n    var length = dataNodes.length;\n    for (var i = 0; i < length; i++) {\n      var dataNode = dataNodes[i];\n      var name = queryStringAttribute(dataNode, \"name\");\n      if (defined(name)) {\n        result[name] = {\n          displayName: queryStringValue(\n            dataNode,\n            \"displayName\",\n            namespaces.kml\n          ),\n          value: queryStringValue(dataNode, \"value\", namespaces.kml),\n        };\n      }\n    }\n  }\n  entity.kml.extendedData = result;\n}\n\nvar scratchDiv;\nif (typeof document !== \"undefined\") {\n  scratchDiv = document.createElement(\"div\");\n}\n\nfunction processDescription(\n  node,\n  entity,\n  styleEntity,\n  uriResolver,\n  sourceResource\n) {\n  var i;\n  var key;\n  var keys;\n\n  var kmlData = entity.kml;\n  var extendedData = kmlData.extendedData;\n  var description = queryStringValue(node, \"description\", namespaces.kml);\n\n  var balloonStyle = defaultValue(\n    entity.balloonStyle,\n    styleEntity.balloonStyle\n  );\n\n  var background = Color.WHITE;\n  var foreground = Color.BLACK;\n  var text = description;\n\n  if (defined(balloonStyle)) {\n    background = defaultValue(balloonStyle.bgColor, Color.WHITE);\n    foreground = defaultValue(balloonStyle.textColor, Color.BLACK);\n    text = defaultValue(balloonStyle.text, description);\n  }\n\n  var value;\n  if (defined(text)) {\n    text = text.replace(\"$[name]\", defaultValue(entity.name, \"\"));\n    text = text.replace(\"$[description]\", defaultValue(description, \"\"));\n    text = text.replace(\"$[address]\", defaultValue(kmlData.address, \"\"));\n    text = text.replace(\"$[Snippet]\", defaultValue(kmlData.snippet, \"\"));\n    text = text.replace(\"$[id]\", entity.id);\n\n    //While not explicitly defined by the OGC spec, in Google Earth\n    //The appearance of geDirections adds the directions to/from links\n    //We simply replace this string with nothing.\n    text = text.replace(\"$[geDirections]\", \"\");\n\n    if (defined(extendedData)) {\n      var matches = text.match(/\\$\\[.+?\\]/g);\n      if (matches !== null) {\n        for (i = 0; i < matches.length; i++) {\n          var token = matches[i];\n          var propertyName = token.substr(2, token.length - 3);\n          var isDisplayName = /\\/displayName$/.test(propertyName);\n          propertyName = propertyName.replace(/\\/displayName$/, \"\");\n\n          value = extendedData[propertyName];\n          if (defined(value)) {\n            value = isDisplayName ? value.displayName : value.value;\n          }\n          if (defined(value)) {\n            text = text.replace(token, defaultValue(value, \"\"));\n          }\n        }\n      }\n    }\n  } else if (defined(extendedData)) {\n    //If no description exists, build a table out of the extended data\n    keys = Object.keys(extendedData);\n    if (keys.length > 0) {\n      text =\n        '<table class=\"cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter\"><tbody>';\n      for (i = 0; i < keys.length; i++) {\n        key = keys[i];\n        value = extendedData[key];\n        text +=\n          \"<tr><th>\" +\n          defaultValue(value.displayName, key) +\n          \"</th><td>\" +\n          defaultValue(value.value, \"\") +\n          \"</td></tr>\";\n      }\n      text += \"</tbody></table>\";\n    }\n  }\n\n  if (!defined(text)) {\n    //No description\n    return;\n  }\n\n  //Turns non-explicit links into clickable links.\n  text = autolinker.link(text);\n\n  //Use a temporary div to manipulate the links\n  //so that they open in a new window.\n  scratchDiv.innerHTML = text;\n  var links = scratchDiv.querySelectorAll(\"a\");\n  for (i = 0; i < links.length; i++) {\n    links[i].setAttribute(\"target\", \"_blank\");\n  }\n\n  //Rewrite any KMZ embedded urls\n  if (defined(uriResolver) && uriResolver.keys.length > 1) {\n    embedDataUris(scratchDiv, \"a\", \"href\", uriResolver);\n    embedDataUris(scratchDiv, \"img\", \"src\", uriResolver);\n  }\n\n  //Make relative urls absolute using the sourceResource\n  applyBasePath(scratchDiv, \"a\", \"href\", sourceResource);\n  applyBasePath(scratchDiv, \"img\", \"src\", sourceResource);\n\n  var tmp = '<div class=\"cesium-infoBox-description-lighter\" style=\"';\n  tmp += \"overflow:auto;\";\n  tmp += \"word-wrap:break-word;\";\n  tmp += \"background-color:\" + background.toCssColorString() + \";\";\n  tmp += \"color:\" + foreground.toCssColorString() + \";\";\n  tmp += '\">';\n  tmp += scratchDiv.innerHTML + \"</div>\";\n  scratchDiv.innerHTML = \"\";\n\n  //Set the final HTML as the description.\n  entity.description = tmp;\n}\n\nfunction processFeature(dataSource, featureNode, processingData) {\n  var entityCollection = processingData.entityCollection;\n  var parent = processingData.parentEntity;\n  var sourceResource = processingData.sourceResource;\n  var uriResolver = processingData.uriResolver;\n\n  var entity = createEntity(\n    featureNode,\n    entityCollection,\n    processingData.context\n  );\n  var kmlData = entity.kml;\n  var styleEntity = computeFinalStyle(\n    dataSource,\n    featureNode,\n    processingData.styleCollection,\n    sourceResource,\n    uriResolver\n  );\n\n  var name = queryStringValue(featureNode, \"name\", namespaces.kml);\n  entity.name = name;\n  entity.parent = parent;\n\n  var availability = processTimeSpan(featureNode);\n  if (!defined(availability)) {\n    availability = processTimeStamp(featureNode);\n  }\n  entity.availability = availability;\n\n  mergeAvailabilityWithParent(entity);\n\n  // Per KML spec \"A Feature is visible only if it and all its ancestors are visible.\"\n  function ancestryIsVisible(parentEntity) {\n    if (!parentEntity) {\n      return true;\n    }\n    return parentEntity.show && ancestryIsVisible(parentEntity.parent);\n  }\n\n  var visibility = queryBooleanValue(featureNode, \"visibility\", namespaces.kml);\n  entity.show = ancestryIsVisible(parent) && defaultValue(visibility, true);\n  //var open = queryBooleanValue(featureNode, 'open', namespaces.kml);\n\n  var authorNode = queryFirstNode(featureNode, \"author\", namespaces.atom);\n  var author = kmlData.author;\n  author.name = queryStringValue(authorNode, \"name\", namespaces.atom);\n  author.uri = queryStringValue(authorNode, \"uri\", namespaces.atom);\n  author.email = queryStringValue(authorNode, \"email\", namespaces.atom);\n\n  var linkNode = queryFirstNode(featureNode, \"link\", namespaces.atom);\n  var link = kmlData.link;\n  link.href = queryStringAttribute(linkNode, \"href\");\n  link.hreflang = queryStringAttribute(linkNode, \"hreflang\");\n  link.rel = queryStringAttribute(linkNode, \"rel\");\n  link.type = queryStringAttribute(linkNode, \"type\");\n  link.title = queryStringAttribute(linkNode, \"title\");\n  link.length = queryStringAttribute(linkNode, \"length\");\n\n  kmlData.address = queryStringValue(featureNode, \"address\", namespaces.kml);\n  kmlData.phoneNumber = queryStringValue(\n    featureNode,\n    \"phoneNumber\",\n    namespaces.kml\n  );\n  kmlData.snippet = queryStringValue(featureNode, \"Snippet\", namespaces.kml);\n\n  processExtendedData(featureNode, entity);\n  processDescription(\n    featureNode,\n    entity,\n    styleEntity,\n    uriResolver,\n    sourceResource\n  );\n\n  var ellipsoid = dataSource._ellipsoid;\n  processLookAt(featureNode, entity, ellipsoid);\n  processCamera(featureNode, entity, ellipsoid);\n\n  if (defined(queryFirstNode(featureNode, \"Region\", namespaces.kml))) {\n    oneTimeWarning(\"kml-region\", \"KML - Placemark Regions are unsupported\");\n  }\n\n  return {\n    entity: entity,\n    styleEntity: styleEntity,\n  };\n}\n\nfunction processDocument(dataSource, node, processingData, deferredLoading) {\n  deferredLoading.addNodes(node.childNodes, processingData);\n  deferredLoading.process();\n}\n\nfunction processFolder(dataSource, node, processingData, deferredLoading) {\n  var r = processFeature(dataSource, node, processingData);\n  var newProcessingData = clone(processingData);\n  newProcessingData.parentEntity = r.entity;\n  processDocument(dataSource, node, newProcessingData, deferredLoading);\n}\n\nfunction processPlacemark(\n  dataSource,\n  placemark,\n  processingData,\n  deferredLoading\n) {\n  var r = processFeature(dataSource, placemark, processingData);\n  var entity = r.entity;\n  var styleEntity = r.styleEntity;\n\n  var hasGeometry = false;\n  var childNodes = placemark.childNodes;\n  for (var i = 0, len = childNodes.length; i < len && !hasGeometry; i++) {\n    var childNode = childNodes.item(i);\n    var geometryProcessor = geometryTypes[childNode.localName];\n    if (defined(geometryProcessor)) {\n      // pass the placemark entity id as a context for case of defining multiple child entities together to handle case\n      // where some malformed kmls reuse the same id across placemarks, which works in GE, but is not technically to spec.\n      geometryProcessor(\n        dataSource,\n        processingData.entityCollection,\n        childNode,\n        entity,\n        styleEntity,\n        entity.id\n      );\n      hasGeometry = true;\n    }\n  }\n\n  if (!hasGeometry) {\n    entity.merge(styleEntity);\n    processPositionGraphics(dataSource, entity, styleEntity);\n  }\n}\n\nvar playlistNodeProcessors = {\n  FlyTo: processTourFlyTo,\n  Wait: processTourWait,\n  SoundCue: processTourUnsupportedNode,\n  AnimatedUpdate: processTourUnsupportedNode,\n  TourControl: processTourUnsupportedNode,\n};\n\nfunction processTour(dataSource, node, processingData, deferredLoading) {\n  var name = queryStringValue(node, \"name\", namespaces.kml);\n  var id = queryStringAttribute(node, \"id\");\n  var tour = new KmlTour(name, id);\n\n  var playlistNode = queryFirstNode(node, \"Playlist\", namespaces.gx);\n  if (playlistNode) {\n    var ellipsoid = dataSource._ellipsoid;\n    var childNodes = playlistNode.childNodes;\n    for (var i = 0; i < childNodes.length; i++) {\n      var entryNode = childNodes[i];\n      if (entryNode.localName) {\n        var playlistNodeProcessor = playlistNodeProcessors[entryNode.localName];\n        if (playlistNodeProcessor) {\n          playlistNodeProcessor(tour, entryNode, ellipsoid);\n        } else {\n          console.log(\n            \"Unknown KML Tour playlist entry type \" + entryNode.localName\n          );\n        }\n      }\n    }\n  }\n\n  if (!defined(dataSource.kmlTours)) {\n    dataSource.kmlTours = [];\n  }\n\n  dataSource.kmlTours.push(tour);\n}\n\nfunction processTourUnsupportedNode(tour, entryNode) {\n  oneTimeWarning(\"KML Tour unsupported node \" + entryNode.localName);\n}\n\nfunction processTourWait(tour, entryNode) {\n  var duration = queryNumericValue(entryNode, \"duration\", namespaces.gx);\n  tour.addPlaylistEntry(new KmlTourWait(duration));\n}\n\nfunction processTourFlyTo(tour, entryNode, ellipsoid) {\n  var duration = queryNumericValue(entryNode, \"duration\", namespaces.gx);\n  var flyToMode = queryStringValue(entryNode, \"flyToMode\", namespaces.gx);\n\n  var t = { kml: {} };\n\n  processLookAt(entryNode, t, ellipsoid);\n  processCamera(entryNode, t, ellipsoid);\n\n  var view = t.kml.lookAt || t.kml.camera;\n\n  var flyto = new KmlTourFlyTo(duration, flyToMode, view);\n  tour.addPlaylistEntry(flyto);\n}\n\nfunction processCamera(featureNode, entity, ellipsoid) {\n  var camera = queryFirstNode(featureNode, \"Camera\", namespaces.kml);\n  if (defined(camera)) {\n    var lon = defaultValue(\n      queryNumericValue(camera, \"longitude\", namespaces.kml),\n      0.0\n    );\n    var lat = defaultValue(\n      queryNumericValue(camera, \"latitude\", namespaces.kml),\n      0.0\n    );\n    var altitude = defaultValue(\n      queryNumericValue(camera, \"altitude\", namespaces.kml),\n      0.0\n    );\n\n    var heading = defaultValue(\n      queryNumericValue(camera, \"heading\", namespaces.kml),\n      0.0\n    );\n    var tilt = defaultValue(\n      queryNumericValue(camera, \"tilt\", namespaces.kml),\n      0.0\n    );\n    var roll = defaultValue(\n      queryNumericValue(camera, \"roll\", namespaces.kml),\n      0.0\n    );\n\n    var position = Cartesian3.fromDegrees(lon, lat, altitude, ellipsoid);\n    var hpr = HeadingPitchRoll.fromDegrees(heading, tilt - 90.0, roll);\n\n    entity.kml.camera = new KmlCamera(position, hpr);\n  }\n}\n\nfunction processLookAt(featureNode, entity, ellipsoid) {\n  var lookAt = queryFirstNode(featureNode, \"LookAt\", namespaces.kml);\n  if (defined(lookAt)) {\n    var lon = defaultValue(\n      queryNumericValue(lookAt, \"longitude\", namespaces.kml),\n      0.0\n    );\n    var lat = defaultValue(\n      queryNumericValue(lookAt, \"latitude\", namespaces.kml),\n      0.0\n    );\n    var altitude = defaultValue(\n      queryNumericValue(lookAt, \"altitude\", namespaces.kml),\n      0.0\n    );\n    var heading = queryNumericValue(lookAt, \"heading\", namespaces.kml);\n    var tilt = queryNumericValue(lookAt, \"tilt\", namespaces.kml);\n    var range = defaultValue(\n      queryNumericValue(lookAt, \"range\", namespaces.kml),\n      0.0\n    );\n\n    tilt = CesiumMath.toRadians(defaultValue(tilt, 0.0));\n    heading = CesiumMath.toRadians(defaultValue(heading, 0.0));\n\n    var hpr = new HeadingPitchRange(\n      heading,\n      tilt - CesiumMath.PI_OVER_TWO,\n      range\n    );\n    var viewPoint = Cartesian3.fromDegrees(lon, lat, altitude, ellipsoid);\n\n    entity.kml.lookAt = new KmlLookAt(viewPoint, hpr);\n  }\n}\n\nfunction processGroundOverlay(\n  dataSource,\n  groundOverlay,\n  processingData,\n  deferredLoading\n) {\n  var r = processFeature(dataSource, groundOverlay, processingData);\n  var entity = r.entity;\n\n  var geometry;\n  var isLatLonQuad = false;\n\n  var ellipsoid = dataSource._ellipsoid;\n  var positions = readCoordinates(\n    queryFirstNode(groundOverlay, \"LatLonQuad\", namespaces.gx),\n    ellipsoid\n  );\n  var zIndex = queryNumericValue(groundOverlay, \"drawOrder\", namespaces.kml);\n  if (defined(positions)) {\n    geometry = createDefaultPolygon();\n    geometry.hierarchy = new PolygonHierarchy(positions);\n    geometry.zIndex = zIndex;\n    entity.polygon = geometry;\n    isLatLonQuad = true;\n  } else {\n    geometry = new RectangleGraphics();\n    geometry.zIndex = zIndex;\n    entity.rectangle = geometry;\n\n    var latLonBox = queryFirstNode(groundOverlay, \"LatLonBox\", namespaces.kml);\n    if (defined(latLonBox)) {\n      var west = queryNumericValue(latLonBox, \"west\", namespaces.kml);\n      var south = queryNumericValue(latLonBox, \"south\", namespaces.kml);\n      var east = queryNumericValue(latLonBox, \"east\", namespaces.kml);\n      var north = queryNumericValue(latLonBox, \"north\", namespaces.kml);\n\n      if (defined(west)) {\n        west = CesiumMath.negativePiToPi(CesiumMath.toRadians(west));\n      }\n      if (defined(south)) {\n        south = CesiumMath.clampToLatitudeRange(CesiumMath.toRadians(south));\n      }\n      if (defined(east)) {\n        east = CesiumMath.negativePiToPi(CesiumMath.toRadians(east));\n      }\n      if (defined(north)) {\n        north = CesiumMath.clampToLatitudeRange(CesiumMath.toRadians(north));\n      }\n      geometry.coordinates = new Rectangle(west, south, east, north);\n\n      var rotation = queryNumericValue(latLonBox, \"rotation\", namespaces.kml);\n      if (defined(rotation)) {\n        var rotationRadians = CesiumMath.toRadians(rotation);\n        geometry.rotation = rotationRadians;\n        geometry.stRotation = rotationRadians;\n      }\n    }\n  }\n\n  var iconNode = queryFirstNode(groundOverlay, \"Icon\", namespaces.kml);\n  var href = getIconHref(\n    iconNode,\n    dataSource,\n    processingData.sourceResource,\n    processingData.uriResolver,\n    true\n  );\n  if (defined(href)) {\n    if (isLatLonQuad) {\n      oneTimeWarning(\n        \"kml-gx:LatLonQuad\",\n        \"KML - gx:LatLonQuad Icon does not support texture projection.\"\n      );\n    }\n    var x = queryNumericValue(iconNode, \"x\", namespaces.gx);\n    var y = queryNumericValue(iconNode, \"y\", namespaces.gx);\n    var w = queryNumericValue(iconNode, \"w\", namespaces.gx);\n    var h = queryNumericValue(iconNode, \"h\", namespaces.gx);\n\n    if (defined(x) || defined(y) || defined(w) || defined(h)) {\n      oneTimeWarning(\n        \"kml-groundOverlay-xywh\",\n        \"KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays\"\n      );\n    }\n\n    geometry.material = href;\n    geometry.material.color = queryColorValue(\n      groundOverlay,\n      \"color\",\n      namespaces.kml\n    );\n    geometry.material.transparent = true;\n  } else {\n    geometry.material = queryColorValue(groundOverlay, \"color\", namespaces.kml);\n  }\n\n  var altitudeMode = queryStringValue(\n    groundOverlay,\n    \"altitudeMode\",\n    namespaces.kml\n  );\n\n  if (defined(altitudeMode)) {\n    if (altitudeMode === \"absolute\") {\n      //Use height above ellipsoid until we support MSL.\n      geometry.height = queryNumericValue(\n        groundOverlay,\n        \"altitude\",\n        namespaces.kml\n      );\n      geometry.zIndex = undefined;\n    } else if (altitudeMode !== \"clampToGround\") {\n      oneTimeWarning(\n        \"kml-altitudeMode-unknown\",\n        \"KML - Unknown altitudeMode: \" + altitudeMode\n      );\n    }\n    // else just use the default of 0 until we support 'clampToGround'\n  } else {\n    altitudeMode = queryStringValue(\n      groundOverlay,\n      \"altitudeMode\",\n      namespaces.gx\n    );\n    if (altitudeMode === \"relativeToSeaFloor\") {\n      oneTimeWarning(\n        \"kml-altitudeMode-relativeToSeaFloor\",\n        \"KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute.\"\n      );\n      geometry.height = queryNumericValue(\n        groundOverlay,\n        \"altitude\",\n        namespaces.kml\n      );\n      geometry.zIndex = undefined;\n    } else if (altitudeMode === \"clampToSeaFloor\") {\n      oneTimeWarning(\n        \"kml-altitudeMode-clampToSeaFloor\",\n        \"KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround.\"\n      );\n    } else if (defined(altitudeMode)) {\n      oneTimeWarning(\n        \"kml-altitudeMode-unknown\",\n        \"KML - Unknown altitudeMode: \" + altitudeMode\n      );\n    }\n  }\n}\n\nfunction processUnsupportedFeature(\n  dataSource,\n  node,\n  processingData,\n  deferredLoading\n) {\n  dataSource._unsupportedNode.raiseEvent(\n    dataSource,\n    processingData.parentEntity,\n    node,\n    processingData.entityCollection,\n    processingData.styleCollection,\n    processingData.sourceResource,\n    processingData.uriResolver\n  );\n  oneTimeWarning(\n    \"kml-unsupportedFeature-\" + node.nodeName,\n    \"KML - Unsupported feature: \" + node.nodeName\n  );\n}\n\nvar RefreshMode = {\n  INTERVAL: 0,\n  EXPIRE: 1,\n  STOP: 2,\n};\n\nfunction cleanupString(s) {\n  if (!defined(s) || s.length === 0) {\n    return \"\";\n  }\n\n  var sFirst = s[0];\n  if (sFirst === \"&\" || sFirst === \"?\") {\n    s = s.substring(1);\n  }\n\n  return s;\n}\n\nvar zeroRectangle = new Rectangle();\nvar scratchCartographic = new Cartographic();\nvar scratchCartesian2 = new Cartesian2();\nvar scratchCartesian3 = new Cartesian3();\n\nfunction processNetworkLinkQueryString(\n  resource,\n  camera,\n  canvas,\n  viewBoundScale,\n  bbox,\n  ellipsoid\n) {\n  function fixLatitude(value) {\n    if (value < -CesiumMath.PI_OVER_TWO) {\n      return -CesiumMath.PI_OVER_TWO;\n    } else if (value > CesiumMath.PI_OVER_TWO) {\n      return CesiumMath.PI_OVER_TWO;\n    }\n    return value;\n  }\n\n  function fixLongitude(value) {\n    if (value > CesiumMath.PI) {\n      return value - CesiumMath.TWO_PI;\n    } else if (value < -CesiumMath.PI) {\n      return value + CesiumMath.TWO_PI;\n    }\n\n    return value;\n  }\n\n  var queryString = objectToQuery(resource.queryParameters);\n\n  // objectToQuery escapes [ and ], so fix that\n  queryString = queryString.replace(/%5B/g, \"[\").replace(/%5D/g, \"]\");\n\n  if (defined(camera) && camera._mode !== SceneMode.MORPHING) {\n    var centerCartesian;\n    var centerCartographic;\n\n    bbox = defaultValue(bbox, zeroRectangle);\n    if (defined(canvas)) {\n      scratchCartesian2.x = canvas.clientWidth * 0.5;\n      scratchCartesian2.y = canvas.clientHeight * 0.5;\n      centerCartesian = camera.pickEllipsoid(\n        scratchCartesian2,\n        ellipsoid,\n        scratchCartesian3\n      );\n    }\n\n    if (defined(centerCartesian)) {\n      centerCartographic = ellipsoid.cartesianToCartographic(\n        centerCartesian,\n        scratchCartographic\n      );\n    } else {\n      centerCartographic = Rectangle.center(bbox, scratchCartographic);\n      centerCartesian = ellipsoid.cartographicToCartesian(centerCartographic);\n    }\n\n    if (\n      defined(viewBoundScale) &&\n      !CesiumMath.equalsEpsilon(viewBoundScale, 1.0, CesiumMath.EPSILON9)\n    ) {\n      var newHalfWidth = bbox.width * viewBoundScale * 0.5;\n      var newHalfHeight = bbox.height * viewBoundScale * 0.5;\n      bbox = new Rectangle(\n        fixLongitude(centerCartographic.longitude - newHalfWidth),\n        fixLatitude(centerCartographic.latitude - newHalfHeight),\n        fixLongitude(centerCartographic.longitude + newHalfWidth),\n        fixLatitude(centerCartographic.latitude + newHalfHeight)\n      );\n    }\n\n    queryString = queryString.replace(\n      \"[bboxWest]\",\n      CesiumMath.toDegrees(bbox.west).toString()\n    );\n    queryString = queryString.replace(\n      \"[bboxSouth]\",\n      CesiumMath.toDegrees(bbox.south).toString()\n    );\n    queryString = queryString.replace(\n      \"[bboxEast]\",\n      CesiumMath.toDegrees(bbox.east).toString()\n    );\n    queryString = queryString.replace(\n      \"[bboxNorth]\",\n      CesiumMath.toDegrees(bbox.north).toString()\n    );\n\n    var lon = CesiumMath.toDegrees(centerCartographic.longitude).toString();\n    var lat = CesiumMath.toDegrees(centerCartographic.latitude).toString();\n    queryString = queryString.replace(\"[lookatLon]\", lon);\n    queryString = queryString.replace(\"[lookatLat]\", lat);\n    queryString = queryString.replace(\n      \"[lookatTilt]\",\n      CesiumMath.toDegrees(camera.pitch).toString()\n    );\n    queryString = queryString.replace(\n      \"[lookatHeading]\",\n      CesiumMath.toDegrees(camera.heading).toString()\n    );\n    queryString = queryString.replace(\n      \"[lookatRange]\",\n      Cartesian3.distance(camera.positionWC, centerCartesian)\n    );\n    queryString = queryString.replace(\"[lookatTerrainLon]\", lon);\n    queryString = queryString.replace(\"[lookatTerrainLat]\", lat);\n    queryString = queryString.replace(\n      \"[lookatTerrainAlt]\",\n      centerCartographic.height.toString()\n    );\n\n    ellipsoid.cartesianToCartographic(camera.positionWC, scratchCartographic);\n    queryString = queryString.replace(\n      \"[cameraLon]\",\n      CesiumMath.toDegrees(scratchCartographic.longitude).toString()\n    );\n    queryString = queryString.replace(\n      \"[cameraLat]\",\n      CesiumMath.toDegrees(scratchCartographic.latitude).toString()\n    );\n    queryString = queryString.replace(\n      \"[cameraAlt]\",\n      CesiumMath.toDegrees(scratchCartographic.height).toString()\n    );\n\n    var frustum = camera.frustum;\n    var aspectRatio = frustum.aspectRatio;\n    var horizFov = \"\";\n    var vertFov = \"\";\n    if (defined(aspectRatio)) {\n      var fov = CesiumMath.toDegrees(frustum.fov);\n      if (aspectRatio > 1.0) {\n        horizFov = fov;\n        vertFov = fov / aspectRatio;\n      } else {\n        vertFov = fov;\n        horizFov = fov * aspectRatio;\n      }\n    }\n    queryString = queryString.replace(\"[horizFov]\", horizFov.toString());\n    queryString = queryString.replace(\"[vertFov]\", vertFov.toString());\n  } else {\n    queryString = queryString.replace(\"[bboxWest]\", \"-180\");\n    queryString = queryString.replace(\"[bboxSouth]\", \"-90\");\n    queryString = queryString.replace(\"[bboxEast]\", \"180\");\n    queryString = queryString.replace(\"[bboxNorth]\", \"90\");\n\n    queryString = queryString.replace(\"[lookatLon]\", \"\");\n    queryString = queryString.replace(\"[lookatLat]\", \"\");\n    queryString = queryString.replace(\"[lookatRange]\", \"\");\n    queryString = queryString.replace(\"[lookatTilt]\", \"\");\n    queryString = queryString.replace(\"[lookatHeading]\", \"\");\n    queryString = queryString.replace(\"[lookatTerrainLon]\", \"\");\n    queryString = queryString.replace(\"[lookatTerrainLat]\", \"\");\n    queryString = queryString.replace(\"[lookatTerrainAlt]\", \"\");\n\n    queryString = queryString.replace(\"[cameraLon]\", \"\");\n    queryString = queryString.replace(\"[cameraLat]\", \"\");\n    queryString = queryString.replace(\"[cameraAlt]\", \"\");\n    queryString = queryString.replace(\"[horizFov]\", \"\");\n    queryString = queryString.replace(\"[vertFov]\", \"\");\n  }\n\n  if (defined(canvas)) {\n    queryString = queryString.replace(\"[horizPixels]\", canvas.clientWidth);\n    queryString = queryString.replace(\"[vertPixels]\", canvas.clientHeight);\n  } else {\n    queryString = queryString.replace(\"[horizPixels]\", \"\");\n    queryString = queryString.replace(\"[vertPixels]\", \"\");\n  }\n\n  queryString = queryString.replace(\"[terrainEnabled]\", \"1\");\n  queryString = queryString.replace(\"[clientVersion]\", \"1\");\n  queryString = queryString.replace(\"[kmlVersion]\", \"2.2\");\n  queryString = queryString.replace(\"[clientName]\", \"Cesium\");\n  queryString = queryString.replace(\"[language]\", \"English\");\n\n  resource.setQueryParameters(queryToObject(queryString));\n}\n\nfunction processNetworkLink(dataSource, node, processingData, deferredLoading) {\n  var r = processFeature(dataSource, node, processingData);\n  var networkEntity = r.entity;\n\n  var sourceResource = processingData.sourceResource;\n  var uriResolver = processingData.uriResolver;\n\n  var link = queryFirstNode(node, \"Link\", namespaces.kml);\n\n  if (!defined(link)) {\n    link = queryFirstNode(node, \"Url\", namespaces.kml);\n  }\n  if (defined(link)) {\n    var href = queryStringValue(link, \"href\", namespaces.kml);\n    var viewRefreshMode;\n    var viewBoundScale;\n    if (defined(href)) {\n      var newSourceUri = href;\n      href = resolveHref(href, sourceResource, processingData.uriResolver);\n\n      // We need to pass in the original path if resolveHref returns a data uri because the network link\n      //  references a document in a KMZ archive\n      if (/^data:/.test(href.getUrlComponent())) {\n        // So if sourceUri isn't the kmz file, then its another kml in the archive, so resolve it\n        if (!/\\.kmz/i.test(sourceResource.getUrlComponent())) {\n          newSourceUri = sourceResource.getDerivedResource({\n            url: newSourceUri,\n          });\n        }\n      } else {\n        newSourceUri = href.clone(); // Not a data uri so use the fully qualified uri\n        viewRefreshMode = queryStringValue(\n          link,\n          \"viewRefreshMode\",\n          namespaces.kml\n        );\n        viewBoundScale = defaultValue(\n          queryStringValue(link, \"viewBoundScale\", namespaces.kml),\n          1.0\n        );\n        var defaultViewFormat =\n          viewRefreshMode === \"onStop\"\n            ? \"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]\"\n            : \"\";\n        var viewFormat = defaultValue(\n          queryStringValue(link, \"viewFormat\", namespaces.kml),\n          defaultViewFormat\n        );\n        var httpQuery = queryStringValue(link, \"httpQuery\", namespaces.kml);\n        if (defined(viewFormat)) {\n          href.setQueryParameters(queryToObject(cleanupString(viewFormat)));\n        }\n        if (defined(httpQuery)) {\n          href.setQueryParameters(queryToObject(cleanupString(httpQuery)));\n        }\n\n        var ellipsoid = dataSource._ellipsoid;\n        processNetworkLinkQueryString(\n          href,\n          dataSource._camera,\n          dataSource._canvas,\n          viewBoundScale,\n          dataSource._lastCameraView.bbox,\n          ellipsoid\n        );\n      }\n\n      var options = {\n        sourceUri: newSourceUri,\n        uriResolver: uriResolver,\n        context: networkEntity.id,\n      };\n      var networkLinkCollection = new EntityCollection();\n      var promise = load(dataSource, networkLinkCollection, href, options)\n        .then(function (rootElement) {\n          var entities = dataSource._entityCollection;\n          var newEntities = networkLinkCollection.values;\n          entities.suspendEvents();\n          for (var i = 0; i < newEntities.length; i++) {\n            var newEntity = newEntities[i];\n            if (!defined(newEntity.parent)) {\n              newEntity.parent = networkEntity;\n              mergeAvailabilityWithParent(newEntity);\n            }\n\n            entities.add(newEntity);\n          }\n          entities.resumeEvents();\n\n          // Add network links to a list if we need they will need to be updated\n          var refreshMode = queryStringValue(\n            link,\n            \"refreshMode\",\n            namespaces.kml\n          );\n          var refreshInterval = defaultValue(\n            queryNumericValue(link, \"refreshInterval\", namespaces.kml),\n            0\n          );\n          if (\n            (refreshMode === \"onInterval\" && refreshInterval > 0) ||\n            refreshMode === \"onExpire\" ||\n            viewRefreshMode === \"onStop\"\n          ) {\n            var networkLinkControl = queryFirstNode(\n              rootElement,\n              \"NetworkLinkControl\",\n              namespaces.kml\n            );\n            var hasNetworkLinkControl = defined(networkLinkControl);\n\n            var now = JulianDate.now();\n            var networkLinkInfo = {\n              id: createGuid(),\n              href: href,\n              cookie: {},\n              lastUpdated: now,\n              updating: false,\n              entity: networkEntity,\n              viewBoundScale: viewBoundScale,\n              needsUpdate: false,\n              cameraUpdateTime: now,\n            };\n\n            var minRefreshPeriod = 0;\n            if (hasNetworkLinkControl) {\n              networkLinkInfo.cookie = queryToObject(\n                defaultValue(\n                  queryStringValue(\n                    networkLinkControl,\n                    \"cookie\",\n                    namespaces.kml\n                  ),\n                  \"\"\n                )\n              );\n              minRefreshPeriod = defaultValue(\n                queryNumericValue(\n                  networkLinkControl,\n                  \"minRefreshPeriod\",\n                  namespaces.kml\n                ),\n                0\n              );\n            }\n\n            if (refreshMode === \"onInterval\") {\n              if (hasNetworkLinkControl) {\n                refreshInterval = Math.max(minRefreshPeriod, refreshInterval);\n              }\n              networkLinkInfo.refreshMode = RefreshMode.INTERVAL;\n              networkLinkInfo.time = refreshInterval;\n            } else if (refreshMode === \"onExpire\") {\n              var expires;\n              if (hasNetworkLinkControl) {\n                expires = queryStringValue(\n                  networkLinkControl,\n                  \"expires\",\n                  namespaces.kml\n                );\n              }\n              if (defined(expires)) {\n                try {\n                  var date = JulianDate.fromIso8601(expires);\n                  var diff = JulianDate.secondsDifference(date, now);\n                  if (diff > 0 && diff < minRefreshPeriod) {\n                    JulianDate.addSeconds(now, minRefreshPeriod, date);\n                  }\n                  networkLinkInfo.refreshMode = RefreshMode.EXPIRE;\n                  networkLinkInfo.time = date;\n                } catch (e) {\n                  oneTimeWarning(\n                    \"kml-refreshMode-onInterval-onExpire\",\n                    \"KML - NetworkLinkControl expires is not a valid date\"\n                  );\n                }\n              } else {\n                oneTimeWarning(\n                  \"kml-refreshMode-onExpire\",\n                  \"KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element\"\n                );\n              }\n            } else if (dataSource._camera) {\n              // Only allow onStop refreshes if we have a camera\n              networkLinkInfo.refreshMode = RefreshMode.STOP;\n              networkLinkInfo.time = defaultValue(\n                queryNumericValue(link, \"viewRefreshTime\", namespaces.kml),\n                0\n              );\n            } else {\n              oneTimeWarning(\n                \"kml-refrehMode-onStop-noCamera\",\n                \"A NetworkLink with viewRefreshMode=onStop requires a camera be passed in when creating the KmlDataSource\"\n              );\n            }\n\n            if (defined(networkLinkInfo.refreshMode)) {\n              dataSource._networkLinks.set(networkLinkInfo.id, networkLinkInfo);\n            }\n          } else if (viewRefreshMode === \"onRegion\") {\n            oneTimeWarning(\n              \"kml-refrehMode-onRegion\",\n              \"KML - Unsupported viewRefreshMode: onRegion\"\n            );\n          }\n        })\n        .otherwise(function (error) {\n          oneTimeWarning(\"An error occured during loading \" + href.url);\n          dataSource._error.raiseEvent(dataSource, error);\n        });\n\n      deferredLoading.addPromise(promise);\n    }\n  }\n}\n\nfunction processFeatureNode(dataSource, node, processingData, deferredLoading) {\n  var featureProcessor = featureTypes[node.localName];\n  if (defined(featureProcessor)) {\n    return featureProcessor(dataSource, node, processingData, deferredLoading);\n  }\n\n  return processUnsupportedFeature(\n    dataSource,\n    node,\n    processingData,\n    deferredLoading\n  );\n}\n\nfunction loadKml(\n  dataSource,\n  entityCollection,\n  kml,\n  sourceResource,\n  uriResolver,\n  context\n) {\n  entityCollection.removeAll();\n\n  var documentElement = kml.documentElement;\n  var document =\n    documentElement.localName === \"Document\"\n      ? documentElement\n      : queryFirstNode(documentElement, \"Document\", namespaces.kml);\n  var name = queryStringValue(document, \"name\", namespaces.kml);\n  if (!defined(name)) {\n    name = getFilenameFromUri(sourceResource.getUrlComponent());\n  }\n\n  // Only set the name from the root document\n  if (!defined(dataSource._name)) {\n    dataSource._name = name;\n  }\n\n  var deferredLoading = new KmlDataSource._DeferredLoading(dataSource);\n  var styleCollection = new EntityCollection(dataSource);\n  return when\n    .all(\n      processStyles(\n        dataSource,\n        kml,\n        styleCollection,\n        sourceResource,\n        false,\n        uriResolver\n      )\n    )\n    .then(function () {\n      var element = kml.documentElement;\n      if (element.localName === \"kml\") {\n        var childNodes = element.childNodes;\n        for (var i = 0; i < childNodes.length; i++) {\n          var tmp = childNodes[i];\n          if (defined(featureTypes[tmp.localName])) {\n            element = tmp;\n            break;\n          }\n        }\n      }\n\n      var processingData = {\n        parentEntity: undefined,\n        entityCollection: entityCollection,\n        styleCollection: styleCollection,\n        sourceResource: sourceResource,\n        uriResolver: uriResolver,\n        context: context,\n      };\n\n      entityCollection.suspendEvents();\n      processFeatureNode(dataSource, element, processingData, deferredLoading);\n      entityCollection.resumeEvents();\n\n      return deferredLoading.wait().then(function () {\n        return kml.documentElement;\n      });\n    });\n}\n\nfunction loadKmz(dataSource, entityCollection, blob, sourceResource) {\n  var deferred = when.defer();\n  zip.createReader(\n    new zip.BlobReader(blob),\n    function (reader) {\n      reader.getEntries(function (entries) {\n        var promises = [];\n        var uriResolver = {};\n        var docEntry;\n        var docDefer;\n        for (var i = 0; i < entries.length; i++) {\n          var entry = entries[i];\n          if (!entry.directory) {\n            var innerDefer = when.defer();\n            promises.push(innerDefer.promise);\n            if (/\\.kml$/i.test(entry.filename)) {\n              // We use the first KML document we come across\n              //  https://developers.google.com/kml/documentation/kmzarchives\n              // Unless we come across a .kml file at the root of the archive because GE does this\n              if (!defined(docEntry) || !/\\//i.test(entry.filename)) {\n                if (defined(docEntry)) {\n                  // We found one at the root so load the initial kml as a data uri\n                  loadDataUriFromZip(docEntry, uriResolver, docDefer);\n                }\n                docEntry = entry;\n                docDefer = innerDefer;\n              } else {\n                // Wasn't the first kml and wasn't at the root\n                loadDataUriFromZip(entry, uriResolver, innerDefer);\n              }\n            } else {\n              loadDataUriFromZip(entry, uriResolver, innerDefer);\n            }\n          }\n        }\n\n        // Now load the root KML document\n        if (defined(docEntry)) {\n          loadXmlFromZip(docEntry, uriResolver, docDefer);\n        }\n        when\n          .all(promises)\n          .then(function () {\n            reader.close();\n            if (!defined(uriResolver.kml)) {\n              deferred.reject(\n                new RuntimeError(\"KMZ file does not contain a KML document.\")\n              );\n              return;\n            }\n            uriResolver.keys = Object.keys(uriResolver);\n            return loadKml(\n              dataSource,\n              entityCollection,\n              uriResolver.kml,\n              sourceResource,\n              uriResolver\n            );\n          })\n          .then(deferred.resolve)\n          .otherwise(deferred.reject);\n      });\n    },\n    function (e) {\n      deferred.reject(e);\n    }\n  );\n\n  return deferred.promise;\n}\n\nfunction load(dataSource, entityCollection, data, options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n  var sourceUri = options.sourceUri;\n  var uriResolver = options.uriResolver;\n  var context = options.context;\n\n  var promise = data;\n  if (typeof data === \"string\" || data instanceof Resource) {\n    data = Resource.createIfNeeded(data);\n    promise = data.fetchBlob();\n    sourceUri = defaultValue(sourceUri, data.clone());\n\n    // Add resource credits to our list of credits to display\n    var resourceCredits = dataSource._resourceCredits;\n    var credits = data.credits;\n    if (defined(credits)) {\n      var length = credits.length;\n      for (var i = 0; i < length; i++) {\n        resourceCredits.push(credits[i]);\n      }\n    }\n  } else {\n    sourceUri = defaultValue(sourceUri, Resource.DEFAULT.clone());\n  }\n\n  sourceUri = Resource.createIfNeeded(sourceUri);\n\n  return when(promise)\n    .then(function (dataToLoad) {\n      if (dataToLoad instanceof Blob) {\n        return isZipFile(dataToLoad).then(function (isZip) {\n          if (isZip) {\n            return loadKmz(dataSource, entityCollection, dataToLoad, sourceUri);\n          }\n          return readBlobAsText(dataToLoad).then(function (text) {\n            //There's no official way to validate if a parse was successful.\n            //The following check detects the error on various browsers.\n\n            //Insert missing namespaces\n            text = insertNamespaces(text);\n\n            //Remove Duplicate Namespaces\n            text = removeDuplicateNamespaces(text);\n\n            //IE raises an exception\n            var kml;\n            var error;\n            try {\n              kml = parser.parseFromString(text, \"application/xml\");\n            } catch (e) {\n              error = e.toString();\n            }\n\n            //The parse succeeds on Chrome and Firefox, but the error\n            //handling is different in each.\n            if (\n              defined(error) ||\n              kml.body ||\n              kml.documentElement.tagName === \"parsererror\"\n            ) {\n              //Firefox has error information as the firstChild nodeValue.\n              var msg = defined(error)\n                ? error\n                : kml.documentElement.firstChild.nodeValue;\n\n              //Chrome has it in the body text.\n              if (!msg) {\n                msg = kml.body.innerText;\n              }\n\n              //Return the error\n              throw new RuntimeError(msg);\n            }\n            return loadKml(\n              dataSource,\n              entityCollection,\n              kml,\n              sourceUri,\n              uriResolver,\n              context\n            );\n          });\n        });\n      }\n      return loadKml(\n        dataSource,\n        entityCollection,\n        dataToLoad,\n        sourceUri,\n        uriResolver,\n        context\n      );\n    })\n    .otherwise(function (error) {\n      dataSource._error.raiseEvent(dataSource, error);\n      console.log(error);\n      return when.reject(error);\n    });\n}\n\n/**\n * @typedef {Object} KmlDataSource.LoadOptions\n *\n * Initialization options for the `load` method.\n *\n * @property {Camera} camera The camera that is used for viewRefreshModes and sending camera properties to network links.\n * @property {HTMLCanvasElement} canvas The canvas that is used for sending viewer properties to network links.\n * @property {String} [sourceUri] Overrides the url to use for resolving relative links and other KML network features.\n * @property {Boolean} [clampToGround=false] true if we want the geometry features (Polygons, LineStrings and LinearRings) clamped to the ground.\n * @property {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The global ellipsoid used for geographical calculations.\n * @property {Credit|String} [credit] A credit for the data source, which is displayed on the canvas.\n */\n\n/**\n * A {@link DataSource} which processes Keyhole Markup Language 2.2 (KML).\n * <p>\n * KML support in Cesium is incomplete, but a large amount of the standard,\n * as well as Google's <code>gx</code> extension namespace, is supported. See Github issue\n * {@link https://github.com/CesiumGS/cesium/issues/873|#873} for a\n * detailed list of what is and isn't support. Cesium will also write information to the\n * console when it encounters most unsupported features.\n * </p>\n * <p>\n * Non visual feature data, such as <code>atom:author</code> and <code>ExtendedData</code>\n * is exposed via an instance of {@link KmlFeatureData}, which is added to each {@link Entity}\n * under the <code>kml</code> property.\n * </p>\n *\n * @alias KmlDataSource\n * @constructor\n *\n * @param {Object} options An object with the following properties:\n * @param {Camera} options.camera The camera that is used for viewRefreshModes and sending camera properties to network links.\n * @param {HTMLCanvasElement} options.canvas The canvas that is used for sending viewer properties to network links.\n * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The global ellipsoid used for geographical calculations.\n * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n *\n * @see {@link http://www.opengeospatial.org/standards/kml/|Open Geospatial Consortium KML Standard}\n * @see {@link https://developers.google.com/kml/|Google KML Documentation}\n *\n * @demo {@link https://sandcastle.cesium.com/index.html?src=KML.html|Cesium Sandcastle KML Demo}\n *\n * @example\n * var viewer = new Cesium.Viewer('cesiumContainer');\n * viewer.dataSources.add(Cesium.KmlDataSource.load('../../SampleData/facilities.kmz',\n *      {\n *           camera: viewer.scene.camera,\n *           canvas: viewer.scene.canvas\n *      })\n * );\n */\nfunction KmlDataSource(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n  var camera = options.camera;\n  var canvas = options.canvas;\n\n  \n\n  this._changed = new Event();\n  this._error = new Event();\n  this._loading = new Event();\n  this._refresh = new Event();\n  this._unsupportedNode = new Event();\n\n  this._clock = undefined;\n  this._entityCollection = new EntityCollection(this);\n  this._name = undefined;\n  this._isLoading = false;\n  this._pinBuilder = new PinBuilder();\n  this._networkLinks = new AssociativeArray();\n  this._entityCluster = new EntityCluster();\n\n  this._canvas = canvas;\n  this._camera = camera;\n  this._lastCameraView = {\n    position: defined(camera) ? Cartesian3.clone(camera.positionWC) : undefined,\n    direction: defined(camera)\n      ? Cartesian3.clone(camera.directionWC)\n      : undefined,\n    up: defined(camera) ? Cartesian3.clone(camera.upWC) : undefined,\n    bbox: defined(camera)\n      ? camera.computeViewRectangle()\n      : Rectangle.clone(Rectangle.MAX_VALUE),\n  };\n\n  this._ellipsoid = defaultValue(options.ellipsoid, Ellipsoid.WGS84);\n\n  // User specified credit\n  var credit = options.credit;\n  if (typeof credit === \"string\") {\n    credit = new Credit(credit);\n  }\n  this._credit = credit;\n\n  // Create a list of Credit's from the resource that the user can't remove\n  this._resourceCredits = [];\n}\n\n/**\n * Creates a Promise to a new instance loaded with the provided KML data.\n *\n * @param {Resource|String|Document|Blob} data A url, parsed KML document, or Blob containing binary KMZ data or a parsed KML document.\n * @param {KmlDataSource.LoadOptions} [options] An object specifying configuration options\n *\n * @returns {Promise.<KmlDataSource>} A promise that will resolve to a new KmlDataSource instance once the KML is loaded.\n */\nKmlDataSource.load = function (data, options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n  var dataSource = new KmlDataSource(options);\n  return dataSource.load(data, options);\n};\n\nObject.defineProperties(KmlDataSource.prototype, {\n  /**\n   * Gets or sets a human-readable name for this instance.\n   * This will be automatically be set to the KML document name on load.\n   * @memberof KmlDataSource.prototype\n   * @type {String}\n   */\n  name: {\n    get: function () {\n      return this._name;\n    },\n    set: function (value) {\n      if (this._name !== value) {\n        this._name = value;\n        this._changed.raiseEvent(this);\n      }\n    },\n  },\n  /**\n   * Gets the clock settings defined by the loaded KML. This represents the total\n   * availability interval for all time-dynamic data. If the KML does not contain\n   * time-dynamic data, this value is undefined.\n   * @memberof KmlDataSource.prototype\n   * @type {DataSourceClock}\n   */\n  clock: {\n    get: function () {\n      return this._clock;\n    },\n  },\n  /**\n   * Gets the collection of {@link Entity} instances.\n   * @memberof KmlDataSource.prototype\n   * @type {EntityCollection}\n   */\n  entities: {\n    get: function () {\n      return this._entityCollection;\n    },\n  },\n  /**\n   * Gets a value indicating if the data source is currently loading data.\n   * @memberof KmlDataSource.prototype\n   * @type {Boolean}\n   */\n  isLoading: {\n    get: function () {\n      return this._isLoading;\n    },\n  },\n  /**\n   * Gets an event that will be raised when the underlying data changes.\n   * @memberof KmlDataSource.prototype\n   * @type {Event}\n   */\n  changedEvent: {\n    get: function () {\n      return this._changed;\n    },\n  },\n  /**\n   * Gets an event that will be raised if an error is encountered during processing.\n   * @memberof KmlDataSource.prototype\n   * @type {Event}\n   */\n  errorEvent: {\n    get: function () {\n      return this._error;\n    },\n  },\n  /**\n   * Gets an event that will be raised when the data source either starts or stops loading.\n   * @memberof KmlDataSource.prototype\n   * @type {Event}\n   */\n  loadingEvent: {\n    get: function () {\n      return this._loading;\n    },\n  },\n  /**\n   * Gets an event that will be raised when the data source refreshes a network link.\n   * @memberof KmlDataSource.prototype\n   * @type {Event}\n   */\n  refreshEvent: {\n    get: function () {\n      return this._refresh;\n    },\n  },\n  /**\n   * Gets an event that will be raised when the data source finds an unsupported node type.\n   * @memberof KmlDataSource.prototype\n   * @type {Event}\n   */\n  unsupportedNodeEvent: {\n    get: function () {\n      return this._unsupportedNode;\n    },\n  },\n  /**\n   * Gets whether or not this data source should be displayed.\n   * @memberof KmlDataSource.prototype\n   * @type {Boolean}\n   */\n  show: {\n    get: function () {\n      return this._entityCollection.show;\n    },\n    set: function (value) {\n      this._entityCollection.show = value;\n    },\n  },\n\n  /**\n   * Gets or sets the clustering options for this data source. This object can be shared between multiple data sources.\n   *\n   * @memberof KmlDataSource.prototype\n   * @type {EntityCluster}\n   */\n  clustering: {\n    get: function () {\n      return this._entityCluster;\n    },\n    set: function (value) {\n      \n      this._entityCluster = value;\n    },\n  },\n  /**\n   * Gets the credit that will be displayed for the data source\n   * @memberof KmlDataSource.prototype\n   * @type {Credit}\n   */\n  credit: {\n    get: function () {\n      return this._credit;\n    },\n  },\n});\n\n/**\n * Asynchronously loads the provided KML data, replacing any existing data.\n *\n * @param {Resource|String|Document|Blob} data A url, parsed KML document, or Blob containing binary KMZ data or a parsed KML document.\n * @param {Object} [options] An object with the following properties:\n * @param {Resource|String} [options.sourceUri] Overrides the url to use for resolving relative links and other KML network features.\n * @param {Boolean} [options.clampToGround=false] true if we want the geometry features (Polygons, LineStrings and LinearRings) clamped to the ground. If true, lines will use corridors so use Entity.corridor instead of Entity.polyline.\n * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The global ellipsoid used for geographical calculations.\n *\n * @returns {Promise.<KmlDataSource>} A promise that will resolve to this instances once the KML is loaded.\n */\nKmlDataSource.prototype.load = function (data, options) {\n  \n\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n  DataSource.setLoading(this, true);\n\n  var oldName = this._name;\n  this._name = undefined;\n  this._clampToGround = defaultValue(options.clampToGround, false);\n\n  var that = this;\n  return load(this, this._entityCollection, data, options)\n    .then(function () {\n      var clock;\n\n      var availability = that._entityCollection.computeAvailability();\n\n      var start = availability.start;\n      var stop = availability.stop;\n      var isMinStart = JulianDate.equals(start, Iso8601.MINIMUM_VALUE);\n      var isMaxStop = JulianDate.equals(stop, Iso8601.MAXIMUM_VALUE);\n      if (!isMinStart || !isMaxStop) {\n        var date;\n\n        //If start is min time just start at midnight this morning, local time\n        if (isMinStart) {\n          date = new Date();\n          date.setHours(0, 0, 0, 0);\n          start = JulianDate.fromDate(date);\n        }\n\n        //If stop is max value just stop at midnight tonight, local time\n        if (isMaxStop) {\n          date = new Date();\n          date.setHours(24, 0, 0, 0);\n          stop = JulianDate.fromDate(date);\n        }\n\n        clock = new DataSourceClock();\n        clock.startTime = start;\n        clock.stopTime = stop;\n        clock.currentTime = JulianDate.clone(start);\n        clock.clockRange = ClockRange.LOOP_STOP;\n        clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n        clock.multiplier = Math.round(\n          Math.min(\n            Math.max(JulianDate.secondsDifference(stop, start) / 60, 1),\n            3.15569e7\n          )\n        );\n      }\n\n      var changed = false;\n      if (clock !== that._clock) {\n        that._clock = clock;\n        changed = true;\n      }\n\n      if (oldName !== that._name) {\n        changed = true;\n      }\n\n      if (changed) {\n        that._changed.raiseEvent(that);\n      }\n\n      DataSource.setLoading(that, false);\n\n      return that;\n    })\n    .otherwise(function (error) {\n      DataSource.setLoading(that, false);\n      that._error.raiseEvent(that, error);\n      console.log(error);\n      return when.reject(error);\n    });\n};\n\nfunction mergeAvailabilityWithParent(child) {\n  var parent = child.parent;\n  if (defined(parent)) {\n    var parentAvailability = parent.availability;\n    if (defined(parentAvailability)) {\n      var childAvailability = child.availability;\n      if (defined(childAvailability)) {\n        childAvailability.intersect(parentAvailability);\n      } else {\n        child.availability = parentAvailability;\n      }\n    }\n  }\n}\n\nfunction getNetworkLinkUpdateCallback(\n  dataSource,\n  networkLink,\n  newEntityCollection,\n  networkLinks,\n  processedHref\n) {\n  return function (rootElement) {\n    if (!networkLinks.contains(networkLink.id)) {\n      // Got into the odd case where a parent network link was updated while a child\n      //  network link update was in flight, so just throw it away.\n      return;\n    }\n    var remove = false;\n    var networkLinkControl = queryFirstNode(\n      rootElement,\n      \"NetworkLinkControl\",\n      namespaces.kml\n    );\n    var hasNetworkLinkControl = defined(networkLinkControl);\n\n    var minRefreshPeriod = 0;\n    if (hasNetworkLinkControl) {\n      if (\n        defined(queryFirstNode(networkLinkControl, \"Update\", namespaces.kml))\n      ) {\n        oneTimeWarning(\n          \"kml-networkLinkControl-update\",\n          \"KML - NetworkLinkControl updates aren't supported.\"\n        );\n        networkLink.updating = false;\n        networkLinks.remove(networkLink.id);\n        return;\n      }\n      networkLink.cookie = queryToObject(\n        defaultValue(\n          queryStringValue(networkLinkControl, \"cookie\", namespaces.kml),\n          \"\"\n        )\n      );\n      minRefreshPeriod = defaultValue(\n        queryNumericValue(\n          networkLinkControl,\n          \"minRefreshPeriod\",\n          namespaces.kml\n        ),\n        0\n      );\n    }\n\n    var now = JulianDate.now();\n    var refreshMode = networkLink.refreshMode;\n    if (refreshMode === RefreshMode.INTERVAL) {\n      if (defined(networkLinkControl)) {\n        networkLink.time = Math.max(minRefreshPeriod, networkLink.time);\n      }\n    } else if (refreshMode === RefreshMode.EXPIRE) {\n      var expires;\n      if (defined(networkLinkControl)) {\n        expires = queryStringValue(\n          networkLinkControl,\n          \"expires\",\n          namespaces.kml\n        );\n      }\n      if (defined(expires)) {\n        try {\n          var date = JulianDate.fromIso8601(expires);\n          var diff = JulianDate.secondsDifference(date, now);\n          if (diff > 0 && diff < minRefreshPeriod) {\n            JulianDate.addSeconds(now, minRefreshPeriod, date);\n          }\n          networkLink.time = date;\n        } catch (e) {\n          oneTimeWarning(\n            \"kml-networkLinkControl-expires\",\n            \"KML - NetworkLinkControl expires is not a valid date\"\n          );\n          remove = true;\n        }\n      } else {\n        oneTimeWarning(\n          \"kml-refreshMode-onExpire\",\n          \"KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element\"\n        );\n        remove = true;\n      }\n    }\n\n    var networkLinkEntity = networkLink.entity;\n    var entityCollection = dataSource._entityCollection;\n    var newEntities = newEntityCollection.values;\n\n    function removeChildren(entity) {\n      entityCollection.remove(entity);\n      var children = entity._children;\n      var count = children.length;\n      for (var i = 0; i < count; ++i) {\n        removeChildren(children[i]);\n      }\n    }\n\n    // Remove old entities\n    entityCollection.suspendEvents();\n    var entitiesCopy = entityCollection.values.slice();\n    var i;\n    for (i = 0; i < entitiesCopy.length; ++i) {\n      var entityToRemove = entitiesCopy[i];\n      if (entityToRemove.parent === networkLinkEntity) {\n        entityToRemove.parent = undefined;\n        removeChildren(entityToRemove);\n      }\n    }\n    entityCollection.resumeEvents();\n\n    // Add new entities\n    entityCollection.suspendEvents();\n    for (i = 0; i < newEntities.length; i++) {\n      var newEntity = newEntities[i];\n      if (!defined(newEntity.parent)) {\n        newEntity.parent = networkLinkEntity;\n        mergeAvailabilityWithParent(newEntity);\n      }\n      entityCollection.add(newEntity);\n    }\n    entityCollection.resumeEvents();\n\n    // No refresh information remove it, otherwise update lastUpdate time\n    if (remove) {\n      networkLinks.remove(networkLink.id);\n    } else {\n      networkLink.lastUpdated = now;\n    }\n\n    var availability = entityCollection.computeAvailability();\n\n    var start = availability.start;\n    var stop = availability.stop;\n    var isMinStart = JulianDate.equals(start, Iso8601.MINIMUM_VALUE);\n    var isMaxStop = JulianDate.equals(stop, Iso8601.MAXIMUM_VALUE);\n    if (!isMinStart || !isMaxStop) {\n      var clock = dataSource._clock;\n\n      if (clock.startTime !== start || clock.stopTime !== stop) {\n        clock.startTime = start;\n        clock.stopTime = stop;\n        dataSource._changed.raiseEvent(dataSource);\n      }\n    }\n\n    networkLink.updating = false;\n    networkLink.needsUpdate = false;\n    dataSource._refresh.raiseEvent(\n      dataSource,\n      processedHref.getUrlComponent(true)\n    );\n  };\n}\n\nvar entitiesToIgnore = new AssociativeArray();\n\n/**\n * Updates any NetworkLink that require updating.\n *\n * @param {JulianDate} time The simulation time.\n * @returns {Boolean} True if this data source is ready to be displayed at the provided time, false otherwise.\n */\nKmlDataSource.prototype.update = function (time) {\n  var networkLinks = this._networkLinks;\n  if (networkLinks.length === 0) {\n    return true;\n  }\n\n  var now = JulianDate.now();\n  var that = this;\n\n  entitiesToIgnore.removeAll();\n\n  function recurseIgnoreEntities(entity) {\n    var children = entity._children;\n    var count = children.length;\n    for (var i = 0; i < count; ++i) {\n      var child = children[i];\n      entitiesToIgnore.set(child.id, child);\n      recurseIgnoreEntities(child);\n    }\n  }\n\n  var cameraViewUpdate = false;\n  var lastCameraView = this._lastCameraView;\n  var camera = this._camera;\n  if (\n    defined(camera) &&\n    !(\n      camera.positionWC.equalsEpsilon(\n        lastCameraView.position,\n        CesiumMath.EPSILON7\n      ) &&\n      camera.directionWC.equalsEpsilon(\n        lastCameraView.direction,\n        CesiumMath.EPSILON7\n      ) &&\n      camera.upWC.equalsEpsilon(lastCameraView.up, CesiumMath.EPSILON7)\n    )\n  ) {\n    // Camera has changed so update the last view\n    lastCameraView.position = Cartesian3.clone(camera.positionWC);\n    lastCameraView.direction = Cartesian3.clone(camera.directionWC);\n    lastCameraView.up = Cartesian3.clone(camera.upWC);\n    lastCameraView.bbox = camera.computeViewRectangle();\n    cameraViewUpdate = true;\n  }\n\n  var newNetworkLinks = new AssociativeArray();\n  var changed = false;\n  networkLinks.values.forEach(function (networkLink) {\n    var entity = networkLink.entity;\n    if (entitiesToIgnore.contains(entity.id)) {\n      return;\n    }\n\n    if (!networkLink.updating) {\n      var doUpdate = false;\n      if (networkLink.refreshMode === RefreshMode.INTERVAL) {\n        if (\n          JulianDate.secondsDifference(now, networkLink.lastUpdated) >\n          networkLink.time\n        ) {\n          doUpdate = true;\n        }\n      } else if (networkLink.refreshMode === RefreshMode.EXPIRE) {\n        if (JulianDate.greaterThan(now, networkLink.time)) {\n          doUpdate = true;\n        }\n      } else if (networkLink.refreshMode === RefreshMode.STOP) {\n        if (cameraViewUpdate) {\n          networkLink.needsUpdate = true;\n          networkLink.cameraUpdateTime = now;\n        }\n\n        if (\n          networkLink.needsUpdate &&\n          JulianDate.secondsDifference(now, networkLink.cameraUpdateTime) >=\n            networkLink.time\n        ) {\n          doUpdate = true;\n        }\n      }\n\n      if (doUpdate) {\n        recurseIgnoreEntities(entity);\n        networkLink.updating = true;\n        var newEntityCollection = new EntityCollection();\n        var href = networkLink.href.clone();\n\n        href.setQueryParameters(networkLink.cookie);\n        var ellipsoid = defaultValue(that._ellipsoid, Ellipsoid.WGS84);\n        processNetworkLinkQueryString(\n          href,\n          that._camera,\n          that._canvas,\n          networkLink.viewBoundScale,\n          lastCameraView.bbox,\n          ellipsoid\n        );\n\n        load(that, newEntityCollection, href, { context: entity.id })\n          .then(\n            getNetworkLinkUpdateCallback(\n              that,\n              networkLink,\n              newEntityCollection,\n              newNetworkLinks,\n              href\n            )\n          )\n          .otherwise(function (error) {\n            var msg =\n              \"NetworkLink \" + networkLink.href + \" refresh failed: \" + error;\n            console.log(msg);\n            that._error.raiseEvent(that, msg);\n          });\n        changed = true;\n      }\n    }\n    newNetworkLinks.set(networkLink.id, networkLink);\n  });\n\n  if (changed) {\n    this._networkLinks = newNetworkLinks;\n    this._changed.raiseEvent(this);\n  }\n\n  return true;\n};\n\n/**\n * Contains KML Feature data loaded into the <code>Entity.kml</code> property by {@link KmlDataSource}.\n * @alias KmlFeatureData\n * @constructor\n */\nfunction KmlFeatureData() {\n  /**\n   * @typedef KmlFeatureData.Author\n   * @type {Object}\n   * @property {String} name Gets the name.\n   * @property {String} uri Gets the URI.\n   * @property {Number} age Gets the email.\n   */\n\n  /**\n   * Gets the atom syndication format author field.\n   * @type {KmlFeatureData.Author}\n   */\n  this.author = {\n    name: undefined,\n    uri: undefined,\n    email: undefined,\n  };\n\n  /**\n   * @typedef KmlFeatureData.Link\n   * @type {Object}\n   * @property {String} href Gets the href.\n   * @property {String} hreflang Gets the language of the linked resource.\n   * @property {String} rel Gets the link relation.\n   * @property {String} type Gets the link type.\n   * @property {String} title Gets the link title.\n   * @property {String} length Gets the link length.\n   */\n\n  /**\n   * Gets the link.\n   * @type {KmlFeatureData.Link}\n   */\n  this.link = {\n    href: undefined,\n    hreflang: undefined,\n    rel: undefined,\n    type: undefined,\n    title: undefined,\n    length: undefined,\n  };\n\n  /**\n   * Gets the unstructured address field.\n   * @type {String}\n   */\n  this.address = undefined;\n  /**\n   * Gets the phone number.\n   * @type {String}\n   */\n  this.phoneNumber = undefined;\n  /**\n   * Gets the snippet.\n   * @type {String}\n   */\n  this.snippet = undefined;\n  /**\n   * Gets the extended data, parsed into a JSON object.\n   * Currently only the <code>Data</code> property is supported.\n   * <code>SchemaData</code> and custom data are ignored.\n   * @type {String}\n   */\n  this.extendedData = undefined;\n}\n\n// For testing\nKmlDataSource._DeferredLoading = DeferredLoading;\nKmlDataSource._getTimestamp = getTimestamp;\n\nexport default KmlDataSource;\n"],"sourceRoot":""}